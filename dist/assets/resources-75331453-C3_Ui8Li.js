import{g}from"./array-1612f3a9-CG_obv_6.js";import{b as p,d as S,t as C}from"./dom-bea5da81-_E6DDA15.js";import{d as v}from"./debounce-00101a41-wTZ0BIwd.js";import{h as u,H as E}from"./index-8ERthB3p.js";import{I as x}from"./interactive-a992f5df-DKTznAlu.js";/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.6.0
 */const P={heading:"heading",container:"container",indented:"container--indented"},F={parentItem:"parent-item"};function M(){this.setUpItems(),this.setUpFilter(),this.deselectRemovedItems()}const L=["ArrowUp","ArrowDown"];function q(){this.setUpItems(),this.setUpFilter(),this.emitCalciteListChange=v(w.bind(this),0),this.emitCalciteListFilter=v(A.bind(this),0)}function $(){var e;(e=this.mutationObserver)==null||e.observe(this.el,{childList:!0,subtree:!0})}function z(){var e;(e=this.mutationObserver)==null||e.disconnect()}function K(e){const{selectedValues:t}=this,{item:s,value:i,selected:n,shiftPressed:l}=e.detail;n?(this.multiple&&l&&this.selectSiblings(s),this.multiple||this.deselectSiblingItems(s),t.set(i,s)):(t.delete(i),this.multiple&&l&&this.selectSiblings(s,!0)),this.multiple||(f(s,n),n&&p(s)),this.lastSelectedItem=s,this.emitCalciteListChange()}function N(e){const t=e.detail.oldValue,s=this.selectedValues;if(s.has(t)){const i=s.get(t);s.delete(t),s.set(e.detail.newValue,i)}e.stopPropagation()}function V(e){return!!L.find(t=>t===e)}function j(e){const{el:t,items:s,multiple:i,selectedValues:n}=this;i||t.contains(e.relatedTarget)||m(s).forEach(c=>{f(c,n.size===0?c.contains(e.target)||e.target===c:c.selected)})}function B(e){const{key:t,target:s}=e;if(!V(t))return;const{items:i,multiple:n,selectionFollowsFocus:l}=this,{length:c}=i,a=i.indexOf(s);if(!c||a===-1)return;e.preventDefault();const r=O(this,s,t==="ArrowUp"?"up":"down"),o=i[r];i.forEach(d=>f(d,d===o)),!n&&l&&(o.selected=!0),p(o)}function O(e,t,s){const{items:i}=e,{length:n}=i,l=i.indexOf(t),c=s==="up"?-1:1;let a=1,r=g(l+c*a++,n);const o=r;for(;i[r].disabled&&(r=g(l+c*a++,n),r!==o););return r}function G(e,t){const{items:s}=e;return s.indexOf(t)}function m(e){return e.filter(t=>!t.disabled)}function A(){this.calciteListFilter.emit()}function w(){this.calciteListChange.emit(this.selectedValues)}function W(e){if(e.defaultPrevented)return;const t=e.target,s=this.selectedValues;t.parentElement.tagName==="CALCITE-PICK-LIST-GROUP"&&t.slot===F.parentItem?(t.parentElement.remove(),Array.from(t.parentElement.children).forEach(i=>s.delete(i.value))):(t.remove(),s.delete(t.value)),this.emitCalciteListChange()}function f(e,t){e.disabled||(t?e.removeAttribute("tabindex"):e.setAttribute("tabindex","-1"))}async function _(e){var c;if(this.filterEnabled&&e==="filter"){await p(this.filterEl);return}const{items:t,multiple:s,selectionFollowsFocus:i}=this;if(t.length===0)return;if(s)return(c=m(t)[0])==null?void 0:c.setFocus();const n=m(t),l=n.find(a=>a.selected)||n[0];return i&&l&&(l.selected=!0),l.setFocus()}function J(e){this.items=Array.from(this.el.querySelectorAll(e));let t=!1;const{items:s}=this;s.forEach(n=>{n.icon=this.getIconType(),this.multiple||(n.deselectDisabled=!0,f(n,!1)),n.selected&&(t=!0,f(n,!0),this.selectedValues.set(n.value,n))});const[i]=s;!t&&i&&!i.disabled&&f(i,!0)}function Q(){const e=this.selectedValues,t=this.items.map(({value:s})=>s);e.forEach(s=>{t.includes(s.value)||this.selectedValues.delete(s.value)})}function X(e){this.items.forEach(t=>{t.value!==e.value&&(t.toggleSelected(!1),this.selectedValues.has(t.value)&&this.selectedValues.delete(t.value))})}function Y(e,t=!1){if(!this.lastSelectedItem)return;const{items:s}=this,i=s.findIndex(l=>l.value===this.lastSelectedItem.value),n=s.findIndex(l=>l.value===e.value);s.slice(Math.min(i,n),Math.max(i,n)).forEach(l=>{l.toggleSelected(!t),t?this.selectedValues.delete(l.value):this.selectedValues.set(l.value,l)})}let h;function Z(e=!1){var c;const{filteredData:t,filterText:s}=this,i=t.map(a=>a.value);let n=!1;h||(h=new Set);const l=((c=this.items)==null?void 0:c.filter(a=>{const r=a.parentElement;r.matches("calcite-pick-list-group")&&h.add(r);const d=s?i.includes(a.value):!0;return a.hidden=!d,n||(n=d&&a.selected),d}))||[];h.forEach(a=>{const r=l.some(d=>a.contains(d));if(a.hidden=!r,!r)return;const o=S(a,"parent-item");o&&(o.hidden=!1,l.includes(o)&&Array.from(a.children).forEach(d=>d.hidden=!1))}),h.clear(),l.length>0&&!n&&!this.multiple&&f(l[0],!0),this.setFilteredItems(l),e&&this.emitCalciteListFilter()}function ee(){var t;const e=(t=this.filterEl)==null?void 0:t.filteredItems;e&&(this.filteredData=e),this.handleFilter()}function te(e){e.stopPropagation();const{filteredItems:t,value:s}=e.currentTarget;this.filterText=s,this.filteredData=t,this.handleFilter(!0)}function se(){return this.items.map(e=>({label:e.label,description:e.description,metadata:e.metadata,value:e.value}))}const y={sticky:"sticky-pos"};var b;(function(e){e.circle="circle",e.square="square",e.grip="grip"})(b||(b={}));const T={menuActions:"menu-actions"},ie=({props:{disabled:e,loading:t,filterEnabled:s,dataForFilter:i,handleFilterEvent:n,filterPlaceholder:l,filterText:c,setFilterEl:a,dragEnabled:r,storeAssistiveEl:o},...d})=>{const I=u("slot",null);return u(E,{"aria-busy":C(t),role:"menu",...d},u(x,{disabled:e},u("section",null,r?u("span",{"aria-live":"assertive",class:"assistive-text",ref:o}):null,u("header",{class:{[y.sticky]:!0}},s?u("calcite-filter",{"aria-label":l,disabled:e,items:i,onCalciteFilterChange:n,placeholder:l,value:c,ref:a}):null,u("slot",{name:T.menuActions})),t?u("calcite-scrim",{loading:t}):null,I)))},ne={actions:"actions",actionsEnd:"actions--end",actionsStart:"actions--start",description:"description",handle:"handle",handleActivated:"handle--activated",highlight:"highlight",icon:"icon",iconDot:"icon-dot",label:"label",remove:"remove",title:"title",textContainer:"text-container"},le={checked:"check",remove:"x"},ae={actionsEnd:"actions-end",actionsStart:"actions-start"};export{ne as C,b as I,ie as L,ae as S,X as a,te as b,O as c,Q as d,$ as e,ee as f,se as g,Z as h,q as i,z as j,B as k,j as l,M as m,K as n,N as o,J as p,_ as q,W as r,Y as s,G as t,F as u,P as v,le as w};
