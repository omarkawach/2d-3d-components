import{cf as u,dk as O,dh as j,bX as F,cg as q,bW as I,dj as T,dD as G,bR as R,fo as C,dm as g,di as x,bU as U,cj as W,dg as Q}from"./index-8ERthB3p.js";import{e as B}from"./mat3f64-BBpwCtoL.js";import{e as H}from"./mat4f64-Dk4dwAN8.js";import{e as J}from"./quatf64-BrpT0VRp.js";import{n as K}from"./vec2f64-Diu2Kaa8.js";import{p as S}from"./mathUtils-iSLnUy_4.js";function It(e,t,r){const c=u(e,t)/u(e,e);return T(r,e,c)}function L(e,t){return u(e,t)/O(e)}function Nt(e,t){const r=u(e,t)/(O(e)*O(t));return-j(r)}function Mt(e,t,r){F(P,e),F(v,t);const c=u(P,v),n=j(c),s=q(P,P,v);return u(s,r)<0?2*Math.PI-n:n}const P=I(),v=I();class a{constructor(t){this._create=t,this._items=new Array,this._itemsPtr=0}get(){return this._itemsPtr===0&&G(()=>this._reset()),this._itemsPtr>=this._items.length&&this._items.push(this._create()),this._items[this._itemsPtr++]}_reset(){const t=2*this._itemsPtr;this._items.length>t&&(this._items.length=t),this._itemsPtr=0}static createVec2f64(){return new a(K)}static createVec3f64(){return new a(I)}static createVec4f64(){return new a(R)}static createMat3f64(){return new a(B)}static createMat4f64(){return new a(H)}static createQuatf64(){return new a(J)}get test(){return{length:this._items.length}}}const gt=a.createVec2f64(),h=a.createVec3f64(),Y=a.createVec4f64();a.createMat3f64();const mt=a.createMat4f64(),_t=a.createQuatf64();function k(e=$){return[e[0],e[1],e[2],e[3]]}function $t(e=$[0],t=$[1],r=$[2],c=$[3]){return z(e,t,r,c,Y.get())}function Z(e,t){return z(t[0],t[1],t[2],t[3],e)}function lt(e){return e}function z(e,t,r,c,n=k()){return n[0]=e,n[1]=t,n[2]=r,n[3]=c,n}function Et(e,t,r){return W(r,e),r[3]=t,r}function tt(e,t,r){const c=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=Math.abs(c-1)>1e-5&&c>1e-12?1/Math.sqrt(c):1;return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=-(r[0]*e[0]+r[1]*e[1]+r[2]*e[2]),r}function et(e,t,r,c=k()){const n=r[0]-t[0],s=r[1]-t[1],i=r[2]-t[2],o=e[0]-t[0],l=e[1]-t[1],E=e[2]-t[2],m=s*E-i*l,w=i*o-n*E,V=n*l-s*o,X=m*m+w*w+V*V,y=Math.abs(X-1)>1e-5&&X>1e-12?1/Math.sqrt(X):1;return c[0]=m*y,c[1]=w*y,c[2]=V*y,c[3]=-(c[0]*e[0]+c[1]*e[1]+c[2]*e[2]),c}function D(e,t,r,c=0,n=Math.floor(r*(1/3)),s=Math.floor(r*(2/3))){if(r<3)return!1;t(_,c);let i=n,o=!1;for(;i<r-1&&!o;)t(M,i),i++,o=!C(_,M);if(!o)return!1;for(i=Math.max(i,s),o=!1;i<r&&!o;)t(N,i),i++,g(d,_,M),F(d,d),g(A,M,N),F(A,A),o=!C(_,N)&&!C(M,N)&&Math.abs(u(d,A))<rt;return o?(et(_,M,N,e),!0):(c!==0||n!==1||s!==2)&&D(e,t,r,0,1,2)}function Pt(e,t,r=!0){const c=t.length/3;return D(e,(n,s)=>Q(n,t[3*s+0],t[3*s+1],t[3*s+2]),r?c-1:c)}const rt=.99619469809,_=I(),M=I(),N=I(),d=I(),A=I();function dt(e,t,r){return t!==e&&Z(e,t),e[3]=-u(e,r),e}function At(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function Ft(e,t,r,c){return q(N,t,e),tt(r,N,c)}function Tt(e,t,r,c){return p(e,t,g(h.get(),r,t),nt,c)}function bt(e,t,r){return t!=null&&p(e,t.origin,t.direction,it,r)}function pt(e,t,r){return p(e,t.origin,t.vector,f.NONE,r)}function wt(e,t,r){return p(e,t.origin,t.vector,f.CLAMP,r)}function Vt(e,t){return b(e,t)>=0}function Xt(e,t){const r=u(e,t.ray.direction),c=-b(e,t.ray.origin);if(c<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return c>0;if((c<0||r<0)&&!(c<0&&r<0))return!0;const n=c/r;return r>0?n<t.c1&&(t.c1=n):n>t.c0&&(t.c0=n),t.c0<=t.c1}function yt(e,t){const r=u(e,t.ray.direction),c=-b(e,t.ray.origin);if(r>-1e-6&&r<1e-6)return c>0;const n=c/r;return r>0?n<t.c1&&(t.c1=n):n>t.c0&&(t.c0=n),t.c0<=t.c1}function Ct(e,t,r){const c=T(h.get(),e,-e[3]),n=ct(e,g(h.get(),t,c),h.get());return x(r,n,c),r}function Lt(e,t,r,c){const n=e,s=h.get(),i=h.get();S(n,s,i);const o=g(h.get(),r,t),l=L(s,o),E=L(i,o),m=L(n,o);return Q(c,l,E,m)}function ct(e,t,r){const c=T(h.get(),e,u(e,t));return g(r,t,c),r}function vt(e,t){return Math.abs(b(e,t))}function b(e,t){return u(e,t)+e[3]}function p(e,t,r,c,n){const s=u(e,r);if(s===0)return!1;let i=-(u(e,t)+e[3])/s;return c&f.CLAMP&&(i=U(i,0,1)),!(!(c&f.INFINITE_MIN)&&i<0||!(c&f.INFINITE_MAX)&&i>1)&&(x(n,t,T(n,r,i)),!0)}const $=[0,0,1,0];var f;(function(e){e[e.NONE=0]="NONE",e[e.CLAMP=1]="CLAMP",e[e.INFINITE_MIN=4]="INFINITE_MIN",e[e.INFINITE_MAX=8]="INFINITE_MAX"})(f||(f={}));const nt=f.INFINITE_MIN|f.INFINITE_MAX,it=f.INFINITE_MAX;export{Z as A,wt as B,Vt as D,k as E,lt as F,Xt as G,yt as H,Ct as J,Lt as K,dt as O,ct as Q,vt as R,bt as S,z as T,Ft as U,b as V,D as X,Et as _,L as a,et as b,h as c,Nt as d,It as e,mt as f,Pt as g,tt as j,_t as o,At as q,Y as r,gt as t,Mt as u,$t as v,Tt as w,pt as z};
