function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/Popup-DTttu7m3.js","assets/index-8ERthB3p.js","assets/index-CzRN3C0i.css","assets/Features-DOmnkW92.js","assets/throttle-jjSnxk80.js","assets/geometryUtils-CgkKOh7w.js","assets/scaleUtils-0K_Ry6I1.js","assets/actionUtils-CxJVN_n7.js","assets/substitute-DkE5N3Tl.js","assets/Feature-XE8RQBJa.js","assets/jsxFactory-BxQYPm-b.js","assets/Attachments-B3bjOZlK.js","assets/unitFormatUtils-3MMEFLJJ.js","assets/ByteSizeUnit-BsxeN7wM.js","assets/Cyclical-BY9qISY1.js","assets/quantityUtils-9zDVxeky.js","assets/AttachmentInfo-CeKPRDIT.js","assets/featureUtils-v_3Xfkxx.js","assets/utils-B6UP7_Wm.js","assets/globalCss-DfZw-NIf.js","assets/Heading-BZW3Ifza.js","assets/widget-D7hEnZDA.js","assets/uriUtils-D5IxC9rb.js","assets/a11yUtils-BChjGAWF.js","assets/utils-DwlzY86L.js","assets/utils-j-RBNfeR.js","assets/cimSymbolUtils-DwzauUMk.js","assets/executeQueryJSON-xSUJ5w9D.js","assets/utils-1zmckiYC.js","assets/query-BtFvR4zF.js","assets/normalizeUtils-Cm7zySIZ.js","assets/normalizeUtilsCommon-DRIluWnF.js","assets/utils-D-bI9C7C.js","assets/pbfQueryUtils-D79yLlDs.js","assets/pbf-C8CvrhFv.js","assets/OptimizedGeometry-DLPswkPy.js","assets/OptimizedFeature-CXeSoBCN.js","assets/OptimizedFeatureSet-Blu9Ckm7.js","assets/themeUtils-C3zvZbsE.js","assets/FeatureRelationshipViewModel-CZQ1zx35.js","assets/featureFormUtils-DWtRp-Kj.js","assets/Spinner-zqgek7zX.js","assets/AnchorElementViewModel-Bb21xlFI.js","assets/ReactiveSet-B8Rb7Vms.js","assets/LayerConstants-B33OP6sh.js","assets/symbolUtils-DGJEMzVR.js","assets/mat2df32-orApM5a3.js","assets/mat2d-D9yIh3Tx.js","assets/webStyleSymbolUtils-BzDS5WjL.js","assets/devEnvironmentUtils-Blrp8lZ5.js","assets/layerViewUtils-Bi2wmOiN.js","assets/actions-BEqjg5J0.js","assets/GoTo-BzS22eXk.js","assets/vmEvent-D4Ubqkbq.js","assets/geometryServiceUtils-B-h5lvUN.js","assets/project-7u3NBcq6.js","assets/Lyr3DWasmPerSceneView-DInyPW1I.js","assets/ILyr3DWasmPerSceneView-vPx4somd.js","assets/WorkerHandle-DKpIZ9kk.js","assets/Lyr3DModule-D80Bh_Eb.js","assets/makeScheduleFunction-CggzEh3c.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{o as l,y as h,X as b,cr as w,gl as W,jA as Le,bO as $,ak as E,w as be,j5 as Ai,gJ as q,P as L,jd as kt,cX as ae,hl as Tn,f$ as It,j6 as Cn,$ as ii,_ as Xe,s as O,cB as Vt,a0 as ve,pT as Pn,hj as $n,ag as it,cv as En,j4 as rt,ct as nt,ej as Mt,pU as lt,c_ as Oi,kk as Rt,a_ as Hi,cY as ht,g8 as ce,bE as Lt,mw as Dn,pV as ge,fh as Sn,d as ni,pW as In,q as Ni,W as si,dZ as Vn,d1 as Qe,b0 as Fi,cl as Rn,bU as Je,dM as Ln,lf as st,dp as At,dt as Ot,dr as Ht,dq as Nt,fY as xt,g0 as An,gI as On,ju as Hn,eb as Nn,cu as ai,K as Fn,t as oi,a1 as Ft,kg as ri,kf as zn,cs as zi,M as Ie,aW as jn,nD as Gn,T as zt,G as qn,pX as Un,c$ as Wn,cI as ji,ds as Bn,Z as jt,cp as Kn,gA as Zn,mY as Gi,bl as Yn,bg as Xn,dj as Qn,gG as ct,fb as qi,b3 as Jn,hx as es,gd as ts,dc as is,m3 as ns}from"./index-8ERthB3p.js";import{k as li,m as Ui,o as hi,s as Wi,v as ss,t as ci,e as as,O as os,n as Ae,i as rs}from"./jsxFactory-BxQYPm-b.js";import{h as at}from"./UpdatingHandles-ugzlsvZF.js";import{_ as Gt,i as ke,n as K,b as ls}from"./screenUtils-BuM_Fswi.js";import{n as hs,c as Bi,l as pi}from"./GraphicsCollection-CKieR40M.js";import{s as cs}from"./ReactiveMap-C-O0lKvJ.js";import"./IViewEvents-Bci6PjlS.js";import{o as Tt}from"./interfaces-D6pIddIh.js";import{g as ps,l as us}from"./heightModelInfoUtils-CdtST1Ra.js";import{l as ui}from"./ViewingMode-Dodu7ZZk.js";import{l as De}from"./Viewpoint-CB1GAuK3.js";import{f as Ki,s as qt,c as Zi,i as et,M as ds,h as gs,u as Yi}from"./mat2d-D9yIh3Tx.js";import{n as ms}from"./mat2df32-orApM5a3.js";import{e as he}from"./mat2df64-CBKYtunK.js";import{r as ys,o as fs,M as di,h as _s,i as vs}from"./mat3-CqxUQBLP.js";import{x as ws,l as ot,o as P,e as gi,v as mi,y as bs,j as ks,q as yi,B as Xi,S as U,r as Ct,u as Ms}from"./vec2-Dt9Foiri.js";import{t as fi}from"./vec2f32-BbH2jxlN.js";import{r as xs,n as x}from"./vec2f64-Diu2Kaa8.js";import{P as Qi,v as Ts}from"./normalizeUtils-Cm7zySIZ.js";import{a as Cs}from"./capabilities-C84AMSCg.js";import{n as Ps}from"./themeUtils-C3zvZbsE.js";import{e as _i}from"./globalCss-DfZw-NIf.js";import{t as $s}from"./accessibleHandler-DsewpcQ5.js";import Es from"./Compass-C-feYp_a.js";import Ds from"./NavigationToggle-QjJqvxo5.js";import Ss from"./Zoom-Ct1er6X1.js";const je={widthBreakpoint:{getValue(i){const e=i.viewSize[0],t=i.breakpoints,n=this.values;return e<=t.xsmall?n.xsmall:e<=t.small?n.small:e<=t.medium?n.medium:e<=t.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(i){const e=i.viewSize[1],t=i.breakpoints,n=this.values;return e<=t.xsmall?n.xsmall:e<=t.small?n.small:e<=t.medium?n.medium:e<=t.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(i){const e=i.viewSize,t=e[0],n=e[1],s=this.values;return n>=t?s.portrait:s.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},pt={xsmall:544,small:768,medium:992,large:1200};function Is(i){const e=i;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function ut(i,e){return e?je[i].valueToClassName[e].split(" "):[]}const Vo=i=>{let e=class extends i{constructor(...t){super(...t),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=pt}initialize(){this.addHandles(w(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),W))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(t){if(t===this._get("breakpoints"))return;const n=Is(t);if(!n){const s=JSON.stringify(pt,null,2);console.warn("provided breakpoints are not valid, using defaults:"+s)}t=n?t:pt,this._set("breakpoints",{...t})}_updateClassNames(){if(!this.container)return;const t=Le.acquire(),n=Le.acquire();let s,a=!1;for(s in je){const o=this[s],r=je[s].getValue({viewSize:this.size,breakpoints:this.breakpoints});o!==r&&(a=!0,this[s]=r,ut(s,o).forEach(c=>n.push(c)),ut(s,r).forEach(c=>t.push(c)))}a&&(this._applyClassNameChanges(t,n),Le.release(t),Le.release(n))}_applyClassNameChanges(t,n){const s=this.container;s&&(n.forEach(a=>s.classList.remove(a)),t.forEach(a=>s.classList.add(a)))}_removeActiveClassNames(){const t=this.container;if(!t)return;let n;for(n in je)ut(n,this[n]).forEach(s=>t.classList.remove(s))}};return l([h()],e.prototype,"breakpoints",null),l([h()],e.prototype,"orientation",void 0),l([h()],e.prototype,"widthBreakpoint",void 0),l([h()],e.prototype,"heightBreakpoint",void 0),e=l([b("esri.views.BreakpointsOwner")],e),e};let ee=class extends ${constructor(){super(...arguments),this.items=new E,this._watchUpdatingTracking=new at,this._callbacks=new Map,this._projector=li(),this._hiddenProjector=li()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,t=>{for(const n of t.added){const s=()=>n.render();this._callbacks.set(n,s),this._projector.append(this.surface,s)}for(const n of t.removed){const s=this._projector.detach(this._callbacks.get(n));this.surface.removeChild(s.domNode),this._callbacks.delete(n)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const t=this._hiddenSurface,n=this._hiddenProjector;let s;const a=()=>(s=e.render(),s);n.append(t,a),n.renderNow();const o={left:0,top:0,right:0,bottom:0};if(s!=null&&s.domNode){const r=s.domNode.getBoundingClientRect();o.left=r.left,o.top=r.top,o.right=r.right,o.bottom=r.bottom}for(n.detach(a);t.firstChild;)t.removeChild(t.firstChild);return o}overlaps(e,t){const n=this.computeBoundingRect(e),s=this.computeBoundingRect(t);return Math.max(n.left,s.left)<=Math.min(n.right,s.right)&&Math.max(n.top,s.top)<=Math.min(n.bottom,s.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e,t){const n=!!(t!=null&&t.disableDecorations);if(!this.items.some(a=>a.visible&&!(n&&a.isDecoration)))return;const s=e.getContext("2d");s.save(),s.font=this._fontString(),this.items.forEach(a=>{n&&a.isDecoration||(s.save(),a.renderCanvas(s),s.restore())}),s.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};l([h({readOnly:!0})],ee.prototype,"surface",void 0),l([h({readOnly:!0})],ee.prototype,"items",void 0),l([h({readOnly:!0})],ee.prototype,"needsRender",null),l([h({readOnly:!0})],ee.prototype,"_watchUpdatingTracking",void 0),l([h({readOnly:!0})],ee.prototype,"updating",null),ee=l([b("esri.views.overlay.ViewOverlay")],ee);const vi=ee,dt=[0,0];function Vs(i){const e=(i.ownerDocument||window.document).defaultView,t=i.getBoundingClientRect();return dt[0]=t.left+((e==null?void 0:e.pageXOffset)??0),dt[1]=t.top+((e==null?void 0:e.pageYOffset)??0),dt}function wi(i){i&&(Wi(i),i.parentNode&&i.parentNode.removeChild(i))}function Rs(i){const e=document.createElement("div");return i.appendChild(e),e}const xe=16,Oe=750,Ls=512,As=2,Lo=i=>{let e=class extends i{constructor(...t){super(...t),this._freqInfo={freq:xe,time:Oe},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([w(()=>this.cursor,n=>{const{surface:s}=this;s&&s.setAttribute("data-cursor",n)}),w(()=>this.navigating,n=>{const{surface:s}=this;s&&s.setAttribute("data-navigating",n.toString())})])}initialize(){const t=be("mac"),n=async()=>{t&&(await It(()=>this.ready),this.messagesCommon=await Cn("esri/t9n/common").catch(()=>{}))};n(),this.addHandles([w(()=>this.ui,(s,a)=>this._handleUIChange(s,a),W),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused")),Ai(n),w(()=>[this.surface,this.messagesCommon],()=>{var s,a,o;t&&((o=this.surface)==null||o.setAttribute("aria-label",((a=(s=this.messagesCommon)==null?void 0:s.ariaLabels)==null?void 0:a.navigationMacVoiceOver)??""))})])}destroy(){this.destroyed||(this.ui=q(this.ui),this.container=null)}get container(){return this._get("container")??null}set container(t){const n=this._get("container"),s=Ui(t);if(s||typeof t!="string"||L.getLogger(this).error("#container",`element with id '${t}' not found`),n===s)return;if(this._stopMeasuring(),n&&(n.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(wi(this.root),this._set("root",null)),this.userContent&&(hi(this.userContent,n),wi(this.userContent),this._set("userContent",null))),!s)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);s.classList.add("esri-view");const a=document.createElement("div");a.className="esri-view-user-storage",hi(s,a),s.appendChild(a),this._set("userContent",a);const o=document.createElement("div");o.className="esri-view-root",s.insertBefore(o,s.firstChild),this._set("root",o);const r=document.createElement("div");r.className="esri-view-surface",r.setAttribute("role","application"),r.tabIndex=0,o.appendChild(r),this._set("surface",r);const c=new vi;o.appendChild(c.surface),this._set("overlay",c),this.addHandles(w(()=>c.needsRender,p=>{p&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=kt({render:()=>{var d;return(d=this.overlay)==null?void 0:d.render()}}):this._overlayRenderTaskHandle=ae(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",s),this._startMeasuring()}get focused(){const t=document.activeElement===this.surface;return document.hasFocus()&&t}get size(){return[this.width,this.height]}blur(){var t;(t=this.surface)==null||t.blur()}focus(){var t;(t=this.surface)==null||t.focus()}pageToContainer(t,n,s){const a=this.position;return t-=a?a[0]:0,n-=a?a[1]:0,s?(s[0]=t,s[1]=n):s=[t,n],s}containerToPage(t,n,s){const a=this.position;return t+=a?a[0]:0,n+=a?a[1]:0,s?(s[0]=t,s[1]=n):s=[t,n],s}_handleUIChange(t,n){this.removeHandles("ui"),n&&n!==t&&n.destroy(),t&&(t.view=this,this.addHandles(w(()=>this.root,s=>{t.container=s?Rs(s):null},W),"ui")),this._set("ui",t)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const t=this._freqInfo;t.freq=xe,t.time=Oe,this.addHandles([Tn(window,"resize",()=>{t.freq=xe,t.time=Oe}),kt({prepare:n=>{const s=this._measure(),a=this._freqInfo;if(a.time+=n.deltaTime,s&&(a.freq=xe,this._get("resizing")||this._set("resizing",!0)),a.time<a.freq)return;a.time=0;const o=this._position();a.freq=o||s?xe:Math.min(Oe,a.freq*As),!s&&a.freq>=Ls&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const t=this.container,n=t?t.clientWidth:0,s=t?t.clientHeight:0;if(n===0||s===0)return this.suspended||this._set("suspended",!0),!1;const a=this.width,o=this.height;return n===a&&s===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",n),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:a,oldHeight:o,width:n,height:s}),!0)}_position(){const t=this.container,n=this.position,s=t&&Vs(t);return!!s&&(!n||s[0]!==n[0]||s[1]!==n[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return l([h()],e.prototype,"container",null),l([h({readOnly:!0})],e.prototype,"focused",null),l([h({readOnly:!0})],e.prototype,"height",void 0),l([h()],e.prototype,"messagesCommon",void 0),l([h({type:vi})],e.prototype,"overlay",void 0),l([h({readOnly:!0})],e.prototype,"position",void 0),l([h({readOnly:!0})],e.prototype,"resizing",void 0),l([h({readOnly:!0})],e.prototype,"root",void 0),l([h({value:null,readOnly:!0})],e.prototype,"size",null),l([h({readOnly:!0})],e.prototype,"surface",void 0),l([h({readOnly:!0})],e.prototype,"suspended",void 0),l([h()],e.prototype,"ui",void 0),l([h({readOnly:!0})],e.prototype,"userContent",void 0),l([h({readOnly:!0})],e.prototype,"width",void 0),l([h()],e.prototype,"widthBreakpoint",void 0),e=l([b("esri.views.DOMContainer")],e),e};function z(i){return i!=null&&"open"in i&&"declaredClass"in i}function bi(i){return i!=null&&"declaredClass"in i&&"dockOptions"in i}const Ao=i=>{let e=class extends i{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([w(()=>[this.ui,this.popup],([t,n],s)=>{const a="popup",o="manual";if(s){const[r,c]=s;r&&z(c)&&(c.view=null,bi(c)&&r.remove(c,a))}t&&z(n)&&(n.view=this,bi(n)&&t.add(n,{key:a,position:o,internal:!0}))},W),this.on("click",t=>{this.popup&&this.popupEnabled&&(t.pointerType!=="mouse"||t.button===0)&&(!z(this.popup)&&"autoOpenEnabled"in this.popup&&this.popup.autoOpenEnabled===!1||(z(this.popup)?this.popup.viewModel.handleViewClick(t):t.async(async()=>{await this.setupPopup(),z(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(t)})))},Gt.WIDGET)]),It(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>{Xe(()=>import("./Popup-DTttu7m3.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53]))})}destroy(){this.destroyed||this.closePopup()}async openPopup(t){if(z(this.popup))return this.popup.open(t);try{if(await this.setupPopup(),!this.popup)return void L.getLogger(this).error(new O("view:null-popup","Popup is null and can't be opened"));this.popup.open(t)}catch{}}closePopup(){var t;(t=this._popupSetupTask)==null||t.abort(),z(this.popup)&&this.popup.close()}async fetchPopupFeatures(t,n){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(t,n),n)}async setupPopup(){var t;if((t=this._popupSetupTask)==null||t.abort(),this.popup&&!z(this.popup))return this._popupSetupTask=Vt(async n=>{const{default:s}=await Xe(()=>import("./Popup-DTttu7m3.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53]));if(ve(n),!this.popup||z(this.popup))return;const a=this.popup;delete a.open,delete a.close,this.popup=new s(a)}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:t,hits:n},s){const a=[],o=[];let r=!1;const c=Pn(s,be("popup-view-fetch-timeout")??Hs),p=u=>{const y=new Os(u);return o.push(y),a.push(y.promise),y},d=u=>{const y=o.at(-1);return y&&y.layerView===u&&!r?y:p(u)};for(const u of n)"graphic"in u?(d(u.layerView).graphics.push(u.graphic),r=!1):(a.push(u.layerView.fetchPopupFeaturesAtLocation(u.mapPoint,c)),r=!0);o.map(u=>u.resolve(c));const g=$n(a).then(u=>u.filter(y=>!!y).flat());return{pendingFeatures:a,allGraphicsPromise:g,location:t}}async _getPopupHits(t,n){const{hits:s,location:a}=await this.popupHitTest(t);ve(n);const o=[];for(const r of s)if("graphic"in r){if(this._isValidPopupGraphic(r.graphic,n)){const c=this._isValidPopupGraphicsLayerView(r.layerView)?r.layerView:void 0;o.push({graphic:r.graphic,layerView:c})}}else this._isValidPopupLocationLayerView(r.layerView)&&o.push({mapPoint:r.mapPoint,layerView:r.layerView});return{hits:o,location:a}}_isValidPopupGraphic(t,n){return t&&!!t.getEffectivePopupTemplate(n!=null&&n.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(t){return!t||(!("layer"in t)||!t.suspended)&&"fetchPopupFeaturesFromGraphics"in t}_isValidPopupLocationLayerView(t){return(!("layer"in t)||!t.suspended)&&"fetchPopupFeaturesAtLocation"in t}};return l([h({cast(t){return!t||z(t)||typeof t=="object"&&(t.open=n=>(ii(L.getLogger(this),"view.popup is no longer created by default. view.popup.open() will stop working when the popup isn't created",{replacement:"Use view.openPopup() instead.",version:"4.27"}),this.openPopup(n)),t.close=()=>(ii(L.getLogger(this),"view.popup is no longer created by default. view.popup.close() will stop working when the popup isn't created",{replacement:"Use view.closePopup() instead.",version:"4.27"}),this.closePopup())),t}})],e.prototype,"popup",void 0),l([h()],e.prototype,"popupEnabled",void 0),e=l([b("esri.views.PopupView")],e),e};let Os=class{constructor(e){this.layerView=e,this._resolver=it(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:t,graphics:n,_resolver:s}=this;if(!t)return s.resolve(n),s.promise;let a;return t.fetchPopupFeaturesFromGraphics(n,e).catch(o=>(a=o,null)).then(o=>{o?s.resolve(o):s.reject(a)}),s.promise}};const Hs=5e3;let tt=class extends hs{constructor(e){super(e),this.addHandles(this.on("before-add",t=>{t.item!=null&&t.item.parent===this.owner&&(L.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),t.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};tt=l([b("esri.support.AnalysesCollection")],tt);let te=class extends ${constructor(e){super(e),this.view=null,this.baseLayerViews=new E,this.referenceLayerViews=new E,this._loadingHandle=w(()=>{var t,n;return(n=(t=this.view)==null?void 0:t.map)==null?void 0:n.basemap},t=>{t&&t.load().catch(()=>{})},W)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(const e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){return!this.view||this.view.suspended}get updating(){var t,n;if(this.view&&this.view.suspended)return!1;const e=(n=(t=this.view)==null?void 0:t.map)==null?void 0:n.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(s=>s.updating)||this.referenceLayerViews.some(s=>s.updating))}};l([h({constructOnly:!0})],te.prototype,"view",void 0),l([h({readOnly:!0})],te.prototype,"baseLayerViews",void 0),l([h({readOnly:!0})],te.prototype,"referenceLayerViews",void 0),l([h({readOnly:!0})],te.prototype,"suspended",null),l([h({type:Boolean,readOnly:!0})],te.prototype,"updating",null),te=l([b("esri.views.BasemapView")],te);function Ns(i){return"tryRecycleWith"in i}class Fs{constructor(e,t,n){this.layer=e,this.view=t,this.layerViewImporter=n,this._controller=new AbortController,this._deferred=it(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,ht(this._controller.signal,()=>{const s=new O("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(s)})}tryRecycle(e){if(!this.done||!this.layerView||!Ns(this.layerView))return null;const t=this.layer.type,n=this._controller.signal;for(let s=0;s<e.length;s++){const a=e[s];if(a.type!==t)continue;const o=this.layerView.tryRecycleWith(a,{signal:n});if(o){e.splice(s,1),this.layer=a;const r=this.layerView,c=r.view;return this.promise=Promise.race([o.then(()=>(ve(this._controller.signal),a.emit("layerview-destroy",{view:c,layerView:r}),c.emit("layerview-destroy",{view:c,layerView:r}),a.emit("layerview-create",{view:c,layerView:r}),c.emit("layerview-create",{view:c,layerView:r}),r)),new Promise((p,d)=>ht(this._controller.signal,()=>d(Oi())))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:t,view:n}=this;t.emit("layerview-destroy",{view:n,layerView:e}),n.emit("layerview-destroy",{layer:t,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){var s,a;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:t,view:n}=this;this._map=n.map;try{let o,r;if(await t.load({signal:e}),t.prefetchResources&&await t.prefetchResources({signal:e}),js(t))o=await t.createLayerView(n,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(t))throw new O("layer:view-not-supported","No layerview implementation was found");const d=await this.layerViewImporter.importLayerView(t);ve(e),o="default"in d?new d.default({layer:t,view:n}):new d({layer:t,view:n})}const c=()=>{r=ae(r),o.destroyed||o.destroy(),o.layer=null,o.parent=null,o.view=null,this.done=!0};r=ht(e,c),ve(e);try{await o.when()}catch(d){throw c(),d}if(!((a=(s=this._map)==null?void 0:s.allLayers)==null?void 0:a.includes(t)))return c(),void this._deferred.reject(new O("view:no-layerview-for-layer","The layer has been removed from the map",{layer:t}));this.layerView=o,t.emit("layerview-create",{view:n,layerView:o}),n.emit("layerview-create",{layer:t,layerView:o}),this.done=!0,this._deferred.resolve(o)}catch(o){t.emit("layerview-create-error",{view:n,error:o}),n.emit("layerview-create-error",{layer:t,error:o}),this.done=!0,this._deferred.reject(new O("layerview:create-error","layerview creation failed",{layer:t,error:o}))}}}let H=class extends ${constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new at,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var n;const t=(n=this.view.map)==null?void 0:n.allLayers;if(t)for(const s of t)this.layerViewImporter.hasLayerViewModule(s)&&this.layerViewImporter.importLayerView(s)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=it(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(En(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var c,p,d;if(this.destroyed)return;const t=this.view.map;if(this._map!==t&&(this.clear(),this._map=t),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const n=new Set,s=[],a=this.view.ready,o=g=>{if(g!=null){for(const u of g)if(u){n.add(u);const y=this._layerLayerViewInfoMap.get(u);y&&a?y.start():y||this._recyclingInfoMap.has(u)||s.push(u),"layers"in u&&u.layers&&o(u.layers)}}};for(const g of this._rootCollectionNames)o(rt(this,g));for(const[g,u]of this._layerLayerViewInfoMap)if(!n.has(g)){this._layerLayerViewInfoMap.delete(u.layer);const y=u.tryRecycle(s);y?(this.notifyChange("updating"),this._recyclingInfoMap.set(u.layer,u),y.then(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(u.layer),this._layerLayerViewInfoMap.set(u.layer,u),this._reschedule()}).catch(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(u.layer),u.destroy(),this._reschedule()})):u.destroy()}for(const[g,u]of this._recyclingInfoMap)n.has(g)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(u.layer),u.destroy());for(const g of s)this._createLayerView(g);this._refreshCollections();const r=[(c=t==null?void 0:t.ground)==null?void 0:c.layers,(p=t==null?void 0:t.basemap)==null?void 0:p.baseLayers,(d=t==null?void 0:t.basemap)==null?void 0:d.referenceLayers,t==null?void 0:t.layers].filter(g=>!!g);n.forEach(g=>"layers"in g&&r.push(g.layers)),this.addHandles(r.map(g=>this._watchUpdatingTracking.addOnCollectionChange(()=>g,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([nt(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),w(()=>{const e=this.view,t=e==null?void 0:e.map;return[t==null?void 0:t.basemap,t==null?void 0:t.ground,t==null?void 0:t.layers,e==null?void 0:e.ready]},()=>this._reschedule(),Mt)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),lt(this._recyclingInfoMap),lt(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(Oi()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||Rt(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const t of this._layerLayerViewInfoMap.values())t.done||++e;return e}clear(){this.destroyed||(lt(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new O("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}_refreshCollections(){for(const[e,t]of this._layersToLayerViews)this._populateLayerViewsOwners(rt(this,e),rt(this,t),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,t,n){if(!e||!t)return void(t&&t.removeAll());let s=0;for(const a of e){const o=this._layerLayerViewInfoMap.get(a);if(!(o!=null&&o.layerView))continue;const r=o.layerView;r.layer=a,r.parent=n,t.at(s)!==r&&t.splice(s,0,r),a.layers&&this._populateLayerViewsOwners(a.layers,r.layerViews,r),s+=1}s<t.length&&t.splice(s,t.length)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const t=new Fs(e,this.view,this.layerViewImporter);t.promise.then(()=>this._refreshCollections(),n=>{n&&(Hi(n)||n.name==="cancelled:layerview-create")||L.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:n}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,t),this.view.ready&&t.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};l([h()],H.prototype,"_workPromise",void 0),l([h({readOnly:!0})],H.prototype,"_watchUpdatingTracking",void 0),l([h({readOnly:!0})],H.prototype,"_layersToLayerViews",null),l([h({readOnly:!0})],H.prototype,"_rootCollectionNames",null),l([h()],H.prototype,"layerViewImporter",void 0),l([h()],H.prototype,"supportsGround",void 0),l([h({readOnly:!0})],H.prototype,"updating",null),l([h({readOnly:!0})],H.prototype,"updatingRemaining",null),l([h({constructOnly:!0})],H.prototype,"view",void 0),H=l([b("esri.views.LayerViewManager")],H);const zs=H;function js(i){return"createLayerView"in i&&i.createLayerView!=null}let R=class extends ${constructor(e){super(e),this.factor=1.5,this.offset=ce(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};l([h({type:Number})],R.prototype,"factor",void 0),l([h({nonNullable:!0})],R.prototype,"offset",void 0),l([h()],R.prototype,"position",void 0),l([h({type:Number,range:{min:0}})],R.prototype,"size",void 0),l([h()],R.prototype,"maskUrl",void 0),l([h()],R.prototype,"maskEnabled",void 0),l([h()],R.prototype,"overlayUrl",void 0),l([h()],R.prototype,"overlayEnabled",void 0),l([h({readOnly:!0})],R.prototype,"version",null),l([h({type:Boolean})],R.prototype,"visible",void 0),R=l([b("esri.views.Magnifier")],R);const Ji=R;let X=class extends Lt.EventedAccessor{constructor(e){super(e),this._selectionMap=new cs,this._trashCan=[],this._layerEditHandles=new E,this._vizTaskId=0,this.showHighlight=!0}initialize(){this.addHandles([w(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),nt(()=>this.sources,"change",t=>{const n=this._selectionMap;for(const s of t.removed)n.delete(s);this._refreshListeners(),this._refreshVisualization()},{onListenerAdd:()=>this._refreshListeners()})]);const e=new E;this.view.when().then(()=>{this.view.map.allLayers.flatten(t=>"sublayers"in t&&t.sublayers?t.sublayers:null).forEach(t=>{(He(t)&&!Dn(t)||ge(t))&&e.add(t)}),this._set("sources",e)})}destroy(){this._layerEditHandles.drain(ae)}get selections(){return Array.from(this._selectionMap.entries()).map(e=>{const[t,n]=e;return{layer:t,selection:[...n.selection]}})}get count(){let e=0;for(const t of this._selectionMap.values())e+=t.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._get("sources")}set sources(e){this._set("sources",e)}async getSelectedFeatures(e,t={},n="layerView"){const{view:s,selections:a}=this,o=(e!==void 0?a.filter(r=>e.includes(r.layer)):a).filter(r=>r.selection.length>0).map(async r=>{const{layer:c,selection:p}=r,d=ge(c)?c.parent:c;if(d==null||!ki(d))return null;if(n==="layer")return Mi(d,p,t);const g=await s.whenLayerView(d);return Mi(g,p,t)});return(await Promise.all(o)).filter(r=>r!==null)}updateSelection(e){const t=new Map;for(const[a,o]of this._selectionMap)t.set(a,[...o.selection]);let n=!1;const s=e.current.concat(e.added);for(const a of s){const o=a.sourceLayer,r=a.getObjectId();if(this.sources.includes(o)&&(He(o)||ge(o))&&r!==null){const c=Sn(t,o,()=>[]);c.includes(r)||(c.push(r),n=!0)}}for(const a of e.removed){const o=a.sourceLayer,r=a.getObjectId();if(this.sources.includes(o)&&(He(o)||ge(o))&&r!==null){const c=t.get(o),p=c==null?void 0:c.indexOf(r);p!==void 0&&p>=0&&(c==null||c.splice(p,1),n=!0)}}if(n){const{_selectionMap:a,_trashCan:o}=this,r=[];for(const[c,p]of t){const d=a.get(c);d!==void 0&&o.push(d),a.set(c,{selection:p}),r.push({layer:c,selection:p,...ni(d!==void 0?d.selection:[],p)})}this._onSelectionChange(r)}}setSelection(e,t){this._setSelection(e,t)}getSelection(e){const t=this._selectionMap.get(e);return t==null?void 0:t.selection}appendToSelection(e,t){const n=this._selectionMap.get(e),s=n!==void 0?[...n.selection]:[];for(const a of t)s.includes(a)||s.push(a);this._setSelection(e,s)}removeFromSelection(e,t){const n=this._selectionMap.get(e);if(!n)return;const s=[];for(const a of n.selection)t.includes(a)||s.push(a);this._setSelection(e,s)}toggleInSelection(e,t){const n=this._selectionMap.get(e);if(!n||n.selection.length===0)return void this._setSelection(e,t);const s=new Set(n.selection),a=new Set(t),o=In(s,a);this._setSelection(e,Array.from(o))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const t=[];for(const[n,s]of this._selectionMap.entries())t.push({layer:n,added:[],removed:[...s.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(t)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){var o;if(this.view==null||this.sources==null)return;for(this._vizTaskId++;this._trashCan.length>0;){const r=this._trashCan.pop();(o=r==null?void 0:r.highlightHandle)==null||o.remove()}const{sources:e,view:t,_selectionMap:n,showHighlight:s}=this,a=this._vizTaskId;for(const r of e){const c=n.get(r),p=ge(r)?r.parent:r;p!=null&&ki(p)&&t.whenLayerView(p).then(d=>{var g;(g=c==null?void 0:c.highlightHandle)==null||g.remove(),c!==void 0&&s&&a===this._vizTaskId&&"highlight"in d&&typeof d.highlight=="function"&&c.selection.length>0&&(c.highlightHandle=d.highlight(c.selection,"selection"))})}}_refreshListeners(){this._layerEditHandles.drain(ae);for(const e of this.sources){const t=ge(e)?e.parent:e;if(t!=null&&He(t)){const n=t.on("edits",s=>{this._handleEditChanges(s,e)});this._layerEditHandles.push(n)}}}_handleEditChanges(e,t){if(e.deletedFeatures!==void 0&&e.deletedFeatures.length>0&&this._selectionMap.has(t)){const n=e.deletedFeatures.filter(s=>s.error==null).map(s=>s.objectId).filter(Ni);this.removeFromSelection(t,n)}}_setSelection(e,t){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const n=this._selectionMap.get(e);if(n===void 0||!qs(n,{selection:t})){n!==void 0&&this._trashCan.push(n),this._selectionMap.set(e,{selection:[...t]});const s={layer:e,selection:[...t],...ni(n!==void 0?n.selection:[],t)};this._onSelectionChange([s])}}};l([h({readOnly:!0,nonNullable:!0})],X.prototype,"selections",null),l([h({readOnly:!0,nonNullable:!0})],X.prototype,"count",null),l([h({constructOnly:!0,nonNullable:!0})],X.prototype,"view",void 0),l([h({readOnly:!0,nonNullable:!0})],X.prototype,"hasSelection",null),l([h()],X.prototype,"showHighlight",void 0),l([h()],X.prototype,"sources",null),X=l([b("esri.views.SelectionManager")],X);const He=i=>i.createQuery!==void 0&&i.on!==void 0,Gs=i=>i.layer!==void 0,ki=i=>(i==null?void 0:i.when)!==void 0,qs=(i,e)=>{if(i==null&&e==null)return!0;if(i!=null&&e==null||i==null&&e!=null)return!1;if(i!=null&&e!=null&&i.selection!=null&&e.selection!=null){const t=[...i.selection],n=[...e.selection];if(t.length!==n.length)return!1;t.sort(),n.sort();for(let s=0;s<t.length;s++)if(t[s]!==n[s])return!1}return!0},Mi=async(i,e,t={})=>{let n;if(Gs(i)){const s=i;n=s===void 0?null:await s.queryFeatures(new si({...t,objectIds:e})).then(a=>({data:a,layer:i.layer}))}else{const s=i;n=s===void 0?null:await s.queryFeatures(new si({...t,objectIds:e})).then(a=>({data:a,layer:s}))}return n},Us=X;let Ce=class extends Vn($){constructor(e){super(e),this.accentColor=new Qe([255,127,0]),this.textColor=new Qe([255,255,255])}};l([h({type:Qe,nonNullable:!0})],Ce.prototype,"accentColor",void 0),l([h({type:Qe,nonNullable:!0})],Ce.prototype,"textColor",void 0),Ce=l([b("esri.views.Theme")],Ce);const Pt=Ce,en=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],tn={};function nn(i){return!!tn[i]}function Ws(i){for(const e of i)if(!nn(e))return!1;return!0}en.forEach(i=>{tn[i]=!0});let Bs=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:t,priority:n},s)=>{var a;return(a=this.inputManager)==null?void 0:a.installHandlers(s,[t],n)})}disconnect(){this.inputManager&&this._handlers.forEach((e,t)=>{var n;return(n=this.inputManager)==null?void 0:n.uninstallHandlers(t)}),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,t,n,s){const a=Array.isArray(e)?e:e.split(",");if(!Ws(a))return a.some(nn)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,r;Array.isArray(t)?r=t:(o=t,r=[]),typeof n=="function"?o=n:s=n,s=s??Gt.DEFAULT;const c=this._createUniqueGroupName(),p=new Ks(this.view,a,r,o);this._handlers.set(c,{handler:p,priority:s});for(const d of a){const g=this._handlerCounts.get(d)||0;this._handlerCounts.set(d,g+1)}return this.inputManager&&this.inputManager.installHandlers(c,[p],s),Fi(()=>this._removeHandler(c,a))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,t){if(this._handlers.has(e)){this._handlers.delete(e);for(const n of t){const s=this._handlerCounts.get(n);s===void 0?console.error("Trying to remove handler for event that has no handlers registered: ",n):s===1?this._handlerCounts.delete(n):this._handlerCounts.set(n,s-1)}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},Ks=class extends ke{constructor(e,t,n,s){super(!0),this._latestDragStart=void 0,this.view=e;for(const a of t)switch(a){case"click":this.registerIncoming("click",n,o=>s(this._wrapClick(o)));break;case"double-click":this.registerIncoming("double-click",n,o=>s(this._wrapDoubleClick(o)));break;case"immediate-click":this.registerIncoming("immediate-click",n,o=>s(this._wrapImmediateClick(o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",n,o=>s(this._wrapImmediateDoubleClick(o)));break;case"hold":this.registerIncoming("hold",n,o=>s(this._wrapHold(o)));break;case"drag":this.registerIncoming("drag",n,o=>{const r=this._wrapDrag(o);r&&s(r)});break;case"key-down":this.registerIncoming("key-down",n,o=>s(this._wrapKeyDown(o)));break;case"key-up":this.registerIncoming("key-up",n,o=>s(this._wrapKeyUp(o)));break;case"pointer-down":this.registerIncoming("pointer-down",n,o=>s(this._wrapPointer(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",n,o=>s(this._wrapPointer(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",n,o=>s(this._wrapPointer(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",n,o=>s(this._wrapPointerDrag(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",n,o=>s(this._wrapMouseWheel(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",n,o=>s(this._wrapPointer(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",n,o=>s(this._wrapPointer(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",n,o=>{s(this._wrapGamepad(o))});break;case"focus":this.registerIncoming("focus",n,o=>{s(this._wrapFocus(o))});break;case"blur":this.registerIncoming("blur",n,o=>{s(this._wrapBlur(o))})}}_wrapFocus(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapBlur(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapClick(e){const{pointerType:t,button:n,buttons:s,x:a,y:o,native:r,eventId:c}=e.data,{cancelable:p,timestamp:d}=e;return{type:"click",pointerType:t,button:n,buttons:s,x:a,y:o,native:r,timestamp:d,screenPoint:ce(a,o),mapPoint:this._getMapPoint(a,o),eventId:c,cancelable:p,stopPropagation:()=>e.stopPropagation(),async:g=>e.async(g),preventDefault:()=>e.preventDefault()}}_wrapDoubleClick(e){const{pointerType:t,button:n,buttons:s,x:a,y:o,native:r,eventId:c}=e.data,{cancelable:p,timestamp:d}=e;return{type:"double-click",pointerType:t,button:n,buttons:s,x:a,y:o,native:r,timestamp:d,mapPoint:this._getMapPoint(a,o),eventId:c,cancelable:p,stopPropagation:()=>e.stopPropagation(),async:g=>e.async(g),preventDefault:()=>e.preventDefault()}}_wrapImmediateClick(e){const{pointerType:t,button:n,buttons:s,x:a,y:o,native:r,eventId:c}=e.data,p=r.pointerId,{cancelable:d,timestamp:g}=e;return{type:"immediate-click",pointerId:p,pointerType:t,button:n,buttons:s,x:a,y:o,native:r,timestamp:g,mapPoint:this._getMapPoint(a,o),eventId:c,cancelable:d,stopPropagation:()=>e.stopPropagation(),async:u=>e.async(u),preventDefault:()=>e.preventDefault()}}_wrapImmediateDoubleClick(e){const{pointerType:t,button:n,buttons:s,x:a,y:o,native:r,eventId:c}=e.data,p=r.pointerId,{cancelable:d,timestamp:g}=e;return{type:"immediate-double-click",pointerId:p,pointerType:t,button:n,buttons:s,x:a,y:o,native:r,timestamp:g,mapPoint:this._getMapPoint(a,o),eventId:c,cancelable:d,stopPropagation:()=>e.stopPropagation(),async:u=>e.async(u),preventDefault:()=>e.preventDefault()}}_wrapHold(e){const{pointerType:t,button:n,buttons:s,x:a,y:o,native:r}=e.data,{cancelable:c,timestamp:p}=e;return{type:"hold",pointerType:t,button:n,buttons:s,x:a,y:o,native:r,timestamp:p,mapPoint:this._getMapPoint(a,o),cancelable:c,stopPropagation:()=>e.stopPropagation(),async:d=>e.async(d),preventDefault:()=>e.preventDefault()}}_getMapPoint(e,t){return this.view.toMap(ce(e,t),{exclude:[]})}_wrapDrag(e){const t=e.data,{x:n,y:s}=t.center,{action:a,pointerType:o,button:r}=t;if(a==="start"&&(this._latestDragStart=t),!this._latestDragStart)return;const c=t.pointer.native,p=t.buttons,{cancelable:d,timestamp:g}=e,u={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return a==="end"&&(this._latestDragStart=void 0),{type:"drag",action:a,x:n,y:s,origin:u,pointerType:o,button:r,buttons:p,radius:t.radius,angle:Rn(t.angle),native:c,timestamp:g,cancelable:d,stopPropagation:()=>e.stopPropagation(),async:y=>e.async(y),preventDefault:()=>e.preventDefault()}}_wrapKeyDown(e){const{key:t,repeat:n,native:s}=e.data,{cancelable:a,timestamp:o}=e;return{type:"key-down",key:t,repeat:n,native:s,timestamp:o,cancelable:a,stopPropagation:()=>e.stopPropagation(),async:r=>e.async(r),preventDefault:()=>e.preventDefault()}}_wrapKeyUp(e){const{key:t,native:n}=e.data,{cancelable:s,timestamp:a}=e;return{type:"key-up",key:t,native:n,timestamp:a,cancelable:s,stopPropagation:()=>e.stopPropagation(),async:o=>e.async(o),preventDefault:()=>e.preventDefault()}}_wrapPointer(e,t){const{x:n,y:s,button:a,buttons:o,native:r,eventId:c}=e.data,p=r.pointerId,d=r.pointerType,{cancelable:g,timestamp:u}=e;return{type:t,x:n,y:s,pointerId:p,pointerType:d,button:a,buttons:o,native:r,timestamp:u,eventId:c,cancelable:g,stopPropagation:()=>e.stopPropagation(),async:y=>e.async(y),preventDefault:()=>e.preventDefault()}}_wrapPointerDrag(e){const{x:t,y:n,buttons:s,native:a,eventId:o}=e.data.currentEvent,{button:r}=e.data.startEvent,c=e.data.startEvent.native.pointerId,p=e.data.startEvent.native.pointerType,d=e.data.action,g={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:u,timestamp:y}=e;return{type:"pointer-drag",x:t,y:n,pointerId:c,pointerType:p,button:r,buttons:s,action:d,origin:g,native:a,timestamp:y,eventId:o,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:v=>e.async(v),preventDefault:()=>e.preventDefault()}}_wrapMouseWheel(e){const{cancelable:t,data:n,timestamp:s}=e,{x:a,y:o,deltaY:r,native:c}=n;return{type:"mouse-wheel",x:a,y:o,deltaY:r,native:c,timestamp:s,cancelable:t,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}_wrapGamepad(e){const{action:t,state:n,device:s}=e.data,{cancelable:a,timestamp:o}=e,{buttons:r,axes:c}=n;return{type:"gamepad",device:s,timestamp:o,action:t,buttons:r,axes:c,cancelable:a,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}};function Zs(i){return[i.on("before-add",e=>{const t=e.item;if(t==null||i.includes(t))return L.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();t.onAdd()}),i.on("after-remove",e=>{const t=e.item;t.active&&(t.view.activeTool=null),t.destroy()})]}function $t(i){return i.visible&&i.getEditableFlag!=null&&i.getEditableFlag(Tt.USER)&&i.getEditableFlag(Tt.MANAGER)}let Ys=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,t){const n=()=>e.stopPropagation();switch(e.type){case"pointer-move":xi(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(n(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!Ti(e))break;const s=K(e),a=this._intersect(s,e.pointerType,t.forEachTool);if(a==null)break;const o=a.manipulator,r=a.tool;o==null||r==null||!o.interactive||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._releaseManipulatorBeforeDragging(o,e,t),o!=null&&r!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:r,start:s,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&t.activeTool==null&&(this._revertToNullActiveTool=!0,t.setActiveTool(a.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:s}),n());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,t);break;case"pointer-drag":{if(!Ti(e))break;const s=this._grabbedManipulators.get(e.pointerId),a=s==null?void 0:s.manipulator,o=s==null?void 0:s.tool;if(a==null||o==null)break;const r=K(e);r.x=Je(r.x,0,t.view.width),r.y=Je(r.y,0,t.view.height);const c=s.start,p=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(a.dragging=!0,p?a.events.emit("drag",{action:"update",start:c,screenPoint:r}):a.events.emit("drag",{action:"start",start:c,screenPoint:r,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:a,start:c}));break;case"end":a.dragging=!1,p&&a.events.emit("drag",{action:"end",start:c,screenPoint:r}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,t)}n();break}case"immediate-click":{const s=K(e),a=this._intersect(s,e.pointerType,t.forEachTool);if(Xs(e)||t.forEachTool(p=>{if((a==null||a.tool!==p||p.automaticManipulatorSelection)&&p.manipulators){let d=!1;p.manipulators.forEach(({manipulator:g})=>{g.selected&&(g.selected=!1,d=!0)}),d&&p.onManipulatorSelectionChanged&&p.onManipulatorSelectionChanged()}}),a==null)break;const{manipulator:o,tool:r}=a;if(!o.interactive)break;o.selectable&&r.automaticManipulatorSelection&&(o.selected=!o.selected,r.onManipulatorSelectionChanged&&r.onManipulatorSelectionChanged());const c=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:c,stopPropagation:n}),gt(o,n);break}case"click":{const s=K(e),a=this._intersect(s,e.pointerType,t.forEachTool),o=a==null?void 0:a.manipulator;if(o==null||!o.interactive)break;const r=e.native.shiftKey;o.events.emit(e.type,{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:r}),n();break}case"double-click":{const s=K(e),a=this._intersect(s,e.pointerType,t.forEachTool),o=a!=null?a.manipulator:null;if(o==null||!o.interactive)break;const r=e.native.shiftKey;o.events.emit("double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:r,stopPropagation:n}),gt(o,n);break}case"immediate-double-click":{const s=K(e),a=this._intersect(s,e.pointerType,t.forEachTool),o=a!=null?a.manipulator:null;if(o==null||!o.interactive)break;const r=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:r,stopPropagation:n}),gt(o,n);break}}this._onFocusChange(t.forEachTool)}_releaseManipulatorBeforeDragging(e,t,n){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:K(t)}),this._grabbedManipulators.forEach(({manipulator:s},a)=>{s===e&&this._grabbedManipulators.delete(a)}),this._afterManipulatorRelease(n.setActiveTool)}_handlePointerEnd(e,t){var s;const n=(s=this._grabbedManipulators.get(e.pointerId))==null?void 0:s.manipulator;n!=null&&n.grabbing&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:K(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(t.setActiveTool))}_cursorFromMap(e){let t=null;return Rt(e,({manipulator:n})=>!(n==null||!n.interactive)&&(n.grabbing&&n.grabCursor?(t=n.grabCursor,!0):!!n.cursor&&(t=n.cursor,!0))),t}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const t=new Set,n=new Set;this._grabbedManipulators.forEach(({tool:s})=>{t.add(s)}),this._hoveredManipulators.forEach(({tool:s})=>{n.add(s)}),e(s=>{s.hasGrabbedManipulators=t.has(s),s.hasHoveredManipulators=n.has(s);const a=this._grabbedManipulators.values(),o=Ln(a,({tool:r})=>r===s);s.firstGrabbedManipulator=o!=null?o.manipulator:null})}clearPointers(e,{forEachTool:t,setActiveTool:n},s=!0,a){const o=(r,c)=>r===e&&(a==null||a===c);this._grabbedManipulators.forEach(({tool:r,manipulator:c,pointerType:p},d)=>{o(r,c)&&(this._grabbedManipulators.delete(d),c.grabbing=!1,c.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:p}))}),this._draggedManipulators.forEach(({tool:r,manipulator:c},p)=>{o(r,c)&&(this._draggedManipulators.delete(p),c.dragging=!1,c.events.emit("drag",{action:"cancel"}))}),s&&this._hoveredManipulators.forEach(({tool:r,manipulator:c},p)=>{o(r,c)&&(this._hoveredManipulators.delete(p),c.hovering=!1)}),this._afterManipulatorRelease(n),this._onFocusChange(t)}_intersect(e,t,n){let s=null;return n(a=>{if(a.manipulators==null||!$t(a))return!1;const o=a.manipulators.intersect(e,t);return o!=null&&(s={tool:a,manipulator:o},!0)}),s}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((t,n)=>{this._updateHoveredStateForPointerAtScreenPosition(ce(t.x,t.y),n,t.pointerType,e)})}handleHoverEvent(e,t){e.type!=="pointer-up"&&e.type!=="immediate-click"&&e.type!=="pointer-move"||!xi(e.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(K(e),e.pointerId,e.pointerType,t)}_updateHoveredStateForPointerAtScreenPosition(e,t,n,s){var r;let a=this._intersect(e,n,s);const o=(r=this._hoveredManipulators.get(t))==null?void 0:r.manipulator;a==null||a.manipulator.interactive||(a=null),a!=null&&o===a.manipulator||(o!=null&&(o.hovering=!1),a!=null?(a.manipulator.hovering=!0,this._hoveredManipulators.set(t,a)):this._hoveredManipulators.delete(t),this._onFocusChange(s))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}};function xi(i){return i==="mouse"}function Ti(i){return i.pointerType!=="mouse"||i.button===0}function Xs(i){return!!i.native.shiftKey}function gt(i,e){i!=null&&i.consumesClicks&&e()}const Ci="attached",mt="tools",Pi=1e3;let j=class extends ${constructor(e){super(e),this._updatingHandles=new at,this._clock=st,this._manipulatorState=new Ys,this.tools=new E,this.cursor=null,this._interacting=!1,this._interactingTimeout=Pi,this._interactingTimeoutHandle=null,this._forEachTool=t=>{for(const n of this.tools.items)if(t(n))return}}initialize(){this.addHandles([this.view.on(en,e=>{this._handleInputEvent(e)},Gt.TOOL),...Zs(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void L.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const t=this.activeTool;this._set("activeTool",e),t!=null&&t.deactivate(),e!=null&&e.activate(),this._removeIncompleteTools(e);for(const n of this.tools){this._updateToolEditableFlag(n);const s=$t(n);this.activeTool!=null&&s||this._manipulatorState.clearPointers(n,this._manipulatorStateEventArgs,!s)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=ae(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){var e;this.view.type==="3d"?this.addHandles([w(()=>{const{state:t}=this.view;return"camera"in t&&t.camera},()=>this._forEachManipulator(t=>t.onViewChange())),(e=this.view.elevationProvider)==null?void 0:e.on("elevation-change",t=>this._forEachManipulator(n=>n.onElevationChange(t)))],Ci):this.addHandles(w(()=>this.view.extent,()=>this._forEachManipulator(t=>t.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(Ci),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool(t=>{t.manipulators&&t.manipulators.forEach(({manipulator:n})=>e(n,t))})}_handleInputEvent(e){let t=!1;const n={...e,stopPropagation:()=>{t=!0,e.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(n):this._forEachTool(s=>{!t&&s.visible&&s.handleInputEvent(n)}),!t&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(n,this._manipulatorStateEventArgs),t||this.activeTool==null||this.activeTool.handleInputEventAfter(n),this._manipulatorState.handleHoverEvent(n,this._forEachTool),this._updateCursor(),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(mt),this._forEachTool(e=>{if(e instanceof $){const t=w(()=>[e.cursor,e.visible,e.editable],()=>{$t(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.addHandles(t,mt)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",t=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,t.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],mt)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){var t;(t=e.setEditableFlag)==null||t.call(e,Tt.MANAGER,this.activeTool==null||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;e==null&&this._forEachTool(t=>!(t.cursor==null||!t.visible)&&(e=t.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(t=>(e==null||t!==e)&&!t.created&&t.removeIncompleteOnCancel).forEach(t=>{this.tools.remove(t)})}get test(){const e=this;return{setClock:t=>this._clock=t,set interactingTimeoutEnabled(t){e._interactingTimeout=t?Pi:0},get interactingTimeoutEnabled(){return e._interactingTimeout!==0}}}};l([h({constructOnly:!0,nonNullable:!0})],j.prototype,"view",void 0),l([h({value:null})],j.prototype,"activeTool",null),l([h({readOnly:!0,type:E})],j.prototype,"tools",void 0),l([h({readOnly:!0})],j.prototype,"cursor",void 0),l([h({readOnly:!0})],j.prototype,"updating",null),l([h()],j.prototype,"_interacting",void 0),l([h({readOnly:!0})],j.prototype,"interacting",null),j=l([b("esri.views.ToolViewManager")],j);let fe=class extends ${constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":Qs.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return Js[this.deviceType]}};l([h({nonNullable:!0,readOnly:!0})],fe.prototype,"nativeIndex",void 0),l([h({type:String,readOnly:!0})],fe.prototype,"deviceType",null),l([h({type:Number,readOnly:!0})],fe.prototype,"axisThreshold",null),fe=l([b("esri.views.input.gamepad.GamepadInputDevice")],fe);const Qs=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),Js={standard:.15,spacemouse:.025,unknown:0},Ut=fe;let Pe=class extends ${constructor(...e){super(...e),this.devices=new E,this.enabledFocusMode="document"}};l([h({type:E.ofType(Ut),readOnly:!0})],Pe.prototype,"devices",void 0),l([h({type:["document","view","none"]})],Pe.prototype,"enabledFocusMode",void 0),Pe=l([b("esri.views.input.gamepad.GamepadSettings")],Pe);const ea=Pe;let Ge=class extends ${constructor(){super(...arguments),this.gamepad=new ea}};l([h({readOnly:!0})],Ge.prototype,"gamepad",void 0),Ge=l([b("esri.views.input.Input")],Ge);const ta=Ge;let ie=class extends ${constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};l([h({type:Boolean,nonNullable:!0})],ie.prototype,"enabled",void 0),l([h({type:Ut})],ie.prototype,"device",void 0),l([h({type:["pan","zoom"],nonNullable:!0})],ie.prototype,"mode",void 0),l([h({type:["forward-down","forward-up"],nonNullable:!0})],ie.prototype,"tiltDirection",void 0),l([h({type:Number,nonNullable:!0})],ie.prototype,"velocityFactor",void 0),ie=l([b("esri.views.navigation.gamepad.GamepadSettings")],ie);const sn=ie;let re=class extends ${constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new sn,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};l([h({type:Boolean})],re.prototype,"browserTouchPanEnabled",void 0),l([h({type:sn,nonNullable:!0})],re.prototype,"gamepad",void 0),l([h({type:Boolean})],re.prototype,"momentumEnabled",void 0),l([h({type:Boolean})],re.prototype,"mouseWheelZoomEnabled",void 0),re=l([b("esri.views.navigation.Navigation")],re);const an=re;let Et,yt=null;async function ia(i){yt||(yt=Xe(()=>import("./geometryServiceUtils-B-h5lvUN.js"),__vite__mapDeps([54,1,2,55,28,32])).then(e=>Et=e)),await yt,ve(i)}async function on(i,e,t,n){if(!i)return null;const s=i.spatialReference;return At()||Ot(s,e)?Ht(i,e):Et?Et.projectGeometry(i,e,t,n):(await Promise.race([ia(n),Nt(n)]),on(i,e,t,n))}let _=class extends ${constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=xt(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference!=null?this.userSpatialReference:this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){var n,s,a,o;const e=(n=this.map)==null?void 0:n.call(this),t=[];return this.priorityCollection!=null&&t.push(this.priorityCollection),t.push({parent:e==null?void 0:e.basemap,layers:(s=e==null?void 0:e.basemap)==null?void 0:s.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(a=e==null?void 0:e.ground)==null?void 0:a.layers},{parent:e==null?void 0:e.basemap,layers:(o=e==null?void 0:e.basemap)==null?void 0:o.referenceLayers}),t}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;let n=null;for(const a of e){const o=this._getSupportedSpatialReferences(a);if(o.length>0){const r=this._narrowDownSpatialReferenceCandidates(n,o);r!=null&&(n=r)}if(n!=null&&n.length===1)break}if(t&&(n==null||n.length!==1))return{updating:!0};const s=this._pickSpatialReferenceCandidate(n);return{spatialReference:s!=null?s.spatialReference:null,viewingMode:s!=null?s.viewingMode:null,updating:!1}}get _tileInfoTask(){var n,s,a,o,r,c,p;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:e,updating:t}=this._collectLayers([{parent:(s=(n=this.map)==null?void 0:n.call(this))==null?void 0:s.basemap,layers:(r=(o=(a=this.map)==null?void 0:a.call(this))==null?void 0:o.basemap)==null?void 0:r.baseLayers},{layers:(p=(c=this.map)==null?void 0:c.call(this))==null?void 0:p.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){const d=e[0].tileInfo;return{tileInfo:d&&d.spatialReference.equals(this.spatialReference)?d:null,updating:!1}}return{updating:t}}get _heightModelInfoTask(){var n,s,a;if(!this.required.heightModelInfo||this.suspended&&((n=this._get("_heightModelInfoTask"))!=null&&n.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;for(const o of e)if(ps(o)){const r=us(o);if(r)return{heightModelInfo:r,vcsWkid:(s=o.spatialReference)==null?void 0:s.vcsWkid,latestVcsWkid:(a=o.spatialReference)==null?void 0:a.latestVcsWkid,updating:!1}}return{updating:t}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=this._allLayers,t=e.updating,n=[];for(const s of e.layers){const a="fullExtents"in s&&s.fullExtents||(s.fullExtent!=null?[s.fullExtent]:[]),o=this.requiresExtentInSpatialReference?null:a[0],r=a.find(c=>c.spatialReference.equals(this.spatialReference))??o;if(r)return{candidates:[{extent:r,layer:s}],updating:!1};if(this._getSupportedSpatialReferences(s).length>0)for(const c of a)n.push({extent:c,layer:s})}return{candidates:n,updating:t}}get _extentTask(){const{candidates:e,updating:t}=this._extentCandidatesTask;if(t)return{updating:t};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const n=this._pickExtentCandidate(e),s=this.spatialReference;return n.extent.equals(this._projectExtentTask.input)&&s.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=xt(this._projectExtentTask.task)),this._projectExtentTask={input:n.extent.clone(),output:null,spatialReference:s.clone(),task:Vt(async a=>{try{const o=await on(n.extent,s,"portalItem"in n.layer?n.layer.portalItem:void 0,a);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(An(a))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,t){if(e==null)return t;const n=[],s=(a,o)=>a!=null?o!=null?a===o&&a:a:o;for(const a of e)for(const o of t){if(!a.spatialReference.equals(o.spatialReference))continue;const r=s(a.viewingMode,o.viewingMode);if(r!==!1){n.push({spatialReference:a.spatialReference,viewingMode:r});break}}return n.length>0?n:null}_pickSpatialReferenceCandidate(e){const t=this.defaultSpatialReference;return e==null||e.length<1?t!=null?{spatialReference:t,viewingMode:null}:null:(t!=null&&e.length>1&&e.some(({spatialReference:n})=>n.equals(t))&&(e=e.filter(({spatialReference:n})=>n.equals(t))),e.length>1&&e.some(({viewingMode:n})=>n!==ui.Local)&&(e=e.filter(({viewingMode:n})=>n!==ui.Local)),e[0])}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(t.length===0)return[];const n=[];for(const s of t){const a=this.getSpatialReferenceSupport({spatialReference:s,layer:e});if(a!=null){const o=a.constraints!=null?a.constraints:[{spatialReference:s,viewingMode:null}];for(const{spatialReference:r,viewingMode:c}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!r.equals(this.userSpatialReference)||n.push({spatialReference:r,viewingMode:c})}}return n}_pickExtentCandidate(e){const t=this.spatialReference;return e.find(({extent:n})=>t.equals(n.spatialReference))||e[0]}_collectLayers(e){var n;if(this._loadMaybe((n=this.map)==null?void 0:n.call(this))!=="loaded")return{layers:[],updating:!0};const t=new na;for(const s of e)if(this._collectCollection(s,t),t.preloading===this.sourcePreloadCount)break;return{layers:t.layers,updating:t.updating}}_collectCollection(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}for(const n of e.layers){switch(this._loadMaybe(n)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":t.updating||t.layers.push(n),"layers"in n&&this._collectCollection({layers:n.layers},t)}if(t.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(t=>{Hi(t)||console.log(t)}),"loading"):e.loadStatus:"loaded"}};l([h()],_.prototype,"required",void 0),l([h({constructOnly:!0})],_.prototype,"map",void 0),l([h({constructOnly:!0})],_.prototype,"getSpatialReferenceSupport",void 0),l([h()],_.prototype,"defaultSpatialReference",void 0),l([h()],_.prototype,"userSpatialReference",void 0),l([h()],_.prototype,"sourcePreloadCount",void 0),l([h()],_.prototype,"priorityCollection",void 0),l([h()],_.prototype,"requiresExtentInSpatialReference",void 0),l([h()],_.prototype,"suspended",void 0),l([h({readOnly:!0})],_.prototype,"ready",null),l([h({readOnly:!0})],_.prototype,"heightModelInfoReady",null),l([h({readOnly:!0})],_.prototype,"spatialReference",null),l([h({readOnly:!0})],_.prototype,"extent",null),l([h({readOnly:!0})],_.prototype,"heightModelInfo",null),l([h({readOnly:!0})],_.prototype,"vcsWkid",null),l([h({readOnly:!0})],_.prototype,"latestVcsWkid",null),l([h({readOnly:!0})],_.prototype,"viewingMode",null),l([h({readOnly:!0})],_.prototype,"tileInfo",null),l([h({readOnly:!0})],_.prototype,"mapCollections",null),l([h({readOnly:!0})],_.prototype,"_allLayers",null),l([h({readOnly:!0})],_.prototype,"_spatialReferenceTask",null),l([h({readOnly:!0})],_.prototype,"_tileInfoTask",null),l([h({readOnly:!0})],_.prototype,"_heightModelInfoTask",null),l([h({readOnly:!0})],_.prototype,"_extentCandidatesTask",null),l([h()],_.prototype,"_extentTask",null),l([h()],_.prototype,"_projectExtentTask",void 0),_=l([b("esri.views.support.DefaultsFromMap")],_);let na=class{constructor(){this.layers=new Array,this.preloading=-1,this.updating=!1}};var $e;let m=$e=class extends Lt.EventedMixin(On($)){constructor(i){super(i),this._userSpatialReference=null,this._cursor=null,this.handles=new Hn,this.updatingHandles=new at,this.allLayerViews=new Nn({getCollections:()=>{var e,t,n;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(t=this.groundView)==null?void 0:t.layerViews,this.layerViews,(n=this.basemapView)==null?void 0:n.referenceLayerViews]},getChildrenFunction:sa}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new Bi,this.analyses=new tt,this.typeSpecificPreconditionsReady=!0,this.layerViews=new E,this.magnifier=new Ji,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new ta,this.navigation=new an,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new Bs(this),this.persistableViewModels=new E,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this.theme=null,this.handles.add(w(()=>this.preconditionsReady,e=>{var n,s;const t=this.ready;if(e?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,$e.views.add(this)):(this._lockedSpatialReference=null,$e.views.remove(this)),this.notifyChange("spatialReference"),!e&&t)(n=this.toolViewManager)==null||n.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),(s=this.layerViewManager)==null||s.clear(),this._teardown();else if(e&&!t){try{this._startup()}catch(a){return void queueMicrotask(()=>{console.error("View._startup failed",a),this.fatalError=new O("startup-error",null,a)})}this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach()}},ai))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then(()=>(this._isValid=!0,It(()=>this.ready)))),this.basemapView=new te({view:this}),this.layerViewManager=new zs({view:this,layerViewImporter:{importLayerView:i=>this.importLayerView(i),hasLayerViewModule:i=>this.hasLayerViewModule(i)},supportsGround:this.supportsGround}),this.toolViewManager=new j({view:this}),this._setupSpatialReferenceLogger(),this.selectionManager=new Us({view:this}),this.addHandles([w(()=>this.initialExtentRequired,i=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:i},Mt),w(()=>this.ready,i=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=i,this.defaultsFromMap.userSpatialReference=i?this.spatialReference:this._userSpatialReference)},ai),w(()=>this._userSpatialReference,i=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=i)},Mt)])}_setupSpatialReferenceLogger(){let i=null;this.addHandles([w(()=>{var e;return(e=this.defaultsFromMap)==null?void 0:e.ready},e=>{var n;const t=((n=this.map)==null?void 0:n.allLayers.length)>0;if(e&&!this.spatialReference&&t){if(i!=null)return;const s=Fi(()=>i=xt(i));i=Vt(async a=>{try{await Fn(this.spatialReferenceWarningDelay,null,a)}catch{return}finally{i=null}L.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.addHandles(s,"spatial-reference-logger-task")}else this.removeHandles("spatial-reference-logger-task")},{sync:!0})])}destroy(){var i,e;this.destroyed||($e.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=q(this.graphics),this.analyses=q(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),q(this.analysisViewManager),this.toolViewManager=q(this.toolViewManager),this.layerViewManager=q(this.layerViewManager),this.selectionManager=q(this.selectionManager),this.basemapView=q(this.basemapView),(i=this.groundView)==null||i.destroy(),(e=this.layerViews)==null||e.forEach(t=>t.destroy()),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=q(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return L.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var i;return(i=this.toolViewManager)==null?void 0:i.activeTool}set activeTool(i){this.toolViewManager&&(this.toolViewManager.activeTool=i)}get animation(){return this._get("animation")}set animation(i){this._set("animation",i)}get center(){return null}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new _({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:i=>this.getSpatialReferenceSupport(i),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(i){this._set("extent",i)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var i;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||oi.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!((i=this.defaultsFromMap)!=null&&i.ready)||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(i){i!==this._get("map")&&(i!=null&&i.destroyed&&(L.getLogger(this).warn("#map","The provided map is already destroyed",{map:i}),i=null),oi.isLoadable(i)&&i.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",i))}get spatialReference(){var e,t;const i=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(i&&((t=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&t.heightModelInfo)){const n=i.clone();return n.vcsWkid=this.defaultsFromMap.vcsWkid,n.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,n}return i}set spatialReference(i){const e=!Ft(i,this._get("spatialReference"));this._set("_userSpatialReference",i),e&&(this._set("spatialReference",i),this._spatialReferenceChanged(i))}_spatialReferenceChanged(i){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??ri}set timeZone(i){const e=new Set(["etc/utc","etc/gmt","gmt"]),t=new Set(Intl.supportedValuesOf("timeZone").map(n=>n.toLowerCase()));this._userTimeZone=i,i===ri||i===zn||e.has(i.toLowerCase())||t.has(i.toLowerCase())||L.getLogger(this).warn("#timeZone",`the parsed value '${i}' may not be a valid IANA time zone`)}get tools(){var i;return(i=this.toolViewManager)==null?void 0:i.tools}get initialExtent(){var i;return(i=this.defaultsFromMap)==null?void 0:i.extent}get cursor(){var i;return((i=this.toolViewManager)==null?void 0:i.cursor)??this._cursor??"default"}set cursor(i){this._cursor=i,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new Pt}whenLayerView(i){var e;return((e=this.layerViewManager)==null?void 0:e.whenLayerView(i))??Promise.reject()}getDefaultSpatialReference(){var i;return(i=this.defaultsFromMap)==null?void 0:i.spatialReference}getDefaultHeightModelInfo(){var i;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((i=this.defaultsFromMap)==null?void 0:i.heightModelInfo)??null}getDefaultTimeZone(){return null}importLayerView(i){throw new O("importLayerView() not implemented")}hasLayerViewModule(i){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(i){return this.getSpatialReferenceSupport({spatialReference:i})!=null}when(i,e){return this.isResolved()&&!this.ready&&L.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(i,e)}forceReadyCycle(){this.ready&&(zi(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(i){this.toolViewManager.tools.add(i),this.activeTool=i}tryFatalErrorRecovery(){this.fatalError=null}};m.views=new E,l([h()],m.prototype,"_userSpatialReference",void 0),l([h()],m.prototype,"activeTool",null),l([h({readOnly:!0})],m.prototype,"allLayerViews",void 0),l([h()],m.prototype,"groundView",void 0),l([h()],m.prototype,"animation",null),l([h()],m.prototype,"basemapView",void 0),l([h()],m.prototype,"center",null),l([h({readOnly:!0})],m.prototype,"_defaultsFromMapSettings",null),l([h()],m.prototype,"defaultsFromMap",null),l([h()],m.prototype,"fatalError",void 0),l([h({type:Ie})],m.prototype,"extent",null),l([h(pi(Bi,"graphics"))],m.prototype,"graphics",void 0),l([h(pi(tt,"analyses"))],m.prototype,"analyses",void 0),l([h({readOnly:!0,type:jn})],m.prototype,"heightModelInfo",null),l([h({readOnly:!0})],m.prototype,"interacting",null),l([h({readOnly:!0})],m.prototype,"navigating",null),l([h({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],m.prototype,"preconditionsReady",null),l([h({readOnly:!0})],m.prototype,"typeSpecificPreconditionsReady",void 0),l([h({type:E,readOnly:!0})],m.prototype,"layerViews",void 0),l([h()],m.prototype,"resolution",null),l([h({type:Ji})],m.prototype,"magnifier",void 0),l([h({value:null,type:Gn})],m.prototype,"map",null),l([h()],m.prototype,"padding",void 0),l([h({readOnly:!0})],m.prototype,"ready",void 0),l([h({type:zt})],m.prototype,"spatialReference",null),l([h()],m.prototype,"spatialReferenceWarningDelay",void 0),l([h()],m.prototype,"stationary",null),l([h({readOnly:!0})],m.prototype,"supportsGround",void 0),l([h({type:qn})],m.prototype,"timeExtent",void 0),l([h({type:String,nonNullable:!0})],m.prototype,"timeZone",null),l([h()],m.prototype,"tools",null),l([h()],m.prototype,"toolViewManager",void 0),l([h({readOnly:!0})],m.prototype,"type",void 0),l([h({type:Number})],m.prototype,"scale",void 0),l([h({readOnly:!0})],m.prototype,"updating",void 0),l([h({readOnly:!0})],m.prototype,"initialExtentRequired",void 0),l([h({readOnly:!0})],m.prototype,"initialExtent",null),l([h()],m.prototype,"cursor",null),l([h({readOnly:!0})],m.prototype,"input",void 0),l([h({type:an,nonNullable:!0})],m.prototype,"navigation",void 0),l([h()],m.prototype,"layerViewManager",void 0),l([h()],m.prototype,"analysisViewManager",void 0),l([h()],m.prototype,"selectionManager",void 0),l([h()],m.prototype,"width",void 0),l([h()],m.prototype,"height",void 0),l([h({readOnly:!0})],m.prototype,"resizing",void 0),l([h({value:null,readOnly:!0})],m.prototype,"size",null),l([h({readOnly:!0})],m.prototype,"suspended",void 0),l([h({readOnly:!0})],m.prototype,"viewEvents",void 0),l([h({readOnly:!0})],m.prototype,"persistableViewModels",void 0),l([h()],m.prototype,"_isValid",void 0),l([h()],m.prototype,"_readyCycleForced",void 0),l([h()],m.prototype,"_lockedSpatialReference",void 0),l([h()],m.prototype,"_userTimeZone",void 0),l([h()],m.prototype,"_lockedTimeZone",void 0),l([h({type:Pt})],m.prototype,"theme",void 0),l([h({readOnly:!0,type:Pt})],m.prototype,"effectiveTheme",null),m=$e=l([b("esri.views.View")],m);const tr=m;function sa(i){return i.layerViews}let ne=class extends Un{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=it(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._resolver)==null||e.reject(new O("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._resolver)==null||e.resolve())}update(e,t){t||(t=Wn(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}};l([h({readOnly:!0})],ne.prototype,"done",null),l([h({readOnly:!0,type:String})],ne.prototype,"state",void 0),l([h()],ne.prototype,"target",void 0),ne=l([b("esri.views.ViewAnimation")],ne),function(i){i.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(ne||(ne={}));const nr=ne,rn=96,ln=39.37,aa=180/Math.PI;function hn(i){return i.wkid?i:i.spatialReference||zt.WGS84}function Wt(i,e){return e.type?P(i,e.x,e.y):Ct(i,e)}function cn(i){return Bn(i)}function qe(i,e,t=0){let n=i.width,s=i.height;if(t!==0){const r=Kn(t),c=Math.abs(Math.cos(r)),p=Math.abs(Math.sin(r));n=i.width*c+i.height*p,s=i.width*p+i.height*c}const a=Math.max(1,e[0]),o=Math.max(1,e[1]);return Math.max(n/a,s/o)*ua(i.spatialReference)}async function Ee(i,e,t,n){var r,c;let s,a;if(!i||Array.isArray(i)&&!i.length)return null;if(E.isCollection(i)&&(i=i.toArray()),Array.isArray(i)&&i.length&&typeof i[0]=="object"){const p=i.every(u=>"attributes"in u),d=i.some(u=>!u.geometry);let g=i;if(p&&d&&e&&e.allLayerViews){const u=new Map;for(const M of i){const k=M.layer,D=u.get(k)||[],f=M.attributes[k.objectIdField];f!=null&&D.push(f),u.set(k,D)}const y=[];u.forEach((M,k)=>{const D=e.allLayerViews.find(f=>f.layer.id===k.id);if(D&&"queryFeatures"in D){const f=k.createQuery();f.objectIds=M,f.returnGeometry=!0,y.push(D.queryFeatures(f))}});const v=await Promise.all(y),V=[];for(const M of v)if(M&&M.features&&M.features.length)for(const k of M.features)k.geometry!=null&&V.push(k.geometry);g=V}for(const u of g)n=await Ee(u,e,t,n);return n}if(Array.isArray(i)&&i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number")s=new jt(i);else if(i instanceof Zn)s=i;else if("geometry"in i){if(i.geometry)s=i.geometry;else if(i.layer){const p=i.layer,d=e.allLayerViews.find(g=>g.layer.id===p.id);if(d&&"queryFeatures"in d){const g=p.createQuery();g.objectIds=[i.attributes[p.objectIdField]],g.returnGeometry=!0;const u=await d.queryFeatures(g);s=(c=(r=u==null?void 0:u.features)==null?void 0:r[0])==null?void 0:c.geometry}}}if(s==null)return null;switch(s.type){case"point":a=new Ie({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":a=Ts(s);break;default:a=s.extent}if(!a)return null;At()||Ot(a.spatialReference,t)||await Nt();const o=Ht(a,t);return o?n=n?n.union(o):o:null}function oa(i){var e;if(i&&(!Array.isArray(i)||typeof i[0]!="number")&&(typeof i=="object"||Array.isArray(i)&&typeof i[0]=="object")){if("layer"in i&&((e=i.layer)==null?void 0:e.minScale)!=null&&i.layer.maxScale!=null){const t=i.layer;return{min:t.minScale,max:t.maxScale}}if(Array.isArray(i)&&i.length&&i.every(t=>"layer"in t)){let t=0,n=0;for(const s of i){const a=s.layer;a!=null&&a.minScale&&a.maxScale&&(t=a.minScale<t?a.minScale:t,n=a.maxScale>n?a.maxScale:n)}return t&&n?{min:t,max:n}:null}}}function ft(i,e){return Ft(hn(i),e)?i:Ht(i,e)}async function sr(i,e){var M;if(!i||!e)return new De({targetGeometry:new jt,scale:0,rotation:0});let t=e.spatialReference;const{constraints:n,padding:s,viewpoint:a,size:o}=e,r=[s?o[0]-s.left-s.right:o[0],s?o[1]-s.top-s.bottom:o[1]];let c=null;i instanceof De?c=i:i.viewpoint?c=i.viewpoint:i.target&&i.target.declaredClass==="esri.Viewpoint"&&(c=i.target);let p=null;c!=null&&c.targetGeometry?p=c.targetGeometry:i instanceof Ie?p=i:(i||i&&("center"in i||"extent"in i||"target"in i))&&(p=await Ee(i.center,e,t)||await Ee(i.extent,e,t)||await Ee(i.target,e,t)||await Ee(i,e,t)),!p&&(a!=null&&a.targetGeometry)?p=a.targetGeometry:!p&&e.extent&&(p=e.extent),t||(t=hn(e.spatialReference||e.extent||p)),At()||Ft(p.spatialReference,t)||Ot(p.spatialReference,t)||await Nt();const d=ft(p,t),g="center"in d?d.center:d;e.pickClosestTarget!==!1&&g.type==="point"&&((M=a.targetGeometry)==null?void 0:M.type)==="point"&&(g.x=Qi(g.x,a.targetGeometry.x,g.spatialReference));let u=0;c?u=c.rotation:i.hasOwnProperty("rotation")?u=i.rotation:a&&(u=a.rotation);let y=0;if((c==null?void 0:c.targetGeometry)!=null&&c.targetGeometry.type==="point")y=c.scale;else if("scale"in i&&i.scale)y=i.scale;else if("zoom"in i&&i.zoom!==-1&&n&&n.effectiveLODs)y=n.zoomToScale(i.zoom);else if(Array.isArray(p)||p.type==="point"||p.type==="extent"&&p.width===0&&p.height===0){const k=ft(e.extent,t);y=k!=null?qe(k,r,u):e.extent?qe(e.extent,r,u):a.scale}else y=qe(ft(p.extent,t),r,u);const v=oa(i.target??i);v&&(v.min&&v.min<y?y=v.min:v.max&&v.max>y&&(y=v.max));let V=new De({targetGeometry:g,scale:y,rotation:u});return n&&(V=n.fit(V),n.constrainByGeometry(V),n.rotationEnabled||(V.rotation=a.rotation)),V}function Q(i,e){const t=i.targetGeometry,n=e.targetGeometry;return t.x=n.x,t.y=n.y,t.spatialReference=n.spatialReference,i.scale=e.scale,i.rotation=e.rotation,i}function ra(i,e,t){return t?P(i,.5*(e[0]-t.right+t.left),.5*(e[1]-t.bottom+t.top)):ot(i,e,.5)}const la=function(){const i=x();return function(e,t,n){const s=t.targetGeometry;Wt(i,s);const a=.5*Me(t);return e.xmin=i[0]-a*n[0],e.ymin=i[1]-a*n[1],e.xmax=i[0]+a*n[0],e.ymax=i[1]+a*n[1],e.spatialReference=s.spatialReference,e}}();function ar(i,e,t,n,s){var a;return fa(i,e,t.center),i.scale=qe(t,n),(a=s==null?void 0:s.constraints)==null||a.constrain(i),i}function ha(i,e,t,n){return Zt(i,e,t,n),Yi(i,i)}const pn=function(){const i=x();return function(e,t,n){return Xi(e,da(e,t),ra(i,t,n))}}(),ca=function(){const i=he(),e=x();return function(t,n,s,a){const o=Me(n),r=Bt(n);return P(e,o,o),gs(i,e),qt(i,i,r),et(i,i,pn(e,s,a)),et(i,i,[0,a.top-a.bottom]),P(t,i[4],i[5])}}();function Me(i){return i.scale*pa(i.targetGeometry)}function pa(i){return i!=null&&ji(i.spatialReference)?1/(cn(i.spatialReference)*ln*rn):1}function Bt(i){return Gi(i.rotation)||0}function ua(i){return ji(i)?cn(i)*ln*rn:1}function da(i,e){return ot(i,e,.5)}const Kt=function(){const i=x(),e=x(),t=x();return function(n,s,a,o,r,c){return ws(i,s),ot(e,a,.5*c),P(t,1/o*c,-1/o*c),Ki(n,e),r&&qt(n,n,r),Zi(n,n,t),et(n,n,i),n}}(),Zt=function(){const i=x();return function(e,t,n,s){const a=Me(t),o=Bt(t);return Wt(i,t.targetGeometry),Kt(e,i,n,a,o,s)}}(),ga=function(){const i=x();return function(e,t,n,s){const a=Me(t);return Wt(i,t.targetGeometry),Kt(e,i,n,a,0,s)}}();function ma(i){const e=Yn(i);return e?e.valid[1]-e.valid[0]:0}function ya(i,e){return Math.round(ma(i)/e)}const or=function(){const i=x(),e=x(),t=[0,0,0];return function(n,s,a){gi(i,n,s),mi(i,i),gi(e,n,a),mi(e,e),bs(t,i,e);let o=Math.acos(ks(i,e)/(yi(i)*yi(e)))*aa;return t[2]<0&&(o=-o),isNaN(o)&&(o=0),o}}(),rr=function(){const i=x();return function(e,t,n,s){const a=e.targetGeometry;return Q(e,t),ca(i,t,n,s),a.x+=i[0],a.y+=i[1],e}}(),fa=function(i,e,t){Q(i,e);const n=i.targetGeometry;return n.x=t.x,n.y=t.y,n.spatialReference=t.spatialReference,i},lr=function(){const i=x();return function(e,t,n,s,a){a||(a="center"),Xi(i,n,s),ot(i,i,.5);const o=i[0],r=i[1];switch(a){case"center":P(i,0,0);break;case"left":P(i,-o,0);break;case"top":P(i,0,r);break;case"right":P(i,o,0);break;case"bottom":P(i,0,-r);break;case"top-left":P(i,-o,r);break;case"bottom-left":P(i,-o,-r);break;case"top-right":P(i,o,r);break;case"bottom-right":P(i,o,-r)}return Yt(e,t,i),e}}();function hr(i,e,t){return Q(i,e),i.rotation+=t,i}function cr(i,e,t){return Q(i,e),i.rotation=t,i}const _a=function(){const i=x();return function(e,t,n,s,a){return Q(e,t),isNaN(n)||n===0||(un(i,s,t,a),e.scale=t.scale*n,dn(i,i,e,a),Yt(e,e,P(i,i[0]-s[0],s[1]-i[1]))),e}}();function pr(i,e,t){return Q(i,e),i.scale=t,i}const va=function(){const i=x();return function(e,t,n,s,a,o){return Q(e,t),isNaN(n)||n===0||(un(i,a,t,o),e.scale=t.scale*n,e.rotation+=s,dn(i,i,e,o),Yt(e,e,P(i,i[0]-a[0],a[1]-i[1]))),e}}(),ur=function(){const i=x(),e=x();return function(t,n,s,a,o,r,c){return pn(e,r,c),Ms(i,o,e),a?va(t,n,s,a,i,r):_a(t,n,s,i,r)}}(),un=function(){const i=he();return function(e,t,n,s){return U(e,t,ha(i,n,s,1))}}(),dn=function(){const i=he();return function(e,t,n,s){return U(e,t,Zt(i,n,s,1))}}(),Yt=function(){const i=x(),e=he();return function(t,n,s){Q(t,n);const a=Me(n),o=t.targetGeometry;return ds(e,Bt(n)),Zi(e,e,xs(a,a)),U(i,s,e),o.x+=i[0],o.y+=i[1],t}}();function Ue(){const i=new Float32Array(9);return i[0]=1,i[4]=1,i[8]=1,i}function wa(i){const e=new Float32Array(9);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e}function ba(i,e,t,n,s,a,o,r,c){const p=new Float32Array(9);return p[0]=i,p[1]=e,p[2]=t,p[3]=n,p[4]=s,p[5]=a,p[6]=o,p[7]=r,p[8]=c,p}function ka(i,e){return new Float32Array(i,e,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:wa,create:Ue,createView:ka,fromValues:ba},Symbol.toStringTag,{value:"Module"}));function Ma(i){return i instanceof Float32Array&&i.length>=2}function xa(i){return Array.isArray(i)&&i.length>=2}function Ne(i){return Ma(i)||xa(i)}var Dt;const T=[0,0];let se=Dt=class extends Xn{constructor(i){super(i),this._viewpoint2D={center:x(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Ie,this.id=0,this.inverseTransform=he(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=he(),this.transformNoRotation=he(),this.displayMat3=Ue(),this.displayViewMat3=Ue(),this.viewMat3=Ue(),this.viewMat2d=ms(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(i){this._set("pixelRatio",i),this._update()}set size(i){this._set("size",i),this._update()}set viewpoint(i){if(i){const e=this._viewpoint2D,t=i.targetGeometry;e.center[0]=t.x,e.center[1]=t.y,e.rotation=i.rotation,e.scale=i.scale,e.spatialReference=t.spatialReference}this._update()}copy(i){const e=this.size,t=this.viewpoint;return t&&e?(this.viewpoint=Q(t,i.viewpoint),this._set("size",Ct(e,i.size))):(this.viewpoint=i.viewpoint.clone(),this._set("size",[i.size[0],i.size[1]])),this._set("pixelRatio",i.pixelRatio),this}clone(){return new Dt({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(i,e,t){return Ne(e)?U(i,e,this.inverseTransform):(T[0]=e,T[1]=t,U(i,T,this.inverseTransform))}toScreen(i,e,t){return Ne(e)?U(i,e,this.transform):(T[0]=e,T[1]=t,U(i,T,this.transform))}toScreenNoRotation(i,e,t){return Ne(e)?U(i,e,this.transformNoRotation):(T[0]=e,T[1]=t,U(i,T,this.transformNoRotation))}toScreenClosest(i,e,t){Ne(e)?(T[0]=e[0],T[1]=e[1]):(T[0]=e,T[1]=t);const[n]=T,{center:s,extent:a,spatialReference:o,transform:r}=this;return(n<a.xmin||n>a.xmax)&&(T[0]=Qi(n,s[0],o)),U(i,T,r)}getScreenTransform(i,e){const{center:t}=this._viewpoint2D,n=this._get("pixelRatio")||1,s=this._get("size");return Kt(i,t,s,e,0,n),i}_update(){const{center:i,spatialReference:e,scale:t,rotation:n}=this._viewpoint2D,s=this._get("pixelRatio")||1,a=this._get("size"),o=new De({targetGeometry:new jt(i[0],i[1],e),scale:t,rotation:n});if(this._set("viewpoint",o),!a||!e||!t)return;this.resolution=Me(o),this.rotation=n,this.scale=t,this.spatialReference=e,Ct(this.center,i);const r=a[0]!==0?2/a[0]:0,c=a[1]!==0?-2/a[1]:0;ys(this.displayMat3,r,0,0,0,c,0,-1,1,1);const p=fs(this.viewMat3),d=fi(a[0]/2,a[1]/2),g=fi(-a[0]/2,-a[1]/2),u=Gi(n);di(p,p,d),_s(p,p,u),di(p,p,g),vs(this.displayViewMat3,this.displayMat3,p);const y=Ki(this.viewMat2d,d);return qt(y,y,u),et(y,y,g),la(this.extent,o,a),Zt(this.transform,o,a,s),Yi(this.inverseTransform,this.transform),ga(this.transformNoRotation,o,a,s),this.worldScreenWidth=ya(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};l([h({readOnly:!0})],se.prototype,"id",void 0),l([h({value:1,json:{write:!0}})],se.prototype,"pixelRatio",null),l([h({json:{write:!0}})],se.prototype,"size",null),l([h()],se.prototype,"spatialReference",void 0),l([h({type:De,json:{write:!0}})],se.prototype,"viewpoint",null),se=Dt=l([b("esri.views.2d.ViewState")],se);const dr=se;function gr(i,e){switch(e){case"primary":return i.pointerType==="touch"||i.button===0;case"secondary":return i.pointerType!=="touch"&&i.button===2;case"tertiary":return i.pointerType!=="touch"&&i.button===1}}function mr(i,e){if(i.pointerType==="touch")return!1;switch(e){case"primary":return i.button===0;case"secondary":return i.button===2;case"tertiary":return i.button===1}}let yr=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const t=e.data,n=t.pointers.size;switch(t.action){case"start":this._currentCount=n,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var t,n;this._startEvent=e,(n=(t=this._callbacks).condition)!=null&&n.call(t,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var t,n;(n=(t=this._callbacks).condition)!=null&&n.call(t,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var t,n;(n=(t=this._callbacks).condition)!=null&&n.call(t,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}};function F(i){let e=i*i;return i<0&&(e*=-1),e}function _r(i){return i.translation[0]=0,i.translation[1]=0,i.translation[2]=0,i.heading=0,i.tilt=0,i}function vr(i,e,t){const n=t,s=i.state,a=i.device,o=e.tiltDirection==="forward-down"?1:-1,r=1;return a.deviceType==="standard"?(n.translation[0]=F(s.axes[0]),n.translation[1]=F(s.axes[1]),n.translation[2]=F(s.buttons[7])-F(s.buttons[6]),n.heading=F(s.axes[2]),n.tilt=F(s.axes[3])):a.deviceType==="spacemouse"&&(n.translation[0]=1.2*F(s.axes[0]),n.translation[1]=1.2*F(s.axes[1]),n.translation[2]=2*-F(s.axes[2]),n.heading=1.2*F(s.axes[5]),n.tilt=1.2*F(s.axes[3])),n.tilt*=o,Qn(n.translation,n.translation,r),n}function wr(i,e){const t=e;return t.translation[0]=i[1]-i[0],t.translation[1]=i[3]-i[2],t.translation[2]=i[4]-i[5],t.heading=i[7]-i[6],t.tilt=i[8]-i[9],t.zoom=i[10]-i[11],t}function br(i){return i.translation[0]===0&&i.translation[1]===0&&i.translation[2]===0&&i.heading===0&&i.tilt===0&&i.zoom===0}function kr(i){const e=()=>i(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),{remove:()=>document.addEventListener("visibilitychange",e)}}function $i(i){const e=i.native;return e?{buttons:e.buttons.map(t=>t.pressed?t.value||1:0),axes:e.axes.map(t=>Pa(t,i.axisThreshold))}:{buttons:[],axes:[]}}function Ta(i,e){if(i.axes.length!==e.axes.length||i.buttons.length!==e.buttons.length)return!1;for(let t=0;t<i.axes.length;t++)if(i.axes[t]!==e.axes[t])return!1;for(let t=0;t<i.buttons.length;t++)if(i.buttons[t]!==e.buttons[t])return!1;return!0}function Ca(i){for(let e=0;e<i.axes.length;e++)if(i.axes[e]!==0)return!1;for(let e=0;e<i.buttons.length;e++)if(i.buttons[e]!==0)return!1;return!0}function Pa(i,e){const t=Math.abs(i);return t<e?0:Math.sign(i)*(t-e)/(1-e)}let $a=class{constructor(e,t){this._element=e,this._input=t,this._hasEventListeners=!1,this._onConnectGamepad=a=>{this._connectGamepad(a.gamepad)},this._onDisconnectGamepad=a=>{const o=a.gamepad,r=o.index,c=this._inputDevices[r];c&&(this._emitGamepadEvent(o,$i(c),!1),this._inputDevices.splice(r,1),this._latestUpdate.splice(r,1),this._input.gamepad.devices.remove(c),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const n="getGamepads"in window.navigator,s=window.isSecureContext;this.supported=n&&s,this.supported&&(this._forEachGamepad(a=>this._connectGamepad(a)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const t=new Ut(e);t.deviceType!=="unknown"&&(this._inputDevices[e.index]=t,this._input.gamepad.devices.add(t)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=kt({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),t=this._element.contains(document.activeElement),n=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!t;this._forEachGamepad(s=>{const a=this._inputDevices[s.index];if(!a)return;const o=this._latestUpdate[s.index],r=$i(a),c=n||Ca(r);o&&(o.timestamp===s.timestamp||!o.active&&c||Ta(o.state,r))||this._emitGamepadEvent(s,r,!c)})}_forEachGamepad(e){const t=window.navigator.getGamepads();for(let n=0;n<t.length;n++){const s=t[n];this._validate(s)&&e(s)}}_emitGamepadEvent(e,t,n){const s=this._latestUpdate[e.index],a=s&&s.active;if(!a&&!n)return;const o=!a&&n?"start":a&&n?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:n},this._callback&&this._callback({device:this._inputDevices[e.index],state:t,action:o})}_validate(e){if(!e||!e.connected)return!1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}};const Ei=be("edge"),Ea=be("chrome"),Da=be("ff"),Sa=be("safari"),Di="esri-view-surface",me={touchNone:`${Di}--touch-none`,touchPan:`${Di}--touch-pan`};let Ia=class gn{constructor(e,t){this._input=t,this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new $a(e,this._input),this._gamepadSource.onEvent=n=>this._callback("gamepad",n)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>{this._releasePointerCaptureSafe(e)}),this._gamepadSource=q(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const n=this._active[t];this._element.removeEventListener(_t[t],n),delete this._active[t]}e&&e.forEach(t=>{if(!this._active[t]&&_t[t]){const n=(this._eventHandlers[t]||this._handleDefault).bind(this,t);this._element.addEventListener(_t[t],n),this._active[t]=n}}),this._gamepadSource.hasEventListeners=(e==null?void 0:e.has("gamepad"))??!1}setPointerCapture(e,t){t?this._setPointerCatpureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?me.touchNone:me.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?me.touchPan:me.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(me.touchNone),this._element.classList.remove(me.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCatpureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,t){const n=ls(this._element,e);return gn.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),t.x=n.x,t.y=n.y,t}_handleKey(e,t){const{key:n}=t;n&&e==="key-up"&&this._keyDownState.delete(n);const s={native:t,key:n,repeat:!!n&&this._keyDownState.has(n)};n&&e==="key-down"&&this._keyDownState.add(s.key),this._callback(e,s)}_handlePointer(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,n)}_handlePointerPreventDefault(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,n)}_handleMouseWheel(e,t){let n=t.deltaY;switch(t.deltaMode){case 0:Ei&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900}Ei?n*=.7:Ea||Sa?n*=.6:Da&&(n*=1.375);const s=100,a=Math.abs(n);a>s&&(n=n/a*200/(1+Math.exp(-.02*(a-s))));const o=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:n});this._callback(e,o)}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t)}_handleDefault(e,t){const n={native:t};t.preventDefault(),this._callback(e,n)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};Ia.test={disableSubpixelCoordinates:!1};const _t={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let xr=class extends ke{constructor(){super(!0),this.registerIncoming("context-menu",e=>{e.data.native.preventDefault()})}};const A={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};function St(i,e){return Math.abs(e.x-i.x)+Math.abs(e.y-i.y)}function Va(i,e){const t=e.x-i.x,n=e.y-i.y;return Math.sqrt(t*t+n*n)}function Ra(i,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:ce()},i.length===0)return e;if(i.length===1)return e.center.x=i[0].x,e.center.y=i[0].y,e;if(i.length===2){const[f,S]=i,[N,B]=[S.x-f.x,S.y-f.y];return e.radius=Math.sqrt(N*N+B*B)/2,e.center.x=(f.x+S.x)/2,e.center.y=(f.y+S.y)/2,e}let t=0,n=0;for(let f=0;f<i.length;f++)t+=i[f].x,n+=i[f].y;t/=i.length,n/=i.length;const s=i.map(f=>f.x-t),a=i.map(f=>f.y-n);let o=0,r=0,c=0,p=0,d=0,g=0,u=0;for(let f=0;f<s.length;f++){const S=s[f],N=a[f],B=S*S,pe=N*N;o+=B,r+=pe,c+=S*N,p+=B*S,d+=pe*N,g+=S*pe,u+=N*B}const y=.5*(p+g),v=.5*(d+u),V=o*r-c*c,M=(y*r-v*c)/V,k=(o*v-c*y)/V,D=ce(M+t,k+n);return{radius:Math.sqrt(M*M+k*k+(o+r)/i.length),center:D}}function Se(i){const{native:e}=i,{pointerId:t,button:n,pointerType:s}=e;return s==="mouse"?`${t}:${n}`:`${s}`}let Cr=class extends ke{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,t,n,s){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:t.buttons,timestamp:s,pointers:La(this._activePointerMap),pointer:t,angle:n.angle,radius:n.radius,center:n.center}}_addPointer(e){const t=e.native.pointerId,n=Fe(this._activePointerMap).angle,s={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(t,s);const a=We(s,mn(this._activePointerMap));s.initialAngle=a,s.lastAngle=a,this._updatePointerAngles(n)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const t=e.native.pointerId,n=this._activePointerMap.get(t);n?n.event=e:this._addPointer(e)}_removePointer(e){const t=Fe(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(t)}_updatePointerAngles(e){const t=Fe(this._activePointerMap);this._activePointerMap.forEach(n=>{n.initialAngle=We(n,t)-e,n.lastAngle=We(n,t)-e})}_emitEvent(e,t,n){const s=Fe(this._activePointerMap);this._drag.emit(this._createPayload(e,t,s,n),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const t=e.data.native.pointerId,n=ct(e.timestamp);this._activePointerMap.get(t)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,n),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(t)):(this._removePointer(t),this._emitEvent("removed",e.data,ct(e.timestamp))))}_handlePointerDrag(e){const t=e.data,n=t.currentEvent,s=ct(e.timestamp);switch(t.action){case"start":case"update":this._isDragging?this._activePointerMap.has(n.native.pointerId)?(this._updatePointer(n),!this._isCurrentDragSuppressed&&this._emitEvent("update",n,s)):(this._addPointer(n),this._emitEvent("added",n,s),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(n),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",n,s))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function mn(i){const e=[];return i.forEach(t=>{e.push(ce(t.event.x,t.event.y))}),Ra(e)}function Fe(i){const e=mn(i);let t=0;return i.forEach(n=>{let s=We(n,e),a=s-n.lastAngle;for(;a>Math.PI;)a-=2*Math.PI;for(;a<-Math.PI;)a+=2*Math.PI;s=n.lastAngle+a,n.lastAngle=s;const o=s-n.initialAngle;t+=o}),t/=i.size||1,{angle:t,radius:e.radius,center:e.center}}function La(i){const e=new Map;return i.forEach((t,n)=>e.set(n,t.event)),e}function We(i,e){const t=i.event,n=t.x-e.center.x,s=t.y-e.center.y;return Math.atan2(s,n)}var Si;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right",i[i.Back=3]="Back",i[i.Forward=4]="Forward",i[i.Undefined=-1]="Undefined"})(Si||(Si={}));let $r=class extends ke{constructor(e=A.maximumDoubleClickDelay,t=A.maximumDoubleClickDistance,n=A.maximumDoubleTouchDelay,s=A.maximumDoubleTouchDistance,a=st){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=s,this._clock=a,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const t=e.data,n=Se(t);if(!this._pointerState.has(n)){const s={downButton:t.native.button,x:t.x,y:t.y,immediateDoubleClick:null};this._pointerState.set(n,s),this.startCapturingPointer(t.native)}}_handlePointerUp(e){const t=e.data,n=Se(t),s=this._pointerState.get(n);if(s&&s.downButton===t.native.button){const a=s.immediateDoubleClick,o=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;a?(a.timeoutHandle.remove(),St(a,e.data)>o?this._startImmediateDoubleClick(e,s):(this._immediateDoubleClick.emit(e.data,void 0,a.modifiers),this._removeState(t))):St(s,e.data)>o?this._removeState(t):this._startImmediateDoubleClick(e,s)}}_startImmediateDoubleClick(e,t){const n=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),n)}}_removeState(e){const t=Se(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},Dr=class extends ke{constructor(e=A.maximumClickDelay,t=A.movementUntilMouseDrag,n=A.movementUntilPenDrag,s=A.movementUntilTouchDrag,a=A.holdDelay,o=st){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=t,this._movementUntilPenDrag=n,this._movementUntilTouchDrag=s,this._holdDelay=a,this._clock=o,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",r=>{this._handlePointerLoss(r,"pointer-up")}),this.registerIncoming("pointer-capture-lost",r=>{this._handlePointerLoss(r,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",r=>{this._handlePointerLoss(r,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=ae(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const t=e.data,n=t.native.pointerId;let s=null;this._pointerState.size===0&&(s=this._clock.setTimeout(()=>{const o=this._pointerState.get(n);if(o){if(!o.isDragging){const r=o.previousEvent;this._pointerHold.emit(r,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._holdDelay));const a={startEvent:t,previousEvent:t,startTimestamp:e.timestamp,isDragging:!1,downButton:t.native.button,holdTimeout:s,modifiers:new Set};this._pointerState.set(n,a),this.startCapturingPointer(t.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_createPointerDragData(e,t,n){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:n}}_handlePointerMove(e){const t=e.data,n=t.native.pointerId,s=this._pointerState.get(n);s&&(s.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",s,t),void 0,s.modifiers):Va(t,s.startEvent)>this._getDragThreshold(t.native.pointerType)&&this._startDragging(e),s.previousEvent=t)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const t=e.data,n=t.native.pointerId;this._pointerState.forEach(s=>{s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging||(s.modifiers=e.modifiers,s.isDragging=!0,n===s.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",s,t)):this._pointerDrag.emit(this._createPointerDragData("start",s,s.previousEvent),e.timestamp))})}_handlePointerLoss(e,t){const n=e.data,s=n.native.pointerId,a=this._pointerState.get(s);a&&(a.holdTimeout!=null&&(a.holdTimeout.remove(),a.holdTimeout=null),a.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",a,t==="pointer-up"?n:a.previousEvent),void 0,a.modifiers):t==="pointer-up"&&a.downButton===n.native.button&&e.timestamp-a.startTimestamp<=this._maximumClickDelay&&!a.holdEmitted&&this._immediateClick.emit(n),this._pointerState.delete(s),this.stopCapturingPointer(n.native),this._pointerState.size===0&&this._moveHandle.pause())}},Ir=class extends ke{constructor(e=A.maximumDoubleClickDelay,t=A.maximumDoubleClickDistance,n=A.maximumDoubleTouchDelay,s=A.maximumDoubleTouchDistance,a=st){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=s,this._clock=a,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=ae(e.doubleClickTimer))}get hasPendingInputs(){return Rt(this._pointerState,e=>e.doubleClickTimer!=null)}_clearDoubleClickTimer(e,t){const n=this._pointerState.get(e);n&&(n.doubleClickTimer=ae(n.doubleClickTimer),t&&this._click.emit(n.event.data,void 0,n.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);t.pointerDownCount===1&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_getPointerId(e){const{pointerId:t,pointerType:n,button:s}=e.native;return n==="mouse"?`${t}:${s}`:`${n}`}_handleImmediateClick(e){const t=e.data,{pointerType:n}=t.native,s=this._getPointerId(t);if(!this._pointerState.has(s))return void this._startClick(e);const a=this._pointerState.get(s),{data:o,modifiers:r}=a.event,c=n==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;St(o,t)>c?(this._clearDoubleClickTimer(s,!0),this._startClick(e)):(this._clearDoubleClickTimer(s,!1),a.pointerDownCount===2&&this._doubleClick.emit(o,void 0,r))}_handlePointerDown(e){const t=Se(e.data),n=this._pointerState.get(t);n&&(n.pointerDownCount+=1)}_startClick(e){const{data:t}=e,{native:{pointerType:n}}=t,s=Se(t),a=n==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(s),a);this._pointerState.set(s,{event:e,doubleClickTimer:o,pointerDownCount:1}),this.refreshHasPendingInputs()}};const Ii=2048,Aa=1.5,Oa=8;function Ha(i,e){const{format:t,quality:n,rotation:s,disableDecorations:a}=i||{},o=Xt(i,e.padding),r=ja(i,{width:e.width-o.left-o.right,height:e.height-o.top-o.bottom}),{width:c,height:p}=za(i,r),d=_n(t),g=vn[d];return{format:d,quality:Je(n??g,0,100),area:r,width:c,height:p,rotation:s,disableDecorations:!!a,ignoreBackground:!!(i!=null&&i.ignoreBackground),ignorePadding:!!(i!=null&&i.ignorePadding)}}function Rr(i,e){const t=Ha(i,e),n=t.area,s=t.width/n.width,a=Xt(t,e.padding),o=a.left+a.right,r=a.top+a.bottom,c=e.width-o,p=e.height-r,d=Math.floor(c*s+o),g=Math.floor(p*s+r),u=(i==null?void 0:i.layers)??[],y=t.ignoreBackground,v=t.ignorePadding;return{framebufferWidth:d,framebufferHeight:g,region:{x:Math.floor(n.x*s)+a.left,y:Math.floor(n.y*s)+a.top,width:t.width,height:t.height},format:t.format,quality:t.quality,rotation:t.rotation,pixelRatio:s,layers:u,disableDecorations:t.disableDecorations,ignoreBackground:y,ignorePadding:v,objectAndLayerIdColor:!1}}function Lr(i,e,t){const{ctx:n,canvas:s}=yn(i,t),a=n.getImageData(0,0,i.width,i.height),o=Fa(s,e);return fn(s),{dataUrl:o,data:a}}function Ar(i,e){const{ctx:t,canvas:n}=yn(i,e),s=t.getImageData(0,0,i.width,i.height);return fn(n),s}function yn(i,e){const t=Na();e.premultipliedAlpha&&Wa(i),t.width=i.width,t.height=i.height;const n=t.getContext("2d",{willReadFrequently:!0});return n.putImageData(i,0,0),e.flipY&&Ua(n),{ctx:n,canvas:t}}function fn(i){i.width=0,i.height=0}function Na(){return vt==null&&(vt=document.createElement("canvas")),vt}let vt=null;function Fa(i,e){const t=Ba[e.format],n=e.quality/100;return i.toDataURL(t,n)}function Or(i,e){const t=_n(i),n=vn[t];return{format:t,quality:Je(e??n,0,100)}}function Hr(i,e){return e/Math.max(i[0],i[1])}function Nr(i,e,t,n=0,s=0,a=i.width-n,o=i.height-s,r=!1){const{data:c}=i,{width:p,height:d,data:g}=e,u=a/p,y=o/d,v=Math.ceil(u/2),V=Math.ceil(y/2),M=i.width;for(let k=0;k<d;k++)for(let D=0;D<p;D++){const f=4*(D+(r?d-k-1:k)*p);let S=0,N=0,B=0,pe=0,Qt=0,Jt=0;const kn=(k+.5)*y;for(let Ve=Math.floor(k*y);Ve<(k+1)*y;Ve++){const ei=Math.abs(kn-(Ve+.5))/V,Mn=(D+.5)*u,xn=ei*ei;for(let Re=Math.floor(D*u);Re<(D+1)*u;Re++){const ti=Math.abs(Mn-(Re+.5))/v,ue=Math.sqrt(xn+ti*ti);if(ue>=1)continue;let J=2*ue*ue*ue-3*ue*ue+1;const de=4*(n+Re+(s+Ve)*M);Jt+=J*c[de+3],N+=J,!t&&c[de+3]<255&&(J=J*c[de+3]/255),B+=J*c[de],pe+=J*c[de+1],Qt+=J*c[de+2],S+=J}}g[f]=B/S,g[f+1]=pe/S,g[f+2]=Qt/S,g[f+3]=Jt/N}return e}function Fr(i,e,t){if(!e)return i;const{framebufferWidth:n,framebufferHeight:s,pixelRatio:a,region:o}=i,r=Xt(i,t),c=r.left+r.right,p=r.top+r.bottom,d=n-c,g=s-p,u=Math.min(Oa,Math.min((Ii-c)/d,(Ii-p)/g));return u<Aa?i:{...i,framebufferWidth:Math.round(d*u)+c,framebufferHeight:Math.round(g*u)+p,pixelRatio:a*u,resample:{region:{x:Math.round((o.x-r.left)*u)+r.left,y:Math.round((o.y-r.top)*u)+r.top,width:Math.round(o.width*u),height:Math.round(o.height*u)},width:n,height:s}}}function za(i,e){if(!i)return e;const t=i.width,n=i.height;if(t!=null&&n!=null)return{width:Math.floor(t),height:Math.floor(n)};if(t==null&&n==null)return e;const s=e.width/e.height;return n==null?{width:Math.floor(t),height:Math.floor(t/s)}:{width:Math.floor(n*s),height:Math.floor(n)}}function ja(i,e){const t={x:0,y:0,width:e.width,height:e.height};if(i!=null&&i.area){i.area.x!=null&&(t.x=Math.floor(i.area.x)),i.area.y!=null&&(t.y=Math.floor(i.area.y));const n=i.area.width!=null?Math.floor(i.area.width):null,s=i.area.height!=null?Math.floor(i.area.height):null;if(t.width=e.width-t.x,t.height=e.height-t.y,n!=null&&s!=null)t.width=Math.min(t.width,n),t.height=Math.min(t.height,s);else if(n==null&&s!=null){const a=Math.min(t.width,n);t.height=a/t.width*t.height,t.width=a}else if(n!=null&&s==null){const a=Math.min(t.height,s);t.width=a/t.height*t.width,t.height=a}}return Ga(qa(t,i),e)}function Ga(i,e){const t=Math.floor(Math.max(i.x,0)),n=Math.floor(Math.max(i.y,0)),s={x:t,y:n,width:Math.floor(Math.min(i.width,e.width-t)),height:Math.floor(Math.min(i.height,e.height-n))},a=s.width/s.height,o=i.width/i.height;if(o===a)return s;if(o>a){const p=Math.floor(s.width/o),d=s.height-p;return{x:s.x,y:Math.floor(s.y+d/2),width:s.width,height:p}}const r=Math.floor(s.height*o),c=s.width-r;return{x:Math.floor(s.x+c/2),y:s.y,width:r,height:s.height}}function qa(i,e){if((e==null?void 0:e.width)==null||e.height==null)return i;const t=e.width/e.height,n=i.width/i.height;if(n===t)return i;if(n<t){const a=Math.floor(i.height*t);return i.x-=(a-i.width)/2,i.width=a,i}const s=Math.floor(i.width/t);return i.y-=(s-i.height)/2,i.height=s,i}function Xt(i,e){return!e||i&&i.ignorePadding?Za:e}function _n(i){switch(i){case"png":case"jpg":case"jpeg":return i;default:return Ka}}function Ua(i){i.save(),i.globalCompositeOperation="copy",i.scale(1,-1),i.translate(0,-i.canvas.height),i.drawImage(i.canvas,0,0),i.restore()}function Wa(i){const e=i.data,t=e.length;for(let n=0;n<t;n+=4){const s=e[n+3];if(s!==255&&s>0){const a=255/s;e[n]=e[n]*a,e[n+1]=e[n+1]*a,e[n+2]=e[n+2]*a}}}const Ba={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},Vi=98,Ka="png",vn={png:100,jpg:Vi,jpeg:Vi},Za={top:0,right:0,bottom:0,left:0};function zr(i){const e=Cs();return e.available?i==="3d"&&e.majorPerformanceCaveat?new O("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new O("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new O("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new O("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function Ya(i){return i&&"nodeType"in i}function Xa(i){return i&&typeof i.render=="function"}const Ri={component:"esri-component"};let le=class extends ${constructor(){super(...arguments),this.widget=null}destroy(){var i;this.node=null,(i=this.widget)==null||i.destroy()}get id(){var i,e;return this._get("id")??((i=this.widget)==null?void 0:i.id)??((e=this.node)==null?void 0:e.id)}set id(i){this._set("id",i)}set node(i){const e=this._get("node");i!==e&&(i&&i.classList.add(Ri.component),e&&e.classList.remove(Ri.component),this._set("node",i))}castNode(i){var e;return(e=this.widget)==null||e.destroy(),i?typeof i=="string"||Ya(i)?(this._set("widget",null),Ui(i)):(Xa(i)&&!i.domNode&&(i.domNode=document.createElement("div")),this._set("widget",i),i.domNode):(this._set("widget",null),null)}};l([h()],le.prototype,"id",null),l([h()],le.prototype,"node",null),l([qi("node")],le.prototype,"castNode",null),l([h({readOnly:!0})],le.prototype,"widget",void 0),le=l([b("esri.views.ui.Component")],le);const Be=le,Qa={left:0,top:0,bottom:0,right:0},wn={bottom:30,top:15,right:15,left:15},Z="esri-ui",I={ui:Z,corner:`${Z}-corner`,innerContainer:`${Z}-inner-container`,manualContainer:`${Z}-manual-container`,cornerContainer:`${Z}-corner-container`,topLeft:`${Z}-top-left`,topRight:`${Z}-top-right`,bottomLeft:`${Z}-bottom-left`,bottomRight:`${Z}-bottom-right`};function Ja(i){return i&&!i._started&&typeof i.postMixInProperties=="function"&&typeof i.buildRendering=="function"&&typeof i.postCreate=="function"&&typeof i.startup=="function"}function ze(i){return i===0?"0":`${i}px`}function wt(i){const e=typeof i=="object"&&i!==null&&Object.getPrototypeOf(i);return(e===null||e===Object.prototype)&&("component"in i||"index"in i||"position"in i)?i:null}function bt(i,{top:e,bottom:t,left:n,right:s}){i.style.top=e,i.style.bottom=t,i.style.left=n,i.style.right=s}let G=class extends Lt.EventedAccessor{constructor(i){super(i),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._locale=Jn(),this.view=null,this._applyViewPadding=()=>{const e=this.container;e&&bt(e,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const e=this._innerContainer;e&&bt(e,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([w(()=>{var i;return[(i=this.view)==null?void 0:i.padding,this.container]},this._applyViewPadding,W),w(()=>this.padding,this._applyUIPadding,W),w(()=>[this.container,this._locale],([i,e])=>{i&&i.setAttribute("lang",e)},W),Ai(i=>{this._locale=i})])}destroy(){this.container=null;for(const i of this._components)i.destroy();this._components.length=0,this._componentMap.clear()}set container(i){const e=this._get("container");i!==e&&(i&&(i.classList.add(I.ui),Ps(i),this._attachContainers(i)),e&&(e.classList.remove(I.ui),bt(e,{top:"",bottom:"",left:"",right:""}),Wi(e)),this._set("container",i))}get height(){var s;const i=((s=this.view)==null?void 0:s.height)??0;if(i===0)return i;const e=this._getViewPadding(),{top:t,bottom:n}=e;return Math.max(i-t-n,0)}get padding(){return this._get("padding")}set padding(i){this._overrideIfSome("padding",i)}castPadding(i){return typeof i=="number"?{bottom:i,top:i,right:i,left:i}:{...wn,...i}}get width(){var s;const i=((s=this.view)==null?void 0:s.width)??0;if(i===0)return i;const e=this._getViewPadding(),{left:t,right:n}=e;return Math.max(i-t-n,0)}add(i,e){let t,n,s;if(Array.isArray(i))return void i.forEach(o=>this.add(o,e));const a=wt(i);a&&({index:t,position:e,component:i,key:n}=a),e&&typeof e=="object"&&({index:t,key:n,position:e,internal:s}=e),!i||e&&!this._isValidPosition(e)||this._add(i,e,t,n,s)}remove(i,e){var n;if(!i)return;if(Array.isArray(i))return i.map(s=>this.remove(s,e));const t=this._find(i);if(t){if(this._componentMap.has(t)&&((n=this._componentMap.get(t))==null?void 0:n.key)!==e)return;const s=this._components.indexOf(t),a=t.node.parentNode;return a==null||a.removeChild(t.node),this._componentMap.delete(t),this._components.splice(s,1)[0]}}empty(i,e={removeInternal:!1}){if(Array.isArray(i)){for(const s of i)this.empty(s,e);return}const t=this._positionNameToContainerLookup[i??"manual"],n=Array.prototype.slice.call(t.children).map(s=>this._findByNode(s)).filter(s=>{var a;return s==null?!1:!(((a=this._componentMap.get(s))==null?void 0:a.internal)??!1)||e.removeInternal});for(const s of n)this.remove(s)}move(i,e){if(Array.isArray(i)&&i.forEach(a=>this.move(a,e)),!i)return;let t;const n=wt(i)||wt(e);if(n&&(t=n.index,e=n.position,i=n.component||i),e&&!this._isValidPosition(e))return;const s=this.remove(i);s&&this.add(s,{position:e,index:t})}find(i){if(!i)return null;const e=this._findById(i);return e&&(e.widget||e.node)}getComponents(i,e={includeInternal:!1}){return i?Array.isArray(i)?i.flatMap(t=>this._getComponentsAtPosition(t,e)):this._getComponentsAtPosition(i,e):this._components.filter(t=>{var n;return e.includeInternal||!((n=this._componentMap.get(t))!=null&&n.internal)}).map(({widget:t,node:n})=>t??n)}getPosition(i){for(const e in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[e].contains(i))return e;return null}_add(i,e,t,n,s){i instanceof Be||(i=new Be({node:i})),this._place({component:i,position:e,index:t}),this._components.push(i),this._componentMap.set(i,{key:n,internal:s})}_find(i){return i?i instanceof Be?this._findByComponent(i):typeof i=="string"?this._findById(i):this._findByNode(i.domNode||i):null}_getViewPadding(){var i;return((i=this.view)==null?void 0:i.padding)??Qa}_attachContainers(i){i.appendChild(this._innerContainer),i.appendChild(this._manualContainer)}_initContainers(){const i=document.createElement("div");i.classList.add(I.innerContainer,I.cornerContainer);const e=document.createElement("div");e.classList.add(I.innerContainer,I.manualContainer);const t=document.createElement("div");t.classList.add(I.topLeft,I.corner),i.appendChild(t);const n=document.createElement("div");n.classList.add(I.topRight,I.corner),i.appendChild(n);const s=document.createElement("div");s.classList.add(I.bottomLeft,I.corner),i.appendChild(s);const a=document.createElement("div");a.classList.add(I.bottomRight,I.corner),i.appendChild(a),this._innerContainer=i,this._manualContainer=e;const o=ss();this._cornerNameToContainerLookup={"top-left":t,"top-right":n,"bottom-left":s,"bottom-right":a,"top-leading":o?n:t,"top-trailing":o?t:n,"bottom-leading":o?a:s,"bottom-trailing":o?s:a},this._positionNameToContainerLookup={manual:e,...this._cornerNameToContainerLookup}}_isValidPosition(i){return!!this._positionNameToContainerLookup[i]}_place(i){const e=i.position??"manual",{component:t,index:n}=i,s=this._positionNameToContainerLookup[e],a=n!=null&&n>-1;if(Ja(t.widget)&&t.widget.startup(),!a)return void s.appendChild(t.node);const o=Array.from(s.children);if(n===0)return void(s.firstChild?ci(t.node,s.firstChild):s.appendChild(t.node));n>=o.length?s.appendChild(t.node):ci(t.node,o[n])}_toPixelPosition(i){return{top:ze(i.top),left:ze(i.left),right:ze(i.right),bottom:ze(i.bottom)}}_findByComponent(i){return this._components.find(e=>e===i)??null}_findById(i){return this._components.find(({id:e})=>e===i)??null}_findByNode(i){return this._components.find(({node:e})=>e===i)??null}_getComponentsAtPosition(i,e){const t=this._positionNameToContainerLookup[i];return Array.prototype.slice.call(t.children).map(n=>this._findByNode(n)).filter(Ni).filter(n=>{var s;return e.includeInternal||!((s=this._componentMap.get(n))!=null&&s.internal)}).map(({widget:n,node:s})=>n??s)}};l([h()],G.prototype,"_locale",void 0),l([h()],G.prototype,"container",null),l([h()],G.prototype,"height",null),l([h({value:wn})],G.prototype,"padding",null),l([qi("padding")],G.prototype,"castPadding",null),l([h()],G.prototype,"view",void 0),l([h()],G.prototype,"width",null),G=l([b("esri.views.ui.UI")],G);const eo=G;let Ke,Ze=null;const we=new Map;async function jr(i){Ze==null&&(Ke==null&&(Ke=Xe(()=>import("./Lyr3DWasmPerSceneView-DInyPW1I.js"),__vite__mapDeps([56,1,2,57,58,59,60]))),Ze=await Ke);const e=i.view;let t=we.get(e);return t||(t=new Ze.default({view:e}),we.set(e,t)),await t.initializeWasm(),t.add3DTilesLayerView(i)}function to(i){return we.get(i)}function Gr(i){const e=i.view,t=we.get(e);t&&t.remove3DTilesLayerView(i)<1&&(we.delete(e),we.size===0&&(Ke=null,Ze=null))}function Li(i,e){return i&&"copyright"in i&&(!e||typeof i.originOf=="function"&&i.originOf("copyright")==="user")}function io(i,e){return i.length!==e.length||i.some((t,n)=>t.text!==e[n].text)}function Te(i,e,t){!t||!e||i.find(n=>n.layerView===e&&n.text===t)||i.push({text:t,layerView:e})}function no(i){return i.type==="bing-maps"}const Y=[];let _e=class extends ${constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new E,this.view=null,this._allLayerViewsChange=t=>{var s;this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const n=(s=this.view)==null?void 0:s.allLayerViews;n&&(this.addHandles(n.map(a=>w(()=>{var o;return[a.suspended,(o=a.layer)==null?void 0:o.attributionVisible]},()=>this._updateAttributionItems())).toArray(),"suspension"),n.forEach(a=>{a.declaredClass==="esri.views.3d.layers.Tiles3DLayerView3D"&&this.addHandles(a.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),t!=null&&t.removed&&t.removed.forEach(a=>{this._pendingAttributions.delete(a),this._fetchedAttributionData.delete(a)}),this._updateAttributionItems()},this.addHandles([nt(()=>{var t;return(t=this.view)==null?void 0:t.allLayerViews},"change",t=>this._allLayerViewsChange(t),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),zi(()=>{var t;return((t=this.view)==null?void 0:t.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){var e;return(e=this.view)!=null&&e.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,t=e==null?void 0:e.allLayerViews;if(Y.length=0,!e||!t)return void this._clear();t.forEach(s=>{var r,c;if(s.suspended||!((r=s.layer)!=null&&r.attributionVisible))return;const a=s.layer;if(Li(a,"user"))return void Te(Y,s,a.copyright);if(a.hasAttributionData){if(this._fetchedAttributionData.has(s)){const p=this._fetchedAttributionData.get(s);return void(p?Te(Y,s,this._getDynamicAttribution(p,e,a)):Li(a)&&Te(Y,s,a.copyright))}return void this._fetchAttributionData(s)}const o="portalItem"in a?(c=a.portalItem)==null?void 0:c.accessInformation:void 0;Te(Y,s,o||a.copyright)});const n=t.find(s=>{var a;return((a=s.layer)==null?void 0:a.type)==="integrated-mesh-3dtiles"});if(this.view&&n){const s=to(this.view);if(s){const a=s.getAttributionText();for(let o=0;o<a.length;++o)Te(Y,n,a[o])}}io(this.items,Y)&&(this.items.removeAll(),this.items.addMany(Y)),Y.length=0,this.notifyChange("state")}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const t=await es(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const n=t.ok?this._createContributionIndex(t.value,no(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,n)}this._updateAttributionItems()}_createContributionIndex(e,t){const n=e.contributors,s={};if(!n)return s;for(let a=0;a<n.length;a++){const o=n[a],r=o.coverageAreas;if(!r)return;for(const c of r){const p=c.bbox,d=c.zoomMin-(t&&c.zoomMin?1:0),g=c.zoomMax-(t&&c.zoomMax?1:0),u=new Ie({xmin:p[1],ymin:p[0],xmax:p[3],ymax:p[2],spatialReference:zt.WGS84}),y={extent:ts(u),attribution:o.attribution||"",score:c.score!=null?c.score:100,id:a};for(let v=d;v<=g;v++)s[v]??(s[v]=[]),s[v].push(y)}}return s.maxKey=Math.max.apply(null,Object.keys(s)),s}_getDynamicAttribution(e,t,n){var d;const{extent:s,scale:a}=t;let o=((d=n.tileInfo)==null?void 0:d.scaleToZoom(a))??0;if(o=Math.min(e.maxKey??0,Math.round(o)),!s||o==null||o<=-1)return"";const r=e[o],c=is(s.center.clone().normalize(),t.spatialReference),p=new Set;return r?r.filter(g=>{const u=g.id,y=!p.has(u)&&c&&g.extent&&ns(g.extent,c);return y&&p.add(u),y}).sort((g,u)=>u.score-g.score||g.objectId-u.objectId).map(g=>g.attribution).join(", "):""}};l([h({readOnly:!0,type:E})],_e.prototype,"items",void 0),l([h({readOnly:!0})],_e.prototype,"state",null),l([h()],_e.prototype,"view",void 0),_e=l([b("esri.widgets.Attribution.AttributionViewModel")],_e);const bn=_e,ye="esri-attribution",oe={base:ye,poweredBy:`${ye}__powered-by`,sources:`${ye}__sources`,open:`${ye}--open`,sourcesOpen:`${ye}__sources--open`,link:`${ye}__link`,widgetIcon:rs.description};let C=class extends os{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(n=>n.forEach(({target:s})=>this._checkSourceTextOverflow(s))),this.iconClass=oe.widgetIcon,this.icon=null,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new bn}initialize(){this.addHandles(nt(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,t)=>(e.includes(t.text)||e.push(t.text),e),[]).join(this.itemDelimiter)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[oe.open]:this._isOpen};return Ae("div",{bind:this,class:this.classes(oe.base,_i.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return Ae("div",{class:oe.poweredBy},"Powered by"," ",Ae("a",{class:oe.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,n=t?0:void 0,{attributionText:s}=this,a={[oe.sourcesOpen]:e,[_i.interactive]:t};return Ae("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(oe.sources,a),innerHTML:s,tabIndex:n})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let t=!1;const{clientHeight:n,clientWidth:s,scrollWidth:a}=e,o=a>s,r=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,r&&(t=!0),this._isOpen){const c=n<this._prevSourceNodeHeight;this._prevSourceNodeHeight=n,c&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};l([h()],C.prototype,"_isOpen",void 0),l([h()],C.prototype,"_isInteractive",null),l([h()],C.prototype,"_attributionTextOverflowed",void 0),l([h()],C.prototype,"_prevSourceNodeHeight",void 0),l([h({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],C.prototype,"attributionText",null),l([h()],C.prototype,"iconClass",void 0),l([h()],C.prototype,"icon",void 0),l([h()],C.prototype,"itemDelimiter",void 0),l([h()],C.prototype,"label",null),l([h(),as("esri/widgets/Attribution/t9n/Attribution")],C.prototype,"messages",void 0),l([h()],C.prototype,"view",null),l([h({type:bn})],C.prototype,"viewModel",void 0),l([$s()],C.prototype,"_toggleState",null),C=l([b("esri.widgets.Attribution")],C);const so=C;function ao(i){return(i==null?void 0:i.view)!==void 0}let Ye=class extends eo{constructor(i){super(i),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=e=>{this.components.forEach(t=>{const n=this._find(t),s=n==null?void 0:n.widget;ao(s)&&(s.view=e)})},this._componentsWatcher=(e,t)=>{this._removeComponents(t),this._addComponents(e),this._adjustPadding(e)}}initialize(){this.addHandles([w(()=>this.components,this._componentsWatcher,W),w(()=>this.view,this._updateViewAwareWidgets,W)])}_add(i,e,t,n,s){let a=i;if(typeof i=="string"&&this._defaultPositionLookup[i]){if(this._find(i))return;a=this._createComponent(i)}super._add(a,e,t,n,s)}_removeComponents(i){i.forEach(e=>{const t=this._find(e);t&&(this.remove(t),t.destroy())})}_adjustPadding(i){if(!i.includes("attribution")&&!this._isOverridden("padding")){const{top:e}=this.padding;this.padding=e}}_addComponents(i){this.constructed&&i.forEach(e=>this.add(this._createComponent(e),this._defaultPositionLookup[e]))}_createComponent(i){const e=this._createWidget(i);return new Be({id:i,node:e})}_createWidget(i){const{view:e}=this;switch(i){case"attribution":return new so({view:e});case"compass":return new Es({view:e});case"navigation-toggle":return new Ds({view:e});case"zoom":return new Ss({view:e})}}};l([h()],Ye.prototype,"components",void 0),Ye=l([b("esri.views.ui.DefaultUI")],Ye);const Wr=Ye;export{ra as $,Se as A,Ia as B,$r as C,Dr as D,Ir as E,Cr as F,va as G,qe as H,xr as I,Or as J,Lr as K,Ar as L,Hr as M,Wr as N,Vo as O,Ao as P,Lo as Q,ur as R,zr as S,tr as T,dr as U,Nr as V,mr as W,wr as X,sr as Y,Q as Z,tt as _,Gr as a,Rr as a0,Fr as a1,pn as b,hr as c,nr as d,Ue as e,ar as f,rr as g,lr as h,jr as i,pr as j,Yt as k,to as l,ma as m,gr as n,yr as o,or as p,_r as q,wa as r,vr as s,ba as t,br as u,kr as v,cr as w,fa as x,A as y,St as z};
