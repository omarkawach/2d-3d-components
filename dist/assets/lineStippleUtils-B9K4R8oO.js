import{o as E,G as I}from"./vec2-Dt9Foiri.js";import{n as T}from"./vec2f64-Diu2Kaa8.js";import{jU as R,fx as b,jV as A,de as w}from"./index-8ERthB3p.js";import{t as g,a as y}from"./DoubleArray-068mylUp.js";import{t as O}from"./Texture-C7A05GrI.js";import{A as F}from"./Indices-DP3oX5Sg.js";import{l as S}from"./ViewingMode-Dodu7ZZk.js";import{t as f}from"./Attribute-B-NAci_J.js";import{e as v}from"./ContentObject-BTgEhnct.js";import{I as C}from"./Geometry-CqGtfd4N.js";import{e as d}from"./VertexAttribute-BnAa5VW0.js";import{u as m,g as D}from"./triangulationUtils-C0V38kt7.js";import{u as N,t as U}from"./RenderGeometry-rcUvJmRA.js";function lt(t,o,n=null){const e=[],s=o.mapPositions;j(o,e);const i=e[0][1].data,r=e[0][1].indices.length,a=F(r);return L(o,e,a),P(o,e,a),x(o,e,a),z(o,e,a),_(o,e,a),B(o,e,a),G(o,e,i),new C(t,e,s,v.Line,n)}function j(t,o){const{attributeData:{position:n},removeDuplicateStartEnd:e}=t,s=H(n)&&e,i=n.length/3-(s?1:0),r=new Array(2*(i-1)),a=s?n.slice(0,-3):n;let u=0;for(let c=0;c<i-1;c++)r[u++]=c,r[u++]=c+1;o.push([d.POSITION,new f(a,r,3,s)])}function L(t,o,n){if(t.attributeData.colorFeature!=null)return;const e=t.attributeData.color;o.push([d.COLOR,new f(e??R,n,4)])}function x(t,o,n){t.attributeData.normal&&o.push([d.NORMAL,new f(t.attributeData.normal,n,3)])}function z(t,o,n){t.attributeData.colorFeature!=null&&o.push([d.COLORFEATUREATTRIBUTE,new f([t.attributeData.colorFeature],n,1,!0)])}function P(t,o,n){t.attributeData.sizeFeature==null&&o.push([d.SIZE,new f([t.attributeData.size??1],n,1,!0)])}function _(t,o,n){t.attributeData.sizeFeature!=null&&o.push([d.SIZEFEATUREATTRIBUTE,new f([t.attributeData.sizeFeature],n,1,!0)])}function B(t,o,n){t.attributeData.opacityFeature!=null&&o.push([d.OPACITYFEATUREATTRIBUTE,new f([t.attributeData.opacityFeature],n,1,!0)])}function G(t,o,n){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==S.Global||!t.overlayInfo.spatialReference.isGeographic)return;const e=g(n.length),s=b(t.overlayInfo.spatialReference);for(let p=0;p<e.length;p+=3)A(n,p,e,p,s);const i=n.length/3,r=O(i+1);let a=Z,u=M,c=0,h=0;E(a,e[h++],e[h++]),h++,r[0]=0;for(let p=1;p<i+1;++p)p===i&&(h=0),E(u,e[h++],e[h++]),h++,c+=I(a,u),r[p]=c,[a,u]=[u,a];o.push([d.DISTANCETOSTART,new f(r,o[0][1].indices,1,!0)])}function H(t){const o=t.length;return t[0]===t[o-3]&&t[1]===t[o-2]&&t[2]===t[o-1]}const Z=T(),M=T();function ut(t,o){if(t==null||t.length===0)return[];const n=[];return t.forEach(e=>{const s=e.length,i=g(3*s);e.forEach((a,u)=>{i[3*u]=a[0],i[3*u+1]=a[1],i[3*u+2]=a[2]});const r={attributeData:{position:i,normal:o},removeDuplicateStartEnd:!1};n.push(r)}),n}function ct(t,o,n,e){const s=t.type==="polygon"?m.CCW_IS_HOLE:m.NONE,i=t.type==="polygon"?t.rings:t.paths,{position:r,outlines:a}=D(i,!!t.hasZ,s,t.spatialReference),u=g(r.length),c=N(r,t.spatialReference,0,u,0,r,0,r.length/3,o,n,e),h=c!=null;return{lines:h?$(a,r,u):[],projectionSuccess:h,sampledElevation:c}}function ht(t,o){const n=t.type==="polygon"?m.CCW_IS_HOLE:m.NONE,e=t.type==="polygon"?t.rings:t.paths,{position:s,outlines:i}=D(e,!1,n),r=w(s,t.spatialReference,0,s,o,0,s.length/3);for(let a=2;a<s.length;a+=3)s[a]=U;return{lines:r?$(i,s):[],projectionSuccess:r}}function $(t,o,n=null){const e=new Array;for(const{index:s,count:i}of t){if(i<=1)continue;const r=3*s,a=3*i;e.push({position:y(o,3*s,3*i),mapPositions:n!=null?y(n,r,a):void 0})}return e}const l={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},W={dash:l.dash,"dash-dot":[...l.dash,...l.dot],dot:l.dot,"long-dash":l["long-dash"],"long-dash-dot":[...l["long-dash"],...l.dot],"long-dash-dot-dot":[...l["long-dash"],...l.dot,...l.dot],none:null,"short-dash":l["short-dash"],"short-dash-dot":[...l["short-dash"],...l["short-dot"]],"short-dash-dot-dot":[...l["short-dash"],...l["short-dot"],...l["short-dot"]],"short-dot":l["short-dot"],solid:null},V=8;function Y(t,o){return t==null?t:{pattern:t.slice(),pixelRatio:o}}function pt(t){return{pattern:[t,t],pixelRatio:2}}function ft(t){return t!=null&&t.type==="style"?k(t.style):null}function k(t){return t!=null?Y(W[t],V):null}export{ut as R,lt as b,pt as h,ht as l,ft as n,ct as p};
