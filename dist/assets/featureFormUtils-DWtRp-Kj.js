import{ge as d,q as _,bp as j,gf as A,gg as v,aG as y,gh as F,gi as b,gj as I,gk as L}from"./index-8ERthB3p.js";import{Z as R}from"./utils-B6UP7_Wm.js";import{s as g}from"./substitute-DkE5N3Tl.js";const U=e=>(e==null?void 0:e.type)==="field",V=e=>(e==null?void 0:e.type)==="group",Z=e=>(e==null?void 0:e.type)==="relationship",H=e=>!V(e)&&e.group!=null,D=e=>e.type==="field",M=e=>e.type==="group",P=e=>e.type==="relationship",h=e=>e.reduce((t,n)=>V(n)?[...t,...n.inputs]:[...t,n],[]),$=e=>h(e).filter(U),B=e=>h(e).filter(Z),Y=e=>e!=null&&(m(e,"combo-box")||m(e,"radio-buttons")),m=(e,t)=>{var n;return e!=null&&((n=e.input)==null?void 0:n.type)===t},z=e=>e!=null&&(m(e,"text-box")||m(e,"text-area")),J=({domain:e,inputType:t="text-box",dataType:n})=>n==="number"&&t==="text-box"&&(!e||e.type!=="coded-value"),K=e=>"items"in e,T={typeFieldName:null,types:[]};function Q(e){const{attributes:t,fieldsIndex:n,label:r,timeZone:o}=e;if(!t||typeof t!="object")return r;const i=Object.keys(t).filter(a=>d(r,a)),u=i.map(a=>t[a]),l=i.map(a=>n.get(a)).filter(_);return C(r,w({values:u,fields:l,timeZone:o}))}function w(e){const{fields:t,values:n}=e,r=e.timeZone??void 0,o=t.map((i,u)=>{let l=n[u];if(i.domain&&i.domain.type==="coded-value"){const a=i.domain.codedValues.find(p=>p.code===l);a!=null&&a.name&&(l=a.name)}return(R(i)||j(i))&&(l=A(i,l,{timeZone:r,...v(i)})),[i.name,l]});return Object.fromEntries(o)}function C(e,t){return y(y(e,n=>`{${n.toLowerCase()}}`),Object.fromEntries(Object.entries(t).map(([n,r])=>[n.toLowerCase(),r])))}const W=e=>{var t,n;return e?e.type==="subtype-sublayer"?{typeFieldName:(t=e.parent)==null?void 0:t.subtypeField,types:((n=e.parent)==null?void 0:n.subtypes)??[]}:"types"in e&&e.types?{typeFieldName:e.typeIdField,types:e.types.map(({id:r,name:o,domains:i})=>({code:r,name:o,domains:i}))}:T:T},X=(e,t)=>{if(!e)return!0;const{operations:n}=e;switch(t){case"INSERT":return n.supportsAdd;case"UPDATE":case"DELETE":return n.supportsUpdate;default:return!0}};var c;(function(e){e.TOO_SHORT="length-validation-error::too-short"})(c||(c={}));const x={type:"number"},E={type:"number",intlOptions:{notation:"scientific"}};function O(e){return e>=1e7||e<=-1e7}function S(e,{validationErrors:t}){return e.max!=null&&e.min!=null?t.outsideRange:e.max!=null?t.outsideRangeMax:t.outsideRangeMin}const ee=(e,t,n)=>{const{dataType:r,error:o,minLength:i,value:u,required:l}=e,a=t==null?void 0:t.validationErrors;if(!a||!o)return null;if(l&&u===null)return a.cannotBeNull;if(o===b.VALUE_OUT_OF_RANGE||o===I.OUT_OF_RANGE){const{field:p,range:s}=e,f={type:"date",intlOptions:{timeZone:p.type==="date"&&n?n:void 0,...v(p)}},N=S(s,t);return g(N,s,{format:{max:r==="date"?f:s.max!=null&&O(s.max)?E:x,min:r==="date"?f:s.min!=null&&O(s.min)?E:x}})}return o===b.INVALID_CODED_VALUE?a.invalidCodedValue:o===L.INVALID_TYPE?a.invalidType:o===c.TOO_SHORT?g(a.tooShort,{min:i}):null},te=e=>{var o;if(!e)return;const t=e.layer,n=t&&"geometryType"in t?t.geometryType:void 0,r=(o=e.geometry)==null?void 0:o.type;return r==="polyline"||n==="polyline"?"line":r||n||"table"},ne=e=>{var n;const t=[];if(e.formTemplate){const{description:r,title:o}=e.formTemplate;(n=e.fields)==null||n.forEach(i=>{const u=o&&d(o,i.name),l=r&&d(r,i.name);(u||l)&&t.push(i.name)})}return t};function re(e,t){var r;const n=t??("formTemplate"in e&&e.formTemplate);return n?(((r=n.elements)==null?void 0:r.filter(D))??[]).some(({fieldName:o})=>!e.fieldsIndex.get(o)):!1}function oe(e,t){return e==null||t.onValue!==e&&t.offValue!==e}function ie(e,t){var n;switch(t.objectType){case"any":return!0;case"null":return e==null;case"code":return e===((n=t.codedValue)==null?void 0:n.code);case"range":return e!=null&&t.minValue!=null&&t.maxValue!=null&&+e>=t.minValue&&+e<=t.maxValue;default:return F(t.objectType),!1}}export{w as A,Y as E,c as F,ne as G,re as H,W as L,te as M,$ as O,oe as P,X as R,ee as S,M as T,J as U,z as V,Q as _,D as b,V as c,U as d,Z as f,K as h,B as j,ie as k,m as v,P as x,H as y};
