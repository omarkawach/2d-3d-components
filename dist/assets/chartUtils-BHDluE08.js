import{o as F,l as _}from"./ResponsiveTheme-DciI5FRV.js";import{a0 as K,fZ as R,dS as D,aI as N,jt as q,b0 as J,bZ as Q}from"./index-8ERthB3p.js";import{r as P}from"./signal-DoM1gSF0.js";import{g as O,b as ii}from"./unitFormatUtils-3MMEFLJJ.js";import{r as v,e as ti,s as oi}from"./ElevationProfile-Ds6SYnTP.js";import{R as ei,E as ni}from"./chartUtilsAm5-C8GRaEXE.js";import{v as W}from"./jsxFactory-BxQYPm-b.js";import{r as ai}from"./themeUtils-C3zvZbsE.js";import{o as ri,u as z,_ as si,b as li,r as pi,x as mi}from"./LineSeries-BlRqWGbr.js";import{a2 as b,o as u,r as di,z as ci}from"./Theme-Dbf5TNsf.js";import{u as E}from"./Tooltip-Drs-QzQE.js";import{s as ui}from"./substitute-DkE5N3Tl.js";import"./ByteSizeUnit-BsxeN7wM.js";import"./Cyclical-BY9qISY1.js";import"./quantityUtils-9zDVxeky.js";import"./memoize-DsJmrG76.js";import"./ElevationQueryTileCache-CV2Fph_A.js";import"./projectVectorToVector-C3SBBDgz.js";import"./projectPointToVector-qKp-AJ2b.js";import"./LayerConstants-B33OP6sh.js";import"./Material-DwPnlQDw.js";import"./interfaces-B8ge7Jg9.js";import"./basicInterfaces-DngWxyLO.js";import"./ContentObject-BTgEhnct.js";import"./VertexAttribute-BnAa5VW0.js";import"./ViewingMode-Dodu7ZZk.js";import"./Util-B8vYs4k8.js";import"./vec2f64-Diu2Kaa8.js";import"./ElevationProvider-Bd4qfXCi.js";import"./mat4f64-Dk4dwAN8.js";import"./sphere-Bf4ezJdT.js";import"./ObjectStack-BPo9QGhV.js";import"./plane-Du3EYICn.js";import"./mat3f64-BBpwCtoL.js";import"./quatf64-BrpT0VRp.js";import"./mathUtils-iSLnUy_4.js";import"./boundedPlane-CLJ-Xnn_.js";import"./lineSegment-DVvvMBnG.js";import"./verticalOffsetUtils-BYv4Nk2v.js";import"./mat3-CqxUQBLP.js";import"./orientedBoundingBox-BQvYwCTM.js";import"./quat-DUnoL8dP.js";import"./spatialReferenceEllipsoidUtils-CmEPjh7T.js";import"./computeTranslationToOriginAndRotation-BbJd4iYX.js";import"./Attribute-B-NAci_J.js";import"./Intersector-8rpRuT_8.js";import"./Intersector-CTjLkyei.js";import"./defaultUnit-gjMTMp_C.js";import"./getDefaultUnitForView-BEilgbp7.js";import"./throttle-jjSnxk80.js";import"./elevationInfoUtils-sHEwmo9N.js";import"./vec2-Dt9Foiri.js";import"./geodesicUtils-D1kRRrco.js";import"./QueueProcessor-DFkcFyJt.js";import"./ReactiveMap-C-O0lKvJ.js";import"./Scheduler-DaHJO6l7.js";import"./debugFlags-BbJIqrPU.js";import"./RenderState-DaVlEYWY.js";import"./traversalUtils-DmE6QkgJ.js";import"./ElevationQuery-CP-aI38G.js";import"./ElevationSamplerData-CC_B5wrl.js";import"./TileKey-DZd6gJy7.js";import"./GraphicsLayer-CapLCpoe.js";import"./GraphicsCollection-CKieR40M.js";import"./screenUtils-BuM_Fswi.js";import"./SketchViewModel-DKgcTZ3K.js";import"./layerUtils-BS1Di3Pm.js";import"./angularMeasurementUtils-CATp35qy.js";import"./geometry2dUtils-DoOkpuKA.js";import"./SketchLabelOptions-BnZB654u.js";import"./SnappingManager-DUlqpdAB.js";import"./UpdatingHandles-ugzlsvZF.js";import"./floorFilterUtils-DZ5C6FQv.js";import"./layerViewUtils-Bi2wmOiN.js";import"./viewUtils-DC86MEAQ.js";import"./geometryEngine-MBwx6Ib1.js";import"./geometryEngineBase-Cz__5BKm.js";import"./_commonjsHelpers-DCkdB7M8.js";import"./hydrated-7yclY7Co.js";import"./projectVectorToWGS84ComparableLonLat-DuPw0-Mv.js";import"./geodesicMeasurementUtils-BcTpN3Xi.js";import"./hitTestSelectUtils-UXJPjatw.js";import"./UnitSelect-vwLT4dGV.js";import"./globalCss-DfZw-NIf.js";import"./DefaultTheme-C36xo9Pn.js";import"./ColorSet-BGyxnBw-.js";import"./Tick-BtgDXOa9.js";import"./Button-BRMSdI9E.js";function fi(i,e,o=10){const t=X(e-i,!1);if(t===0)return[i,e];const n=X(t/(o-1),!0);return[Math.floor(i/n)*n,Math.ceil(e/n)*n]}function X(i,e){const o=Math.floor(Math.log10(i)),t=i/10**o;let n;return n=e?t<1.5?1:t<3?2:t<5?2.5:t<7?5:10:t<=1?1:t<=2?2:t<=3?2.5:t<=5?5:10,n*10**o}const A="#f8f8f8",G="#a9a9a9",g="#323232",xi="line",gi="fill",h=15,x=12,Y=.001,hi=.1,Ai=.02,I={fontFamily:"Avenir Next",paddingBottom:x/2,paddingLeft:0,paddingRight:0,paddingTop:0,axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:G,axisTooltipFontSize:12,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,axisTooltipPaddingTop:Math.round(x/4),axisTooltipPaddingBottom:Math.round(x/4),axisTooltipPaddingHorizontal:Math.round(h/4),xAxisMinGridDistance:50,xAxisLabelsSpacing:Math.round(x/2),xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:Math.round(h/4),yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:A,seriesTooltipLabelColor:g,seriesFillLighten:.9,seriesTooltipSpacing:x/2,seriesTooltipPaddingVertical:Math.round(h/4),seriesTooltipPaddingHorizontal:Math.round(h/4)},vi={...I,axisGridStroke:g,axisLabelsColor:G,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,seriesTooltipBackgroundColor:g,seriesTooltipLabelColor:A,seriesFillLighten:-.75},y={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};async function Ao(i){const e=await ei(i.container);K(i.abortOptions);const o=ai(),t=o?vi:I;e.setThemes(o?[F.new(e),_.new(e)]:[F.new(e)]);const n=W(i.container),a=e.container.children.push(ri.new(e,{panX:!0,panY:!0,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,paddingLeft:n?t.paddingRight:t.paddingLeft,paddingRight:n?t.paddingLeft:t.paddingRight,maxTooltipDistance:0}));a.zoomOutButton.set("forceHidden",!0);const r=a.xAxes.push(z.new(e,{renderer:si.new(e,{})})),s=a.yAxes.push(z.new(e,{renderer:li.new(e,{})})),m=P(null),l=P("loading"),p={params:i,chart:a,xAxis:r,yAxis:s,seriesInfos:new Map,messages:null,theme:t,pointerIsOver:!1,get state(){return l.value},get data(){return m.value},set data(d){m.value=d}};yi(p),Ti(p),bi(p);const c=R([Ci(p,i.onRangeChange),ki(p,i.onCursorPositionChange),L(e.events.once("frameended",()=>{l.value="ready"})),L(e)]);return{destroy:()=>{c.remove(),l.value="destroyed"},update:d=>{d.data===p.data&&d.messages===p.messages||M(p)||Li(p,d)},zoomOut:()=>V(p)}}function M(i){return i.state==="destroyed"}function bi({chart:i,xAxis:e,yAxis:o}){const t=pi.new(i.root,{behavior:"none",xAxis:e,yAxis:o});t.lineY.set("visible",!1),i.set("cursor",t)}function yi(i){var r;const{chart:e,xAxis:o,theme:t}=i;o.setAll({extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:U(i,"distance"),strictMinMax:!0,strictMinMaxSelection:!0}),o.axisHeader.set("forceHidden",!0);const n=o.get("renderer");n.setAll({inside:!1,minGridDistance:t.xAxisMinGridDistance}),n.labels.template.setAll({centerX:b,centerY:b,fill:u(t.axisLabelsColor),fontFamily:t.fontFamily,fontSize:t.axisLabelsFontSize,fontWeight:t.axisLabelsFontWeight,maxPosition:t.xAxisMaxLabelPosition,minPosition:t.xAxisMinLabelPosition,paddingLeft:0,paddingRight:0,paddingTop:t.xAxisLabelsSpacing});const a=o.set("tooltip",E.new(e.root,{paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0}));(r=a.get("background"))==null||r.setAll({fill:u(t.axisTooltipBackgroundColor),stroke:void 0}),a.label.setAll({fill:u(t.axisTooltipLabelColor),fontFamily:t.fontFamily,fontSize:t.axisTooltipFontSize,paddingBottom:t.axisTooltipPaddingBottom,paddingLeft:t.axisTooltipPaddingHorizontal,paddingRight:t.axisTooltipPaddingHorizontal,paddingTop:t.axisTooltipPaddingTop}),n.grid.template.setAll({strokeOpacity:1,stroke:u(t.axisGridStroke)})}function Ti(i){const{yAxis:e,theme:o}=i;e.setAll({baseValue:v().noDataValue,extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:U(i,"elevation"),strictMinMax:!0,strictMinMaxSelection:!0,tooltip:void 0}),e.axisHeader.set("visible",!1);const t=W(i.params.container),n=e.get("renderer");n.setAll({minGridDistance:o.yAxisMinGridDistance,opposite:t,inside:!0}),n.labels.template.setAll({centerX:b,centerY:di,fill:u(o.axisLabelsColor),fontFamily:o.fontFamily,fontSize:o.axisLabelsFontSize,fontWeight:o.axisLabelsFontWeight,maxPosition:o.yAxisMaxLabelPosition,minPosition:o.yAxisMinLabelPosition,paddingBottom:0,paddingLeft:t?0:o.yAxisLabelSpacing,paddingRight:t?o.yAxisLabelSpacing:0,paddingTop:0,textAlign:"start"}),n.grid.template.setAll({strokeOpacity:1,stroke:u(o.axisGridStroke)})}function Li(i,e){var s;if(M(i))return;const o=i.data??void 0,t=e.data??void 0;(s=i.chart.get("cursor"))==null||s.set("forceHidden",!(t!=null&&t.refined));const n=o!==t,a=(o==null?void 0:o.effectiveUnits)!==(t==null?void 0:t.effectiveUnits),r=(o==null?void 0:o.uniformScaling)!==(t==null?void 0:t.uniformScaling);i.data=t,i.messages=e.messages,(n||a)&&(Mi(i),Pi(i)),r&&V(i),T(i)}function V(i){M(i)||(i.xAxis.zoom(0,1),i.yAxis.zoom(0,1))}function Mi(i){const{chart:e,data:o,xAxis:t,yAxis:n}=i,{minX:a,maxX:r,minY:s,maxY:m}=Si({data:o,pixelWidth:t.width(),pixelHeight:n.height()}),l=!!(o!=null&&o.uniformScaling),p=!!(o!=null&&o.refined);e.setAll({panX:!0,panY:l,pinchZoomX:p,pinchZoomY:p&&l,wheelX:"panX",wheelY:p?l?"zoomXY":"zoomX":"none"}),t.setAll({max:r,min:a,panX:!0,panY:!1,zoomX:!0,zoomY:l}),n.setAll({max:m,min:s,panX:!1,panY:l,zoomX:l,zoomY:l})}function Si({data:i,pixelWidth:e,pixelHeight:o}){if(i==null)return y;const t=i.statistics,n=0,a=t==null?void 0:t.maxDistance;let r=t==null?void 0:t.minElevation,s=t==null?void 0:t.maxElevation;if(a==null||r==null||s==null)return y;const m=Math.max(a-n,Y);let l=Math.max(s-r,Y);const p=i.effectiveUnits;if(i.dynamicElevationRange){const c=D(m,p.distance,p.elevation);l=Math.max(l,c/v().maxChartRatio)}return r-=Ai*l,s=r+l+hi*l,[r,s]=fi(r,s,10),l=s-r,i.uniformScaling?Fi({data:i,bounds:{minX:n,maxX:a,minY:r,maxY:s},pixelWidth:e,pixelHeight:o,centered:!0}):{minX:n,maxX:n+m,minY:r,maxY:r+l}}function Fi({data:i,bounds:e,pixelWidth:o,pixelHeight:t,centered:n}){if(i==null)return e;let{minX:a,maxX:r,minY:s,maxY:m}=e;if(a==null||r==null||s==null||m==null)return y;const l=r-a,p=m-s,c=i.effectiveUnits,d=D(p,c.elevation,c.distance)/t/(l/o);return d>=1?[a,r]=C([a,r],d,n):[s,m]=C([s,m],1/d,n),{minX:a,maxX:r,minY:s,maxY:m}}function C([i,e],o,t){const n=(e-i)*o;if(t){const a=(i+e)/2-n/2;return[a,a+n]}return[i,i+n]}function Pi(i){var l;const{chart:e,data:o,seriesInfos:t,xAxis:n,yAxis:a}=i;if(o==null||o.lines.length===0)return void e.series.clear();const r=new Map,s=new Set(e.series.values),m=o.lines.length;for(let p=0;p<m;p++){const c=o.lines[p];let d=t.get(c.id);d?(d.fill&&s.delete(d.fill),s.delete(d.line)):(d=Xi(i,c),d.fill&&e.series.push(d.fill),e.series.push(d.line)),r.set(d.id,d);const f=m-p-1;(l=d.fill)==null||l.set("layer",f),d.line.set("layer",m+f),zi(i,d,c)}i.seriesInfos=r;for(const p of s)e.series.removeValue(p);n.set("layer",m+1),a.set("layer",m+2)}function zi({theme:i},e,o){const t=u(o.color.toCss()),n=o.samples??[],a=n.length>0,{line:r,fill:s}=e;r.set("visible",a),r.set("stroke",t),s==null||s.set("visible",a),s==null||s.set("fill",ci.lighten(t,i.seriesFillLighten)),r.data.setAll(n),s==null||s.data.setAll(n)}function Xi(i,e){const{id:o}=e,t=k(i,`${xi}-${o}`);t.setAll({dy:e.chartStrokeOffsetY,tooltip:Yi(i)}),t.strokes.template.setAll({strokeWidth:e.chartStrokeWidth});let n=null;return e.chartFillEnabled&&(n=k(i,`${gi}-${o}`),n.fills.template.setAll({fillOpacity:1,visible:!0})),{id:o,line:t,fill:n}}function k(i,e){return mi.new(i.chart.root,{connect:!1,excludeFromTotal:!0,fill:void 0,id:e,stroke:void 0,valueXField:"distance",valueYField:"elevation",xAxis:i.xAxis,yAxis:i.yAxis})}function Yi({theme:i,chart:e}){var a;const o=E.new(e.root,{autoTextColor:!1,forceHidden:!0,getFillFromSprite:!1,getLabelFillFromSprite:!1,pointerOrientation:"vertical",visible:!1}),t=i.seriesTooltipPaddingHorizontal,n=i.seriesTooltipPaddingVertical;return o.label.setAll({fill:u(i.seriesTooltipLabelColor),fontFamily:i.fontFamily,fontSize:i.seriesTooltipFontSize,paddingBottom:n,paddingLeft:t,paddingRight:t,paddingTop:n,textAlign:"start"}),(a=o.get("background"))==null||a.setAll({stroke:void 0,fill:u(i.seriesTooltipBackgroundColor)}),o.adapters.add("dy",r=>{var l;const s=i.seriesTooltipSpacing,m=((l=o.get("pointTo"))==null?void 0:l.y)??0;return(r??0)+(o.y()>m?s:-s)}),o}function Ci(i,e){const{xAxis:o,yAxis:t}=i,n=()=>{e(w(o),w(t))},a=r=>[r.on("start",n),r.on("end",n)];return Z([...a(o),...a(t)])}function w(i){const e=Math.abs((i.get("end")??0)-(i.get("start")??0)),o=e!==0?1/e:1;return Math.abs(1-o)<Q()?1:o}function ki(i,e){const{chart:o,xAxis:t,yAxis:n}=i,a=o.get("cursor"),r=o.plotContainer.events,s=l=>{i.pointerIsOver=l,T(i)},m=()=>{s(!1),e(null,null)};return Z([a==null?void 0:a.events.on("cursormoved",()=>{if(!i.pointerIsOver)return;T(i);let l=(a==null?void 0:a.getPrivate("positionX"))??0,p=(a==null?void 0:a.getPrivate("positionY"))??0;const c=i.data;if((c==null?void 0:c.statistics)!=null){const{maxDistance:d,minElevation:f,maxElevation:S}=c.statistics;d!=null&&(l=H(l,$(t),B(t),0,d)),f!=null&&S!=null&&(p=H(p,$(n),B(n),f,S))}e(l,p)}),r.on("pointerover",()=>s(!0)),r.on("pointerout",m),r.on("blur",m)])}function H(i,e,o,t,n){return(e+i*(o-e)-t)/(n-t)}function T(i){const e=wi(i);if(!e)return void i.seriesInfos.forEach(o=>{var t;(t=o.line.get("tooltip"))==null||t.set("forceHidden",!0)});i.seriesInfos.forEach(o=>{const t=o.line.get("tooltip");t.set("forceHidden",!1),t.label.set("text",e)}),i.xAxis.getTooltip().setAll({tooltipText:Bi(i)})}function wi(i){const{data:e}=i,o=e==null?void 0:e.lines.map(t=>{var n;return{line:t,y:(n=j(i,t))==null?void 0:n.elevation}}).sort(Hi);return o&&o.length!==0&&o[0].y!=null?o.map(({y:t,line:n})=>$i(i,n,t)).join(`
`):null}function Hi({y:i},{y:e}){return i==null?1:e==null?-1:e-i}function $i(i,e,o){const{data:t,messages:n}=i;if(t==null||n==null)return"";const a=v().formatPrecision,r=ui(n.chartTooltip,{name:ti(e,n),elevation:o!=null?O(n,o,t.effectiveUnits.elevation,a):oi});return`[${e.color.toHex()}]●[/] ${r}`}function Bi(i){const{data:e,messages:o}=i;if(e==null||o==null)return"";const t=e.lines[0],n=t?j(i,t):null,a=v().formatPrecision;return n!=null?O(o,n.distance,e.effectiveUnits.distance,a):"-"}function U(i,e){const o=ni.new(i.chart.root,{});return o.format=(t,n,a)=>{const{data:r,messages:s}=i;return s==null||r==null||typeof t=="string"?"":`${N(t,{maximumFractionDigits:a})} ${ii(s,r.effectiveUnits[e],"abbr")}`},o}function j({chart:i,xAxis:e},o){const t=o.samples??[];if(t.length===0)return null;const n=i.get("cursor"),a=(n==null?void 0:n.getPrivate("positionX"))??0,r=e.toAxisPosition(a),s=e.positionToValue(r);return q(t,s,m=>m.distance)}function $(i){return i.positionToValue(i.get("start")??0)}function B(i){return i.positionToValue(i.get("end")??1)}function Z(i){return R(i.map(L))}function L(i){return J(()=>{i==null||i.dispose()})}export{Ao as createChart,Si as getAdjustedBounds};
