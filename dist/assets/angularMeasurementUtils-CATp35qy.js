import{ci as W,dA as G,o as m,y,X as ae,d1 as lt,bg as ue,fo as L,fm as ce,bW as l,eY as Oe,bZ as tt,dg as H,ff as x,cf as w,ft as b,cj as kt,dm as zt,cg as ht,hL as Tt,q as Ie,a as Fe,dC as Mt,dB as De,c5 as Ve,c8 as Ce,bX as We,n9 as Ze,bR as Be,fy as Ge,co as Ye,fQ as Je,cr as Ue,ej as Xe,W as Ke,e_ as Qe,ni as tn,lz as en,kb as nn,dS as qt,a1 as rn}from"./index-8ERthB3p.js";import{e as J,p as pt,j as yt,d as ut,B as sn,_ as on,q as an,o as le,b as he,E as un,L as cn}from"./vec2-Dt9Foiri.js";import{n as Z,r as ct,a as ln,_ as hn}from"./vec2f64-Diu2Kaa8.js";import{b as ft,j as Ht,z as Ot,A as Rt}from"./geodesicUtils-D1kRRrco.js";import{E as M,D as pn,j as Lt,R as Pt,w as pe,V as fn,F as fe,J as de,b as dn}from"./plane-Du3EYICn.js";import{D as gn,T as mn,E as yn,W as Ln,Z as $n}from"./sphere-Bf4ezJdT.js";import{p as ge}from"./mathUtils-iSLnUy_4.js";import{j as N,d as vn}from"./geometry2dUtils-DoOkpuKA.js";import{e as $t,n as dt}from"./projectVectorToVector-C3SBBDgz.js";import{_ as bn}from"./screenUtils-BuM_Fswi.js";import{g as Nn,w as me,h as En}from"./elevationInfoUtils-sHEwmo9N.js";import{s as wn,i as xn}from"./Cyclical-BY9qISY1.js";import{l as Q,y as ye}from"./quantityUtils-9zDVxeky.js";function An(e,t,n){return W(e,t,n)}function Pr(e){return e}function Sr(e){return e}function U(e,t,n){return W(e,t,n)}function X(e){return G(e)}function Ut(e,t,{coordinateHelper:n,elevationInfo:r}){return e?Tn(n.vectorToDehydratedPoint(e,Mn),t,r):null}function Tn(e,t,n){if(e==null)return null;if(t==null)return W(e.x,e.y,e.z??0);if(t.type==="2d")return W(e.x,e.y,0);const r=Nn(t,e,n,me)??0;return W(e.x,e.y,r)}function jr(e,t){return $t(e[0],e[1],e[2],t)}function _r(e,t,{z:n,m:r},s){const{spatialReference:i,elevationInfo:a}=s;let o;n==null&&r==null?o=void 0:t==null||t.type==="2d"?o=n??void 0:o=En(t,e,i,me,a)??0;const u=$t(e[0],e[1],o,i);return r!=null&&(u.m=r,u.hasM=!0),u}const Mn=$t(0,0,0,null);let S=class extends ue{constructor(){super(...arguments),this.enabled=!0}};m([y({type:Boolean})],S.prototype,"enabled",void 0),S=m([ae("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],S);let g=class extends ue{constructor(e){super(e),this.lineSnapper=new S,this.parallelLineSnapper=new S,this.rightAngleSnapper=new S,this.rightAngleTriangleSnapper=new S,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new lt([255,127,0]),this.orangeTransparent=new lt([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};m([y({type:S,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"lineSnapper",void 0),m([y({type:S,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"parallelLineSnapper",void 0),m([y({type:S,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"rightAngleSnapper",void 0),m([y({type:S,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"rightAngleTriangleSnapper",void 0),m([y({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],g.prototype,"shortLineThreshold",void 0),m([y({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],g.prototype,"distance",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"pointThreshold",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"intersectionParallelLineThreshold",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"parallelLineThreshold",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],g.prototype,"verticalLineThresholdMeters",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"touchSensitivityMultiplier",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"pointOnLineThreshold",void 0),m([y({type:lt,nonNullable:!0})],g.prototype,"orange",void 0),m([y({type:lt,nonNullable:!0})],g.prototype,"orangeTransparent",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"lineHintWidthReference",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"lineHintWidthTarget",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],g.prototype,"lineHintFadedExtensions",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"parallelLineHintWidth",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],g.prototype,"parallelLineHintLength",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],g.prototype,"parallelLineHintOffset",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],g.prototype,"rightAngleHintSize",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],g.prototype,"rightAngleHintOutlineSize",void 0),m([y({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],g.prototype,"satisfiesConstraintScreenThreshold",void 0),g=m([ae("esri.views.interactive.snapping.Settings.Defaults")],g);const zr=new g;var K;(function(e){e[e.FEATURE=1]="FEATURE",e[e.SELF=2]="SELF",e[e.ALL=3]="ALL"})(K||(K={}));let vt=class{constructor(t,n){this.isDraped=t,this.domain=n}};class Le extends vt{constructor(t,n,r=K.ALL){super(n,r),this.intersectionPoint=t}equals(t){return t instanceof Le&&L(this.intersectionPoint,t.intersectionPoint)}}let Hr=class $e extends vt{constructor(t,n,r,s,i=K.ALL,a=!0,o=!0){super(s,i),this.type=t,this.lineStart=n,this.lineEnd=r,this.fadeLeft=a,this.fadeRight=o}equals(t){return t instanceof $e&&this.type===t.type&&L(this.lineStart,t.lineStart)&&L(this.lineEnd,t.lineEnd)&&this.fadeLeft===t.fadeLeft&&this.fadeRight===t.fadeRight}get length(){return ce(this.lineStart,this.lineEnd)}},Or=class ve extends vt{constructor(t,n,r,s=K.ALL){super(r,s),this.lineStart=t,this.lineEnd=n}equals(t){return t instanceof ve&&L(this.lineStart,t.lineStart)&&L(this.lineEnd,t.lineEnd)}};class be extends vt{constructor(t,n,r,s,i=K.ALL){super(s,i),this.previousVertex=t,this.centerVertex=n,this.nextVertex=r}equals(t){return t instanceof be&&L(this.previousVertex,t.previousVertex)&&L(this.centerVertex,t.centerVertex)&&L(this.nextVertex,t.nextVertex)}}const Ir={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "},Xt={toggle:"Control"},Fr={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"};function It({start:e,end:t,type:n},r,s){const i=[],a=J(et,t,e),o=J(bt,e,r),u=pt(a),c=2*yt(a,o),p=c*c-4*u*(pt(o)-s*s);if(p===0){const h=-c/(2*u);(n===A.PLANE||h>=0)&&i.push(ut(Z(),e,a,h))}else if(p>0){const h=Math.sqrt(p),$=(-c+h)/(2*u);(n===A.PLANE||$>=0)&&i.push(ut(Z(),e,a,$));const f=(-c-h)/(2*u);(n===A.PLANE||f>=0)&&i.push(ut(Z(),e,a,f))}return i}function Ne(e,t){const n=e.start,r=e.end,s=J(et,r,n),i=H(Et,-s[1],s[0],0),a=t.start,o=t.end,u=x(Dt,o,a),c=w(u,i),p=H(Pe,n[0],n[1],0),h=x(Se,p,a),$=w(h,i),f=tt();if(Math.abs(c)<f)return[];const v=b(je,a,u,$/c);if(t.type===N.RAY){const E=x(St,v,a);if(w(E,u)<-f)return[]}if(e.type===A.HALF_PLANE){const E=sn(bt,v,n);if(yt(E,s)<-f)return[]}return[G(v)]}function Rn(e,t){return Sn(gt(Vt,t[2],e),t)}function Ee(e,t){return Me(gt(Vt,0,e),gt(zn,0,t)).map(([r,s])=>ct(r,s))}function we(e,t){return Ae(e,gt(Vt,e[2],t))}function xe(e,t,n){const r=J(et,e,t),s=an(r),i=s===0?1:n/s,a=l();return ut(a,t,r,i),a[2]=e[2],a}function Ae(e,{start:t,end:n,type:r},s=l()){const i=x(Nt,e,t),a=x(Et,n,t),o=w(i,a)/w(a,a);return b(s,t,a,r===N.RAY?Math.max(o,0):o)}const Pn=(()=>{const e=l(),t=l(),n=l();return({start:r,end:s},{center:i,radius:a,normal:o,slicePlane:u})=>{const c=Lt(i,o,kn);if(d(Pt(c,r),0)&&d(Pt(c,s),0)){ge(o,e,t);const h=(v,E)=>(zt(n,E,i),le(v,w(n,e),w(n,t)),v),$=vn({start:h(et,r),end:h(bt,s),type:N.LINE},ln,a),f=[];for(const[v,E]of $){const T=kt(l(),i);b(T,T,e,v),b(T,T,t,E),u&&!B(u,T)||f.push(T)}return f}const p=l();return pe(c,r,s,p)?!d(ce(p,i),a)||u&&!B(u,p)?[]:[p]:[]}})();function Te({start:e,end:t,type:n},r,s){const i=[],a=zt(Nt,t,e),o=J(bt,e,r),u=pt(a),c=2*yt(a,o),p=c*c-4*u*(pt(o)-s*s);if(p===0){const h=-c/(2*u);(n===N.LINE||h>=0)&&i.push(b(l(),e,a,h))}else if(p>0){const h=Math.sqrt(p),$=(-c+h)/(2*u);(n===N.LINE||$>=0)&&i.push(b(l(),e,a,$));const f=(-c-h)/(2*u);(n===N.LINE||f>=0)&&i.push(b(l(),e,a,f))}return i}function Me(e,t){const n=e.start,r=e.end,s=t.start,i=t.end,a=x(Nt,r,n),o=x(Et,i,s),u=x(Dt,s,n),c=ht(Pe,a,o);if(!d(w(u,c),0))return[];const p=Tt(c);if(d(p,0))return[];const h=ht(Se,u,o),$=w(h,c)/p,f=b(je,n,a,$);if(e.type===N.RAY){const v=x(St,f,n);if(w(a,v)<-tt())return[]}if(t.type===N.RAY){const v=x(St,f,s);if(w(o,v)<-tt())return[]}return[G(f)]}function Sn({start:e,end:t,type:n},r){const s=x(Nt,r,e),i=x(Et,t,e),a=ht(Dt,i,s),o=Tt(a)/Tt(i),u=tt();if(o<u)switch(n){case N.LINE:return[G(r)];case N.RAY:return w(i,s)<-u?[]:[G(r)]}return[]}function Ft(e,t,n,r){const[s,i]=e,[a,o]=n,u=a-s,c=o-i,p=u*u+c*c,h=Math.sqrt(p);if(h>t+r)return[];if(h<Math.abs(t-r))return[];if(d(h,0)&&d(t,r))return[];const $=(t*t-r*r+p)/(2*h),f=Math.sqrt(t*t-$*$),v=f*c/h,E=f*u/h,[T,Y]=on(et,e,n,$/h);return d(v,E)?[ct(T,Y)]:[ct(T+v,Y-E),ct(T-v,Y+E)]}function gt(e,t,{start:n,end:r,type:s}){return H(e.start,n[0],n[1],t),H(e.end,r[0],r[1],t),e.type=_n[s],e}function Re(e,t){return d(e[2],t[2])}function d(e,t){return Oe(Math.abs(e-t),0,tt())}function jn(e,t){return t.filter(n=>B(e,n))}function B(e,t){return pn(e,t)}var A;(function(e){e[e.PLANE=0]="PLANE",e[e.HALF_PLANE=1]="HALF_PLANE"})(A||(A={}));const _n={[A.PLANE]:N.LINE,[A.HALF_PLANE]:N.RAY},et=Z(),bt=Z(),Nt=l(),Et=l(),Dt=l(),Pe=l(),Se=l(),je=l(),St=l(),kn=M(),Vt={start:l(),end:l(),type:N.LINE},zn={start:l(),end:l(),type:N.LINE};class _{intersect(t){return O(this,t)}closestPoints(t){return[this.closestTo(t)]}}class nt extends _{constructor(t){super(),this.point=t}equals(t){return this===t||R(t)&&L(this.point,t.point)}closestTo(){return X(this.point)}}class Ct extends _{constructor(t,n,r){super(),this.start=t,this.end=n,this.lineLike={start:t,end:n,type:r}}equals(t){return this===t||k(t)&&this.lineLike.type===t.lineLike.type&&L(this.start,t.start)&&L(this.end,t.end)}closestTo(t){const n=Ae(t,this.lineLike);return n}}class _e extends Ct{constructor(t,n){super(t,n,N.LINE)}}class qn extends Ct{constructor(t,n){super(t,n,N.RAY)}}class ke extends _{constructor(t){super(),this.constraints=t}equals(t){return this===t||jt(t)&&Fe(this.constraints,t.constraints,(n,r)=>n.equals(r))}closestTo(t){let n,r=1/0;for(const s of this.constraints){const i=s.closestTo(t),a=Mt(t,i);a<r&&(r=a,n=i)}return n?X(n):t}closestPoints(t){return this.constraints.flatMap(n=>n===this?[]:n.closestPoints(t))}}class Hn extends _{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||q(t)&&this.center[0]===t.center[0]&&this.center[1]===t.center[1]&&this.radius===t.radius}closestTo(t){const n=xe(t,this.center,this.radius);return n}}class Wt extends _{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||F(t)&&L(this.center,t.center)&&this.radius===t.radius}closestTo(t){const n=xe(t,this.center,this.radius);return n[2]=this.center[2],n}asCircle(){return new Zt(X(this.center),this.radius,U(0,0,1))}}class Zt extends _{constructor(t,n,r,s=void 0){super(),this.center=t,this.radius=n,this.normal=r,this.slicePlane=s}equals(t){return this===t||C(t)&&L(this.center,t.center)&&L(this.normal,t.normal)&&this.radius===t.radius}closestTo(t){const{center:n,radius:r}=this;de(this.getPlane(On),t,xt);const s=x(xt,xt,n),i=De(s);if(d(i,0))return X(t);const a=r/Math.sqrt(i),o=b(l(),n,s,a),{slicePlane:u}=this;if(u&&!B(u,o)){const c=Gt(u,this);return(c==null?void 0:c.closestTo(t))??X(t)}return o}getPlane(t=M()){return Lt(this.center,this.normal,t)}}const xt=l(),On=M();class In extends _{constructor(t){super(),this.z=t}equals(t){return this===t||I(t)&&this.z===t.z}closestTo(t){return W(t[0],t[1],this.z)}getPlane(t=M()){return H(Kt,0,0,this.z),Lt(Kt,Ye,t)}}const Kt=l();class Bt extends _{constructor(t,n,r){super(),this.start=t,this.end=n,this.planeLike={start:t,end:n,type:r}}equals(t){return this===t||z(t)&&this.planeLike.type===t.planeLike.type&&L(this.start,t.start)&&L(this.end,t.end)}closestTo(t){return we(t,this.planeLike)}closestEndTo(t){const{start:n,end:r}=this.planeLike;return Math.sign(yt(J(Fn,r,n),J(Dn,t,n)))>0?this.end:this.start}getPlane(t=M()){const n=kt(Qt,this.end);return n[2]+=1,dn(this.start,this.end,n,t)}getSlicePlane(t=M()){const{start:n,end:r,type:s}=this.planeLike;if(s===A.PLANE)return;const i=H(Qt,n[0],n[1],0),a=H(te,r[0],r[1],0),o=zt(te,a,i);return Lt(i,o,t),t}}const Fn=Z(),Dn=Z(),Qt=l(),te=l();class Dr extends Bt{constructor(t,n){super(t,n,A.HALF_PLANE)}}class Vr extends Bt{constructor(t,n){super(t,n,A.PLANE)}}class Vn extends _{constructor(t,n){super(),this.sphere=mn(t,n)}equals(t){return this===t||D(t)&&yn(this.sphere,t.sphere)}closestTo(t){const n=Ln(this.sphere,t,l());return n}get center(){return $n(this.sphere)}get radius(){return this.sphere[3]}}class Cn extends _{constructor(t,n,r){super(),this.start=t,this.end=n,this.getZ=r,this.planeLike={start:t,end:n,type:A.PLANE}}equals(t){return this===t||mt(t)&&L(this.start,t.start)&&L(this.end,t.end)&&this.getZ===t.getZ}closestTo(t){return Yn(this,t)}addIfOnTheGround(t,n){for(const r of n){const s=this.getZ(r[0],r[1])??0;d(r[2],s)&&(r[2]=s,t.push(r))}}}class Wn extends _{constructor(t,n,r,s,i){super(),this._origin=t,this._spatialReference=n,this._distanceMeters=r,this._elevationMeters=s,this._directionDegrees=i}equals(t){return this===t||cr(t)&&un(this._origin,t._origin)&&this._distanceMeters===t._distanceMeters&&this._elevationMeters===t._elevationMeters&&this._directionDegrees===t._directionDegrees}closestTo([t,n,r]){if(le(V,t,n),this._directionDegrees!=null&&this._distanceMeters!=null)ft(V,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)Bn(V,this._origin,this._directionDegrees,V,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:s}=Ht(Zn,this._origin,V,this._spatialReference);ft(V,this._origin,s??0,this._distanceMeters,this._spatialReference)}return An(V[0],V[1],this._elevationMeters??r)}}const V=[0,0],Zn=new Ot;function Bn(e,t,n,r,s){let{azimuth:i,distance:a}=Ht(Gn,t,r,s);i??(i=0);let o=a*Math.cos((i-n)*Je);o=Math.max(0,o),ft(e,t,n,o,s)}const Gn=new Ot;function Yn(e,t){const n=we(t,e.planeLike);return n[2]=e.getZ(n[0],n[1])??qe,n}function O(e,t){if(jt(e)){const n=[];for(const r of e.constraints){const s=r.intersect(t);s&&n.push(s)}return Yt(n)}if(jt(t))return O(t,e);if(mt(e))return ee(e,t);if(mt(t))return ee(t,e);if(R(e)){const{point:n}=e;if(R(t))return L(n,t.point)?e:void 0;const r=t.closestTo(n);return Ze(r,n)?e:void 0}if(k(e)){if(R(t))return O(t,e);if(k(t))return j(Me(e.lineLike,t.lineLike));if(I(t))return Jn(e,t);if(z(t))return j(Ne(t.planeLike,e.lineLike));if(q(t))return j(Te(e.lineLike,t.center,t.radius));if(C(t))return j(Pn(e.lineLike,t));if(F(t))return Un(e,t);if(D(t))return Xn(e,t)}else if(I(e)){if(R(t)||k(t))return O(t,e);if(I(t))return Kn(e,t);if(z(t))return Qn(e,t);if(q(t))return tr(e,t);if(C(t))return nr(e,t);if(F(t))return er(e,t);if(D(t))return rr(e,t)}else if(z(e)){if(R(t)||k(t)||I(t))return O(t,e);if(z(t))return At(Ee(e.planeLike,t.planeLike));if(q(t))return At(It(e.planeLike,t.center,t.radius));if(C(t))return ir(e,t);if(F(t))return sr(e,t);if(D(t))return or(e,t)}else if(q(e)){if(R(t)||k(t)||I(t)||z(t))return O(t,e);if(q(t))return At(Ft(e.center,e.radius,t.center,t.radius));if(C(t))return void 0;if(F(t))return ar(e,t);if(D(t))return void 0}else if(C(e)){if(R(t)||k(t)||I(t)||z(t)||q(t))return O(t,e);if(C(t))return void 0;if(F(t))return t.asCircle(),void 0;if(D(t))return void 0}else if(F(e)){if(R(t)||k(t)||I(t)||z(t)||q(t)||C(t))return O(t,e);if(F(t))return ur(t,e);if(D(t))return void 0}else if(D(e)){if(R(t)||k(t)||I(t)||z(t)||q(t)||F(t))return O(t,e);if(D(t))return void 0}}const Jn=(()=>{const e=M();return(t,n)=>{const{start:r,end:s}=t;if(Re(r,s)&&d(r[2],n.z))return t;const i=l();return pe(n.getPlane(e),r,s,i)?new nt(i):void 0}})();function Un({lineLike:e},{center:t,radius:n}){const r=t[2];return j(Te(e,t,n).filter(s=>d(s[2],r)))}function Xn({lineLike:e},{sphere:t}){return j(gn(t,e.start,e.end))}const Gt=(()=>{const e=Be(),t=l(),n=l();return(r,s,i)=>{const{normal:a,center:o,radius:u}=s;ge(a,t,n);const c=fe(r),p=u*w(c,t),h=u*w(c,n);Ve(e,o[0],o[1],o[2],1);const $=Ce(r,e),f=Math.hypot(p,h),v=d(f,0);if(d(Pt(r,o),0)){if(v)return s;if(d(u,0))return!i||B(i,o)?new nt(X(o)):void 0;ht(t,c,a),We(t,t);const wt=new Array,ot=G(o);b(ot,ot,t,u),i&&!B(i,ot)||wt.push(ot);const at=G(o);return b(at,at,t,-u),i&&!B(i,at)||wt.push(at),j(wt)}if(v)return;const E=-$/f;if(Math.abs(E)>1||d(E,1))return;const T=Math.atan(p/h),Y=Ge(E)-T,Jt=Math.PI-Y,rt=new Array,st=l();b(st,o,t,u*Math.cos(Y)),b(st,st,n,u*Math.sin(Y)),rt.push(st);const it=l();return b(it,o,t,u*Math.cos(Jt)),b(it,it,n,u*Math.sin(Jt)),rt.push(it),j(i?jn(i,rt):rt)}})();function Kn(e,t){return d(e.z,t.z)?e:void 0}function Qn({z:e},{planeLike:t}){const[n,r]=t.start,[s,i]=t.end,a=U(n,r,e),o=U(s,i,e);return t.type===A.PLANE?new _e(a,o):new qn(a,o)}function tr(e,t){const[n,r]=t.center;return new Wt(U(n,r,e.z),t.radius)}function er(e,t){return d(t.center[2],e.z)?t:void 0}const nr=(()=>{const e=M();return(t,n)=>Gt(t.getPlane(e),n,n.slicePlane)})();function rr(e,{center:t,radius:n}){const r=Math.abs(t[2]-e.z);if(r>n&&!d(r,n))return;const s=U(t[0],t[1],e.z),i=Math.sqrt(n**2-r**2);return d(i,0)?void 0:new Wt(s,i)}const sr=(()=>{const e=M();return(t,{center:n,radius:r})=>{const s=It(t.planeLike,n,r),i=n[2];t.getSlicePlane(e);const a=new Array;for(const[o,u]of s){const c=[o,u,i];B(e,c)&&a.push(c)}return j(a)}})(),ir=(()=>{const e=M(),t=M();return(n,r)=>Gt(n.getPlane(e),r,n.getSlicePlane(t))})(),or=(()=>{const e=M();return(t,{center:n,radius:r})=>{const s=t.getPlane(e),i=fn(s,n),a=Math.abs(i);if(a>r&&!d(a,r))return;const o=G(fe(s)),u=b(l(),n,o,i),c=Math.sqrt(r**2-i**2);return d(c,0)?new nt(de(s,n,l())):new Zt(u,c,o,t.getSlicePlane())}})();function ar(e,t){const n=he(e.center,t.center);return d(n,0)&&d(e.radius,t.radius)?t:ze(Ft(e.center,e.radius,t.center,t.radius),t.center[2])}function ur(e,t){if(!Re(e.center,t.center))return;const n=he(e.center,t.center);return d(n,0)&&d(e.radius,t.radius)?e:ze(Ft(e.center,e.radius,t.center,t.radius),e.center[2])}function ee(e,t){const{planeLike:n,getZ:r}=e,s=new Array;if(R(t))e.addIfOnTheGround(s,Rn(n,t.point));else if(k(t))e.addIfOnTheGround(s,Ne(n,t.lineLike));else if(q(t))for(const[i,a]of It(n,t.center,t.radius)){const o=r(i,a);o!=null&&s.push(W(i,a,o))}else if(z(t)||mt(t))for(const[i,a]of Ee(n,t.planeLike)){const o=r(i,a)??qe;s.push(W(i,a,o))}return j(s)}function At(e){return Yt(e.map(([t,n])=>{const r=U(t,n,0),s=U(t,n,1);return new _e(r,s)}))}function j(e){return Yt(e.map(t=>t?new nt(t):void 0))}function ze(e,t){return j(e.map(([n,r])=>[n,r,t]))}function Yt(e){if(e.length!==0)return e.length===1?e[0]??void 0:new ke(e.filter(Ie))}function jt(e){return e instanceof ke}function R(e){return e instanceof nt}function k(e){return e instanceof Ct}function I(e){return e instanceof In}function z(e){return e instanceof Bt}function q(e){return e instanceof Hn}function F(e){return e instanceof Wt}function C(e){return e instanceof Zt}function D(e){return e instanceof Vn}function mt(e){return e instanceof Cn}function cr(e){return e instanceof Wn}const qe=0;function lr(e,t){const n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function Cr(e,t){return Math.sqrt(lr(e,t))}function Wr(e,t){t.sort((n,r)=>Mt(n.targetPoint,e)-Mt(r.targetPoint,e))}var ne;function Zr({point:e,distance:t,returnEdge:n,vertexMode:r,coordinateHelper:{spatialReference:s},filter:i},a,o){return o=o!=null?o.clone():new Ke({where:"1=1"}),i&&(o.geometry=i.geometry,o.distance=i.distance,o.spatialRelationship=i.spatialRelationship,o.where=Qe(o.where,i.where),o.timeExtent=tn(o.timeExtent,i.timeExtent),o.objectIds=hr(o.objectIds,i.objectIds)),{point:$t(e[0],e[1],e[2],s.toJSON()),mode:a,distance:t,returnEdge:n,vertexMode:r,query:o.toJSON()}}function hr(e,t){return e||t?t?e?Array.from(en(new Set(e),new Set(t))):t:e:null}function Br(e,t,n){return{left:Ut(e.leftVertex.pos,t,n),right:Ut(e.rightVertex.pos,t,n)}}function Gr(e){return e.createQuery()}(function(e){e[e.TARGET=0]="TARGET",e[e.REFERENCE=1]="REFERENCE",e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(ne||(ne={}));const re=Symbol("snapping-toggle");function Yr(e,t=()=>{}){const n=Ue(()=>({view:e.view,snappingOptions:e.snappingOptions}),({view:r,snappingOptions:s})=>{if(e.removeHandles(re),!r||!s)return;const i=bn.TOOL,a=[r.on("key-down",o=>{o.key!==Xt.toggle||o.repeat||(s.enabledToggled=!0,t())},i),r.on("key-up",o=>{o.key===Xt.toggle&&(s.enabledToggled=!1,t())},i),r.on("pointer-move",o=>{const u=o.native.ctrlKey;s.enabledToggled!==u&&(s.enabledToggled=u,t())},i)];e.addHandles(a,re)},Xe);e.addHandles(n)}function Jr(e){var t;return nn(e)&&"utilityNetworks"in e&&!!((t=e.utilityNetworks)!=null&&t.length)}var P;function pr(e,t){if(e==null||t==null)return;const n=_t(e,t);return n!=null?Q(n,"radians","geographic"):void 0}(function(e){e.Absolute="absolute",e.Relative="relative",e.RelativeBilateral="relative-bilateral"})(P||(P={}));const _t=(()=>{const e=l(),t=l();return(n,r)=>(H(e,n.x,n.y,n.z??0),H(t,r.x,r.y,r.z??0),fr(e,t,n.spatialReference,r.spatialReference))})(),fr=(()=>{const e=Z(),t=l(),n=l();return(r,s,i,a)=>{if(L(r,s))return;const o=Rt(i),u=Rt(a);if(o&&u&&rn(o,u)&&dt(r,i,t,o)&&dt(s,a,n,u)){const{azimuth:p}=Ht(dr,t,n,o);return p!=null?qt(p,"degrees","radians"):void 0}e[0]=s[0]-r[0],e[1]=s[1]-r[1];let c=cn(hn,e);return e[0]<0&&(c=gr-c),c}})();function Ur(e,t,n,r=P.Absolute){if(t&&n)switch(r){case P.Absolute:return pr(t,n);case P.Relative:return ie(se(e,t,n),P.Relative);case P.RelativeBilateral:return ie(se(e,t,n),P.RelativeBilateral)}}function se(e,t,n){if(!e||!t||!n)return;const r=_t(e,t),s=_t(t,n);return r!=null&&s!=null?Q(s-r,"radians","geographic"):void 0}function ie(e,t){if(e==null)return;const n=He(e);switch(t){case P.Absolute:{const r=mr.normalize(n,0,!0);return Q(r,"degrees","geographic")}case P.Relative:{let r=oe.normalize(n,0,!0);return r===-180&&(r=180),Q(r,"degrees","geographic")}case P.RelativeBilateral:{const r=Math.abs(oe.normalize(n,0,!0));return Q(r,"degrees","geographic")}}}const Xr=(()=>{const e=l();return(t,n,r,s,i,a="geodesic")=>{kt(e,n);const o=He(i);if(a==="geodesic"){const f=Rt(r);if(f&&dt(e,r,e,f))return ft(t,e,o,s,f),t[2]=n[2],!!dt(t,f,t,r)}const u=ye(o,"geographic","arithmetic"),c=qt(u,"degrees","radians"),p=n[0]+s*Math.cos(c),h=n[1]+s*Math.sin(c),$=n[2];return H(t,p,h,$),!0}})();function He(e){return e!=null?ye(qt(e.value,e.unit,"degrees"),e.rotationType,"geographic"):void 0}const dr=new Ot,gr=2*Math.PI,mr=wn,oe=new xn(-180,180);export{Xr as A,He as B,Cn as C,Dr as D,ne as E,Ut as F,Cr as G,lr as H,Vr as I,Br as J,fr as K,_e as L,Hn as M,Yr as N,Ae as O,pr as R,In as T,Wn as U,vt as a,U as b,Wr as c,jr as d,Ir as e,Sr as f,K as g,Tn as h,An as i,Gr as j,_r as k,Pr as l,nt as m,Hr as n,Le as o,zr as p,P as q,Or as r,be as s,Yt as t,R as u,Fr as v,ie as w,Ur as x,Zr as y,Jr as z};
