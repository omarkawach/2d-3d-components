import{aA as h,aB as l,aC as s,aF as u,aD as p}from"./index-8ERthB3p.js";import{i as m}from"./index-f6afcedb-CZuD5wYN.js";/*!
 * All material copyright Esri, All Rights Reserved, unless otherwise specified.
 * See https://js.arcgis.com/4.29/esri/copyright.txt for details.
 * v4.29.10
 */const w=class{constructor(i){h(this,i),this.versionItemActionClickedEventWithServiceUrl=l(this,"versionItemActionClickedEventWithServiceUrl",7),this.versionListActionClickedEvent=l(this,"versionListActionClickedEvent",7),this._versionListEventListeners=new Map,this._watchHandles=[],this._versionItemActionClickedEventWithServiceUrl=t=>{this.versionItemActionClickedEventWithServiceUrl.emit(t.detail)},this._versionListActionClickedEvent=t=>{this.versionListActionClickedEvent.emit(t.detail)},this.flowElement=void 0,this.heading=void 0,this.serviceUrl=void 0,this.strings=void 0,this.viewModel=void 0,this.state=void 0}async componentDidLoad(){const{watch:i}=await m();this._watchHandles.push(i(()=>this.viewModel.state,t=>{this.state=t}))}async componentWillLoad(){this.state=this.viewModel.state}disconnectedCallback(){this._watchHandles.forEach(i=>{i.remove()}),this._watchHandles=[],this._removeVersionListEventListeners(this._versionList)}render(){const{flowElement:i,heading:t,serviceUrl:e,strings:o,viewModel:c}=this;let{_versionList:n}=this;const r=c.serviceNameLookup.get(e);return s(u,null,s("calcite-panel",{heading:r},s("calcite-action",{id:`actionManageVersions_${r}`,icon:"list",scale:"s",slot:"header-actions-end",text:"",onClick:async()=>{await c.getVersionInfos(e,!1),n=document.createElement("arcgis-version-management-version-list"),n.addEventListener("calciteFlowItemBack",async()=>{n.remove()}),n.heading=t,n.serviceUrl=e,n.serviceName=r,n.strings=o,n.userHasAdvancedEditingUserTypeExtension=c.advancedEditingUserTypeExtensionLookup.get(e),n.versionInfos=c.versionInfoLookup.get(e),n.viewModel=c,this._addVersionListEventListeners(n),i.append(n)}}),s("calcite-tooltip",{"overlay-positioning":"fixed",referenceElement:`actionManageVersions_${r}`},s("span",null,o.headers.manageVersions))))}_addVersionListEventListeners(i){i.addEventListener("versionItemActionClickedEventWithServiceUrl",this._versionItemActionClickedEventWithServiceUrl),this._versionListEventListeners.set("versionItemActionClickedEventWithServiceUrl",this._versionItemActionClickedEventWithServiceUrl),i.addEventListener("versionListActionClickedEvent",this._versionListActionClickedEvent),this._versionListEventListeners.set("versionListActionClickedEvent",this._versionListActionClickedEvent)}_removeVersionListEventListeners(i){for(const[t,e]of this._versionListEventListeners)i.removeEventListener(t,e)}get _hostElement(){return p(this)}},_=class{constructor(i){h(this,i),this.versionPropertiesSaveClickedEvent=l(this,"versionPropertiesSaveClickedEvent",7),this._watchHandles=[],this.flowElement=void 0,this.serviceUrl=void 0,this.strings=void 0,this.versionInfo=void 0,this.viewModel=void 0,this.executionError=void 0,this.state=void 0}async componentDidLoad(){await this.viewModel.getVersionInfos(this.serviceUrl,!1)}async componentWillLoad(){const{watch:i}=await m();this._watchHandles.push(i(()=>this.viewModel.state,t=>{this.state=t}))}disconnectedCallback(){this._watchHandles.forEach(i=>{i.remove()}),this._watchHandles=[]}render(){var c;const{serviceUrl:i,strings:t,versionInfo:e}=this,{viewModel:{executionError:o}}=this;return s(u,null,s("calcite-flow-item",{description:e?e.versionIdentifier.name:"",heading:e?t.actions.editVersion:t.actions.newVersion},s("calcite-panel",{loading:this.state==="executing"},s("div",{class:"div-content"},s("calcite-label",null,t.input.versionName,s("calcite-input-text",{id:"inputName",maxLength:62,value:e?e.versionIdentifier.name.split(".")[1]:""})),s("calcite-label",null,t.input.versionDescription,s("calcite-text-area",{id:"inputDescription",resize:"vertical",value:e?e.description:""})),s("calcite-label",null,t.input.versionAccess,s("calcite-chip-group",{id:"chipGroupAccessLevel",selectionMode:"single",label:""},s("calcite-chip",{selected:(e==null?void 0:e.access)==="public"||!e,value:"public"},t.accessLevels.public),s("calcite-chip",{selected:(e==null?void 0:e.access)==="protected",value:"protected"},t.accessLevels.protected),s("calcite-chip",{selected:(e==null?void 0:e.access)==="private",value:"private"},t.accessLevels.private))),s("calcite-label",null,t.input.versionOwner,s("calcite-input-text",{id:"inputOwner",disabled:!this.viewModel.advancedEditingUserTypeExtensionLookup.get(i),value:e?e.versionIdentifier.name.split(".")[0]:(c=this.viewModel.userLookup.get(i))==null?void 0:c.toUpperCase()})),s("calcite-button",{appearance:"outline",slot:"footer",width:"half",onClick:()=>{this.flowElement.back()}},t.actions.cancelSave),s("calcite-button",{slot:"footer",width:"half",onClick:async()=>{const n=Array.from(this._hostElement.getElementsByTagName("calcite-input-text")),r=this._hostElement.getElementsByTagName("calcite-text-area")[0],d=n.find(a=>a.id==="inputName"),v=n.find(a=>a.id==="inputOwner"),E={access:Array.from(this._hostElement.getElementsByTagName("calcite-chip-group"))[0].selectedItems[0].value,description:r.value,versionIdentifier:{name:v.value!==""?`${v.value}.${d.value}`:d.value,guid:e?e.versionIdentifier.guid:""}};this.versionPropertiesSaveClickedEvent.emit({serviceUrl:i,versionInfo:E})}},t.actions.saveVersion)),this.state==="failed"?s("calcite-notice",{class:"notice",closable:!0,kind:"warning",open:!0,scale:"s",slot:"footer"},s("div",{slot:"message"},this._getExecutionError(o))):void 0)))}_getExecutionError(i){const{strings:{executionErrors:t}}=this;switch(i){case"no-advanced-editing-user-type-extension":return t.noAdvancedEditingUserTypeExtension;case"no-feature-service-found":return t.noFeatureServiceFound;case"no-valid-enterprise-version":return t.notValidEnterpriseVersion;case"no-valid-version-name":return t.invalidVersionName;default:return i}}get _hostElement(){return p(this)}};export{w as arcgis_version_management_service_item,_ as arcgis_version_management_version_properties};
