function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/calcite-button-BGRBzuhy.js","assets/button-Csva0FHl.js","assets/jsxFactory-BxQYPm-b.js","assets/index-8ERthB3p.js","assets/index-CzRN3C0i.css","assets/form-DjQ2sEGP.js","assets/dom-BvFmd0Ey.js","assets/guid-Cgw_FQNn.js","assets/interactive-juHwuDyB.js","assets/label2-D3Hkhas-.js","assets/component-CiBiWYk6.js","assets/loadable-C9pgOBpc.js","assets/locale-czPJjPyG.js","assets/key-wu7cp3Vu.js","assets/observers-hu61Hn6M.js","assets/t9n-GCZDzKCw.js","assets/icon-DyzVx5Y-.js","assets/loader-DeANvmkY.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{o as i,y as n,Z as m,a7 as C,X as w,bO as $,ak as B,eL as V,cr as y,ej as O,eK as L,fZ as I,cu as T,f_ as S,_ as H}from"./index-8ERthB3p.js";import{e as N,O as k,r as D,n as r,i as x}from"./jsxFactory-BxQYPm-b.js";import{v as b}from"./LineOfSightAnalysis-CWozDaRo.js";import{u as P,f as E}from"./LineOfSightAnalysisTarget-CsA1UFD4.js";import{u as G,g as R,w as Z}from"./elevationInfoUtils-sHEwmo9N.js";import{v as z}from"./AnalysisViewModel-CspzIpG8.js";import{e as f}from"./globalCss-DfZw-NIf.js";import"./Analysis-BVF2oUso.js";import"./persistable-DTlPUvTn.js";import"./multiOriginJSONSupportUtils-C0wm8_Yw.js";import"./resourceExtension-5aSW4bDb.js";let h=class extends ${constructor(t){super(t),this.location=null,this.intersectedLocation=null,this.intersectedGraphic=null,this.visible=void 0}};i([n({type:m})],h.prototype,"location",void 0),i([n({type:m})],h.prototype,"intersectedLocation",void 0),i([n({type:C})],h.prototype,"intersectedGraphic",void 0),i([n({type:Boolean})],h.prototype,"visible",void 0),h=i([w("esri.widgets.lineOfSight.LineOfSightTarget")],h);const A=h,_=B.ofType(A);let c=class extends z{constructor(e){super(e),this.analysis=null,this.supportedViewType="3d",this.unsupportedErrorMessage="LineOfSightViewModel is only supported in 3D views.",this._vmTargetsToConnection=new Map,this._analysisTargetsToConnection=new Map}initialize(){this.addHandles([this.targets.on("after-add",e=>this._onViewModelTargetAdded(e.item)),this.targets.on("after-remove",e=>this._onViewModelTargetRemoved(e.item)),y(()=>this.analysis,e=>this._onAnalysisChange(e),O)])}destroy(){this._analysisTargetsToConnection.forEach(e=>e.remove())}get state(){return this.disabled||!this.ready?"disabled":this.tool==null?"ready":this.tool.state}get observer(){const{observer:e}=this.analysis;return(e==null?void 0:e.position)==null?null:this._convertAnalysisPointToAbsoluteHeight(e.position,e.elevationInfo)}set observer(e){let t=null;e&&(t=e.clone(),t.hasZ||(t.z=0)),this.analysis.observer=new P({position:t})}get targets(){return this._get("targets")||new _}set targets(e){this._set("targets",L(e,this.targets,_))}continue(){this.tool!=null&&this.tool.continue()}stop(){this.tool!=null&&this.tool.stop()}get testInfo(){return{analysisView:this.analysisView,getAnalysisTargetFromViewModelTarget:e=>{var t;return(t=this._vmTargetsToConnection.get(e))==null?void 0:t.analysisTarget}}}constructAnalysis(){return new b}async onConnectToAnalysisView(e){this.addHandles([e.on("result-changed",t=>{const s=this._analysisTargetsToConnection.get(t.target);s&&(t.result!=null?(s.viewModelTarget.intersectedGraphic=t.result.intersectedGraphic,s.viewModelTarget.intersectedLocation=t.result.intersectedLocation,s.viewModelTarget.visible=t.result.visible):(s.viewModelTarget.intersectedGraphic=null,s.viewModelTarget.intersectedLocation=null,s.viewModelTarget.visible=void 0))})],"view")}onDisconnectFromAnalysisView(){this.removeHandles("view")}_onViewModelTargetAdded(e){if(this._vmTargetsToConnection.get(e))return;const t=new E({position:e.location});this._connectViewModelWithAnalysisTarget(e,t),this.analysis.targets.add(t)}_onViewModelTargetRemoved(e){const t=this._vmTargetsToConnection.get(e);t&&(t.remove(),this.analysis.targets.remove(t.analysisTarget))}_onAnalysisTargetAdded(e){if(this._analysisTargetsToConnection.get(e))return;const{position:t}=e,s=new A({location:t?this._convertAnalysisPointToAbsoluteHeight(t,e.elevationInfo):null});this._connectViewModelWithAnalysisTarget(s,e),this.targets.add(s)}_onAnalysisTargetRemoved(e){const t=this._analysisTargetsToConnection.get(e);t&&(t.remove(),this.targets.remove(t.viewModelTarget))}_connectViewModelWithAnalysisTarget(e,t){let s=!1;const g=I([y(()=>({position:t.position,elevationInfo:t.elevationInfo}),({position:d,elevationInfo:u})=>{s||(s=!0,e.location=d?this._convertAnalysisPointToAbsoluteHeight(d,u):null,s=!1)},T),y(()=>e.location,d=>{if(!s){s=!0;let u=null;d&&(u=d.clone(),u.hasZ||(u.z=0)),t.position=u,t.elevationInfo=null,s=!1}},T)]),p={analysisTarget:t,viewModelTarget:e,remove:()=>{g.remove(),this._vmTargetsToConnection.delete(e),this._analysisTargetsToConnection.delete(t)}};this._vmTargetsToConnection.set(e,p),this._analysisTargetsToConnection.set(t,p)}_onAnalysisChange(e){const t="analysis";this.removeHandles(t),this.addHandles([this.analysis.targets.on("after-add",s=>this._onAnalysisTargetAdded(s.item)),this.analysis.targets.on("after-remove",s=>this._onAnalysisTargetRemoved(s.item))],t),this.targets.removeAll(),e.targets.forEach(s=>{this._onAnalysisTargetAdded(s)})}_convertAnalysisPointToAbsoluteHeight(e,t){const s=e.clone();if(this.view!=null){const g=G(e.hasZ,t);s.z=R(this.view,e,g,Z)}return s}};i([n({type:b})],c.prototype,"analysis",void 0),i([n({readOnly:!0})],c.prototype,"state",null),i([n()],c.prototype,"observer",null),i([n({type:_,cast:V,nonNullable:!0})],c.prototype,"targets",null),c=i([w("esri.widgets.lineOfSight.LineOfSightViewModel")],c);const M=c,a="esri-line-of-sight",l={base:a,actions:`${a}__actions`,container:`${a}__container`,error:`${a}__error`,hint:`${a}__hint`,hintText:`${a}__hint-text`,newAnalysisButton:`${a}__new-analysis-button`,widgetIcon:x.lineOfSight},v={newAnalysisButton:`${a}__new-button`,continueButton:`${a}__continue-button`,doneButton:`${a}__done-button`};let o=class extends k{constructor(e,t){super(e,t),this.iconClass=l.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new M,this._onNewAnalysis=()=>{S(this.viewModel.start())},this._onDone=()=>{this.viewModel.stop()},this._onContinue=()=>{this.viewModel.continue()}}loadDependencies(){return D({button:()=>H(()=>import("./calcite-button-BGRBzuhy.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]))})}get active(){return this.viewModel.active}get analysis(){return this.viewModel.analysis}set analysis(e){this.viewModel.analysis=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}render(){return r("div",{class:this.classes(l.base,f.widget,f.panel),role:"presentation"},this._renderContainerNode())}_renderContainerNode(){if(!this.visible)return null;if(!this.viewModel.supported)return this._renderUnsupportedMessage();let e=null;const t=[this._renderNewAnalysisButton()];return this.viewModel.state==="creating"?(e=this._renderHint(),t.unshift(this._renderDoneButton())):this.viewModel.state==="created"&&this.viewModel.targets.length>0&&t.unshift(this._renderContinueButton()),r("div",{class:l.container},e,r("div",{class:l.actions},t))}_renderUnsupportedMessage(){return r("div",{class:l.error,key:"esri-line-of-sight__unsupported"},r("p",null,this.messages.unsupported))}_renderHint(){return r("div",{class:l.hint,key:"esri-line-of-sight__hint"},r("p",{class:l.hintText},this.messages.hint))}_renderNewAnalysisButton(){return this._renderButton({className:l.newAnalysisButton,id:v.newAnalysisButton,label:this.messages.newAnalysis,onClick:this._onNewAnalysis,primary:!0})}_renderDoneButton(){return this._renderButton({id:v.doneButton,label:this.messages.done,onClick:this._onDone,primary:!1})}_renderContinueButton(){return this._renderButton({id:v.newAnalysisButton,label:this.messages.continueAnalysis,onClick:this._onContinue,primary:!1})}_renderButton({className:e,id:t,label:s,onClick:g,primary:p}){const d=this.viewModel.state==="disabled";return r("calcite-button",{appearance:p?"solid":"outline-fill",class:e,"data-id":t,disabled:d,key:t,onclick:g},s)}get test(){return{IDS:v}}};i([n()],o.prototype,"active",null),i([n({constructOnly:!0,nonNullable:!0})],o.prototype,"analysis",null),i([n()],o.prototype,"iconClass",void 0),i([n()],o.prototype,"icon",void 0),i([n()],o.prototype,"label",null),i([n(),N("esri/widgets/LineOfSight/t9n/LineOfSight")],o.prototype,"messages",void 0),i([n()],o.prototype,"view",null),i([n({type:M})],o.prototype,"viewModel",void 0),i([n()],o.prototype,"visible",null),o=i([w("esri.widgets.LineOfSight")],o);const se=o;export{se as default};
