function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/editingTools-C9mSDyC_.js","assets/index-8ERthB3p.js","assets/index-CzRN3C0i.css","assets/SnappingVisualizer2D-C_lkvSQ4.js","assets/vec2-Dt9Foiri.js","assets/vec2f64-Diu2Kaa8.js","assets/enums-BRqP_wXA.js","assets/angularMeasurementUtils-CATp35qy.js","assets/geodesicUtils-D1kRRrco.js","assets/plane-Du3EYICn.js","assets/mat3f64-BBpwCtoL.js","assets/mat4f64-Dk4dwAN8.js","assets/quatf64-BrpT0VRp.js","assets/mathUtils-iSLnUy_4.js","assets/sphere-Bf4ezJdT.js","assets/ObjectStack-BPo9QGhV.js","assets/geometry2dUtils-DoOkpuKA.js","assets/projectVectorToVector-C3SBBDgz.js","assets/projectPointToVector-qKp-AJ2b.js","assets/screenUtils-BuM_Fswi.js","assets/signal-DoM1gSF0.js","assets/elevationInfoUtils-sHEwmo9N.js","assets/Cyclical-BY9qISY1.js","assets/quantityUtils-9zDVxeky.js","assets/SnappingVisualizer-DfDIQ0EV.js","assets/PointSnappingHint-DFYGb6IS.js","assets/editPlaneUtils-BlWFsEOD.js","assets/GraphicsLayer-CapLCpoe.js","assets/GraphicsCollection-CKieR40M.js","assets/dehydratedFeatureComparison-DdCJ1gSj.js","assets/createUtils-CzMRA5VU.js","assets/geometryEngine-MBwx6Ib1.js","assets/geometryEngineBase-Cz__5BKm.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/hydrated-7yclY7Co.js","assets/surfaceCoordinateSystems-mGV_LGb6.js","assets/memoize-DsJmrG76.js","assets/UpdatingHandles-ugzlsvZF.js","assets/ViewingMode-Dodu7ZZk.js","assets/EditGeometryOperations-3XHFCAp6.js","assets/InteractiveToolBase-yKkEJSmV.js","assets/meshVertexSpaceUtils-KRc33Yrq.js","assets/MeshLocalVertexSpace-C8ABjEju.js","assets/vec3-DPXcG_yS.js","assets/hydratedFeatures-DqrDm0_F.js","assets/interfaces-DkjgzG8v.js","assets/drawUtils-C6Di23Hl.js","assets/interfaces-D6pIddIh.js","assets/SketchLabelOptions-BnZB654u.js","assets/SnappingContext-Cpn1WUY8.js","assets/SnappingDragPipelineStep-selKU1rW.js","assets/Scheduler-DaHJO6l7.js","assets/debugFlags-BbJIqrPU.js","assets/RenderState-DaVlEYWY.js","assets/SnappingOperation-B1FLBSOP.js","assets/mat2d-D9yIh3Tx.js","assets/mat2df64-CBKYtunK.js","assets/quat-DUnoL8dP.js","assets/helpMessageUtils-M95XMmyR.js","assets/Tooltip-lxtA1b5H.js","assets/themeUtils-C3zvZbsE.js","assets/jsxFactory-BxQYPm-b.js","assets/a11yUtils-BChjGAWF.js","assets/quantityFormatUtils-DfDZUKJh.js","assets/unitFormatUtils-3MMEFLJJ.js","assets/ByteSizeUnit-BsxeN7wM.js","assets/getDefaultUnitForView-BEilgbp7.js","assets/directionModeIcons-Br5woIHu.js","assets/automaticAreaMeasurementUtils-G1AtsSdr.js","assets/euclideanAreaMeasurementUtils-CIzlnp3G.js","assets/earcut-BqgeR2O3.js","assets/triangle-CTblFuF6.js","assets/lineSegment-DVvvMBnG.js","assets/measurementUtils-CUrVHWre.js","assets/spatialReferenceEllipsoidUtils-CmEPjh7T.js","assets/geodesicMeasurementUtils-BcTpN3Xi.js","assets/automaticLengthMeasurementUtils-Bo1iBsUk.js","assets/SnappingManager-DUlqpdAB.js","assets/floorFilterUtils-DZ5C6FQv.js","assets/layerViewUtils-Bi2wmOiN.js","assets/viewUtils-DC86MEAQ.js","assets/projectVectorToWGS84ComparableLonLat-DuPw0-Mv.js","assets/boundedPlane-CLJ-Xnn_.js","assets/cimSymbolUtils-DwzauUMk.js","assets/GraphicManipulator-XLxbfqMV.js","assets/drapedUtils-BdDXXXz6.js","assets/hitTestSelectUtils-UXJPjatw.js","assets/layerUtils-BS1Di3Pm.js","assets/editingTools-B6T33T1P.js","assets/TextOverlayItem-BPy-0Tbh.js","assets/SnappingVisualizer3D-CgXvcLRx.js","assets/ExtendedLineVisualElement-CQkDkcGr.js","assets/vec4f32-CjrfB-0a.js","assets/frustum-BrAPXuhm.js","assets/EngineVisualElement-DUG0X7vS.js","assets/RenderGeometry-rcUvJmRA.js","assets/vec3f32-Cw9Q6TO_.js","assets/DoubleArray-068mylUp.js","assets/Texture-C7A05GrI.js","assets/interfaces-B8ge7Jg9.js","assets/BindType-BmZEZMMh.js","assets/Util-B8vYs4k8.js","assets/enums-DSseSvdG.js","assets/Texture-O7Pyotwx.js","assets/VertexAttribute-BnAa5VW0.js","assets/basicInterfaces-DngWxyLO.js","assets/mat3-CqxUQBLP.js","assets/ShaderTechniqueConfiguration-D3UbJ2mX.js","assets/doublePrecisionUtils-B0owpBza.js","assets/Material-DwPnlQDw.js","assets/ContentObject-BTgEhnct.js","assets/requestImageUtils-DP1V3HlH.js","assets/Indices-DP3oX5Sg.js","assets/Attribute-B-NAci_J.js","assets/Geometry-CqGtfd4N.js","assets/computeTranslationToOriginAndRotation-BbJd4iYX.js","assets/ElevationProvider-Bd4qfXCi.js","assets/verticalOffsetUtils-BYv4Nk2v.js","assets/orientedBoundingBox-BQvYwCTM.js","assets/axisAngleDegrees-CaSFQR2z.js","assets/weather-D00pIeau.js","assets/NestedMap-DgiGbX8E.js","assets/Octree-E7a40xr7.js","assets/InterleavedLayout-s3MgOYN8.js","assets/BufferView-CHYzaV9A.js","assets/types-D0PSWh4d.js","assets/OrderIndependentTransparency-Cua2R8AE.js","assets/floatRGBA-CCqnXShd.js","assets/Intersector-8rpRuT_8.js","assets/glUtil-DS73TAjp.js","assets/VertexElementDescriptor-BOD-G50G.js","assets/VertexArrayObject-Cv4RwmVi.js","assets/BufferObject-CaEbWulZ.js","assets/VisualElement-CI1nOGdz.js","assets/LaserlineVisualElement-CzVKEaBL.js","assets/Laserlines.glsl-CH220B6j.js","assets/Object3DVisualElement-D2TYUCro.js","assets/ColorMaterial.glsl-uPKQoFFi.js","assets/VertexColor.glsl-CScvx9pF.js","assets/RightAngleQuadVisualElement-TrRXC01x.js","assets/OutlineVisualElement-BsdQ_qK5.js","assets/lineStippleUtils-B9K4R8oO.js","assets/triangulationUtils-C0V38kt7.js","assets/deduplicate-j8p9VETP.js","assets/VerticesVisualElement-CMCXxnaQ.js","assets/RenderObject-BqR7Zmh-.js","assets/ray-CCzLdiTI.js","assets/GraphicState-BLKIyD3S.js","assets/helpMessageUtils3d-iCaxCkPU.js","assets/manipulatorUtils-uzcmbeQs.js","assets/dragEventPipeline3D-B83b_Wx5.js","assets/TranslateTooltipInfos-DCWVK8sM.js","assets/utils-j-RBNfeR.js","assets/IViewEvents-Bci6PjlS.js","assets/SlicePlaneMaterial.glsl-OGerbmE5.js","assets/ImageMaterial.glsl-BKacu54w.js","assets/DefaultLayouts-BrmJbx_o.js","assets/SlicePlane-DAv08y7K.js","assets/persistable-DTlPUvTn.js","assets/multiOriginJSONSupportUtils-C0wm8_Yw.js","assets/resourceExtension-5aSW4bDb.js","assets/LineVisualElement-DVtpCq1A.js","assets/RenderCoordsHelper-zH8WjGkC.js","assets/projectVectorToPoint-CPW7kXva.js","assets/Factory-C69g7C8p.js","assets/extentUtils-o-PAXntO.js","assets/GraphicsLayerView3D-De-WQb2o.js","assets/LayerView3D-y7LfmsJ-.js","assets/heightModelInfoUtils-CdtST1Ra.js","assets/queryForSymbologySnapping-8JLrvhsd.js","assets/GraphicsProcessor-B0rTvHPS.js","assets/WaterSurface.glsl-JBHYhfkH.js","assets/vec2f32-BbH2jxlN.js","assets/dehydratedFeatures-Cp-_lWz0.js","assets/featureConversionUtils-BzfH5fda.js","assets/OptimizedFeature-CXeSoBCN.js","assets/OptimizedFeatureSet-Blu9Ckm7.js","assets/OptimizedGeometry-DLPswkPy.js","assets/edgeUtils-D8J_3GIe.js","assets/SnappingCandidate-O5eRSE6e.js","assets/Normals-BAXqRpCA.js","assets/objectResourceUtils-D-wPKn4W.js","assets/devEnvironmentUtils-Blrp8lZ5.js","assets/DefaultMaterial_COLOR_GAMMA-D4SZcGoz.js","assets/resourceUtils-ayGD6aG4.js","assets/symbolColorUtils-B_k_VgHH.js","assets/CIMSymbolHelper-C-U_lWVp.js","assets/BidiEngine-DL33fnW5.js","assets/fontUtils-Dz0hN_7q.js","assets/GeometryUtils-_MjrRDxY.js","assets/definitions-B54owTRu.js","assets/mat2df32-orApM5a3.js","assets/Rect-CUzevAry.js","assets/BoundingBox-BhuXqU4L.js","assets/MeshComponent-BCGFLGQh.js","assets/imageUtils-D1MsbWS6.js","assets/georeference-CwPKO8dc.js","assets/webStyleSymbolUtils-BzDS5WjL.js","assets/Intersector-CTjLkyei.js","assets/Graphics3DObjectStates-CZBjX6i5.js","assets/rendererConversion-eHDRAZSQ.js","assets/optimizedFeatureQueryEngineAdapter-DY8fepQr.js","assets/centroid-DdLmOD72.js","assets/PooledRBush-CjYPNqwP.js","assets/quickselect-D0_cvEX6.js","assets/popupUtils-BHYiW8I-.js","assets/projectExtentUtils-9sG7uFGp.js","assets/geometryServiceUtils-B-h5lvUN.js","assets/project-7u3NBcq6.js","assets/utils-1zmckiYC.js","assets/utils-D-bI9C7C.js","assets/LayerView-DO6TerBv.js","assets/GraphicMover-BGXU7J-0.js","assets/HighlightHelper-C9qxMKl7.js","assets/featureUtils-v_3Xfkxx.js","assets/utils-B6UP7_Wm.js","assets/Box-D9-rup5y.js","assets/settings-CF90uFxz.js","assets/Reshape-1QFyNubm.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{o as h,y as u,X as S,bO as H,Z as bt,bi as B,dS as Et,kT as Ot,nd as Gt,gC as Tt,gd as wt,kc as St,ne as Mt,fx as ut,T as Rt,bE as yt,gh as At,e7 as ot,e8 as Pt,e5 as kt,nf as Ct,ak as at,ng as It,ct as it,cr as x,ej as K,gJ as L,_ as T,cs as Dt,fY as Z,c_ as rt,a1 as Ut,dt as Ht,dp as xt,dq as Lt,dr as Nt,kG as Vt,fU as st,P as $t,s as Yt,f$ as nt,hi as Ft,kD as N}from"./index-8ERthB3p.js";import Bt from"./GraphicsLayer-CapLCpoe.js";import{s as j,c as J}from"./elevationInfoUtils-sHEwmo9N.js";import{b as Kt}from"./geodesicUtils-D1kRRrco.js";import{e as pt}from"./layerUtils-BS1Di3Pm.js";import{n as lt,_ as E}from"./screenUtils-BuM_Fswi.js";import{q as W,N as Zt,e as _}from"./angularMeasurementUtils-CATp35qy.js";import{c as X}from"./SketchLabelOptions-BnZB654u.js";import{u as gt,j as ht}from"./SnappingManager-DUlqpdAB.js";import{r as Wt}from"./hitTestSelectUtils-UXJPjatw.js";let C=class extends H{constructor(e){super(e),this.directionMode="relative",this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case"relative":return this.relativeDirectionIsBilateral?W.RelativeBilateral:W.Relative;case"absolute":return W.Absolute}}};h([u({type:String,nonNullable:!0})],C.prototype,"directionMode",void 0),h([u({type:Boolean,nonNullable:!0})],C.prototype,"relativeDirectionIsBilateral",void 0),h([u()],C.prototype,"effectiveDirectionMode",null),C=h([S("esri.views.interactive.sketch.SketchValueOptions")],C);const Q=C;let U=class extends H{constructor(t){super(t),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};h([u({type:String,nonNullable:!0})],U.prototype,"mode",void 0),U=h([S("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],U);let G=class extends H{constructor(t){super(t),this.area=!0,this.direction=!0,this.distance=!0,this.elevation=!0,this.header=!0,this.helpMessage=!1,this.orientation=!0,this.radius=!0,this.rotation=!0,this.scale=!0,this.size=!0,this.totalLength=!0}toJSON(){return{area:this.area,direction:this.direction,distance:this.distance,elevation:this.elevation,header:this.header,helpMessage:this.helpMessage,orientation:this.orientation,radius:this.radius,rotation:this.rotation,scale:this.scale,size:this.size,totalLength:this.totalLength}}};h([u({type:Boolean,nonNullable:!0})],G.prototype,"area",void 0),h([u({type:Boolean,nonNullable:!0})],G.prototype,"direction",void 0),h([u({type:Boolean,nonNullable:!0})],G.prototype,"distance",void 0),h([u({type:Boolean,nonNullable:!0})],G.prototype,"elevation",void 0),h([u({type:Boolean,nonNullable:!0})],G.prototype,"header",void 0),h([u({type:Boolean,nonNullable:!0})],G.prototype,"helpMessage",void 0),h([u({type:Boolean,nonNullable:!0})],G.prototype,"orientation",void 0),h([u({type:Boolean,nonNullable:!0})],G.prototype,"radius",void 0),h([u({type:Boolean,nonNullable:!0})],G.prototype,"rotation",void 0),h([u({type:Boolean,nonNullable:!0})],G.prototype,"scale",void 0),h([u({type:Boolean,nonNullable:!0})],G.prototype,"size",void 0),h([u({type:Boolean,nonNullable:!0})],G.prototype,"totalLength",void 0),G=h([S("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],G);const mt=G;let w=class extends H{constructor(e){super(e),this.enabled=!1,this.forceEnabled=!1,this.inputEnabled=!0,this.elevation=new U,this.visibleElements=new mt,this.visualVariables=null}get effectiveEnabled(){return this.forceEnabled||this.enabled}};h([u({type:Boolean,nonNullable:!0})],w.prototype,"enabled",void 0),h([u()],w.prototype,"forceEnabled",void 0),h([u()],w.prototype,"effectiveEnabled",null),h([u({type:Boolean,nonNullable:!0})],w.prototype,"inputEnabled",void 0),h([u({type:U,nonNullable:!0})],w.prototype,"elevation",void 0),h([u({type:mt,nonNullable:!0})],w.prototype,"visibleElements",void 0),h([u()],w.prototype,"visualVariables",void 0),w=h([S("esri.widgets.sketch.SketchTooltipOptions")],w);const tt=w;let I=class extends H{constructor(t){super(t),this.labels=new X,this.tooltips=new tt,this.values=new Q}};h([u({nonNullable:!0,type:X})],I.prototype,"labels",void 0),h([u({nonNullable:!0,type:tt})],I.prototype,"tooltips",void 0),h([u({nonNullable:!0,type:Q})],I.prototype,"values",void 0),I=h([S("esri.views.interactive.sketch.SketchOptions")],I);const vt=I;function q(t){switch(t){case y.SUPPORTED:break;case y.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case y.GEOMETRY_MISSING:return"no geometry";case y.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case y.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case y.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}var y;(function(t){t[t.SUPPORTED=0]="SUPPORTED",t[t.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",t[t.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",t[t.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",t[t.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",t[t.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(y||(y={}));function qt(t){var e;if(((e=t.layer)==null?void 0:e.type)!=="graphics")return y.GRAPHICS_LAYER_MISSING;if(t.geometry==null)return y.GEOMETRY_MISSING;switch(t.geometry.type){case"polygon":case"point":case"polyline":case"mesh":break;default:return y.GEOMETRY_TYPE_UNSUPPORTED}return j(t)!=="on-the-ground"&&J(t)?y.ELEVATION_MODE_UNSUPPORTED:y.SUPPORTED}var z;let A=z=class extends B{constructor(...t){super(...t),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}normalizeCtorArgs(t,e){let a;if(t!=null&&t.center)a=t;else{if(t!=null&&t.rings)return super.normalizeCtorArgs(t,e);a={center:t}}return{...super.normalizeCtorArgs(),...a,...e}}initialize(){const t=this.center,e=this.numberOfPoints;if(this.hasZ=(t==null?void 0:t.hasZ)??!1,this.rings.length!==0||!t)return;const a=Et(this.radius,this.radiusUnit,"meters"),o=t.spatialReference;let i,r="geographic";if(o.isWebMercator?r="webMercator":((o.wkid&&Ot[o.wkid])!=null||(o.wkt2||o.wkt)&&Gt(o.wkt2||o.wkt))&&(r="projected"),this.geodesic){let p;switch(r){case"webMercator":p=Tt(t);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":p=t}i=this._createGeodesicCircle(p,a,e),r==="webMercator"&&(i=wt(i))}else{let p;r==="webMercator"||r==="projected"?p=a/St(t.spatialReference):r==="geographic"&&(p=Mt(a,"meters",ut(t.spatialReference).radius)),i=this._createPlanarCircle(t,p,e)}this.spatialReference=i.spatialReference,this.addRing(i.rings[0])}clone(){const{center:t,numberOfPoints:e,radius:a,radiusUnit:o,geodesic:i}=this;return new z({center:t==null?void 0:t.clone(),numberOfPoints:e,radius:a,radiusUnit:o,geodesic:i})}_createGeodesicCircle(t,e,a){let o=0;const i=[];for(;o<360;){const r=[0,0],p=[t.x,t.y];Kt(r,p,o,e,Rt.WGS84),this.hasZ&&r.push(t.z),i.push(r),o+=360/a}return i.push(i[0]),new B(i)}_createPlanarCircle(t,e,a){const o=[],i=2*Math.PI/a;for(let r=0;r<a;++r){const p=i*r,s=[t.x+Math.cos(-p)*e,t.y+Math.sin(-p)*e];this.hasZ&&s.push(t.z),o.push(s)}return o.push(o[0]),new B({spatialReference:t.spatialReference,rings:[o]})}};h([u({type:bt})],A.prototype,"center",void 0),h([u()],A.prototype,"geodesic",void 0),h([u()],A.prototype,"numberOfPoints",void 0),h([u()],A.prototype,"radius",void 0),h([u()],A.prototype,"radiusUnit",void 0),A=z=h([S("esri.geometry.Circle")],A);const zt=A;function V(t){return _t(t).result}function ce(t){return _t(t).geometry}function _t(t){var o;if(((o=t.layer)==null?void 0:o.type)!=="graphics")return{result:y.GRAPHICS_LAYER_MISSING,geometry:null};const{geometry:e}=t;if(e==null)return{result:y.GEOMETRY_MISSING,geometry:null};if(j(t)!=="on-the-ground"&&J(t))return{result:y.ELEVATION_MODE_UNSUPPORTED,geometry:null};const a=e.type;return a!=="point"&&a!=="mesh"&&a!=="polyline"&&(a!=="polygon"||t.geometry instanceof zt)?{result:y.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:y.SUPPORTED,geometry:e}}function jt(t){var a;if(((a=t.layer)==null?void 0:a.type)!=="graphics")return y.GRAPHICS_LAYER_MISSING;if(t.geometry==null)return y.GEOMETRY_MISSING;switch(t.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return y.SUPPORTED;default:return y.GEOMETRY_TYPE_UNSUPPORTED}const e=t.symbol!=null&&t.symbol.type==="point-3d"&&t.symbol.symbolLayers;return!e||!e.some(o=>o.type==="object")?y.SYMBOL_TYPE_UNSUPPORTED:j(t)!=="on-the-ground"&&J(t)?y.ELEVATION_MODE_UNSUPPORTED:y.SUPPORTED}let O=class extends yt.EventedAccessor{constructor(t){super(t),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:At(this.activeComponent)}return null}addToHistory(t){this.history.redo=[],this.history.undo.push(t)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){var t;(t=this.activeComponent)==null||t.reset()}refreshComponent(){const t=this.activeComponent;t&&(t.type!=="box"&&t.type!=="reshape"&&t.type!=="graphic-mover"||t.refresh())}set undo(t){this._set("undo",()=>{this.canUndo()&&t()})}set redo(t){this._set("redo",()=>{this.canRedo()&&t()})}};h([u()],O.prototype,"activeComponent",void 0),h([u()],O.prototype,"cancelled",void 0),h([u()],O.prototype,"history",void 0),h([u()],O.prototype,"tool",null),h([u()],O.prototype,"type",void 0),h([u()],O.prototype,"canUndo",null),h([u()],O.prototype,"canRedo",null),h([u()],O.prototype,"onEnd",void 0),h([u()],O.prototype,"undo",null),h([u()],O.prototype,"redo",null),h([u()],O.prototype,"toggleTool",void 0),h([u()],O.prototype,"addToSelection",void 0),h([u()],O.prototype,"removeFromSelection",void 0),O=h([S("esri.widgets.Sketch.support.OperationHandle")],O);let F=class extends O{};h([u()],F.prototype,"activeComponent",void 0),F=h([S("esri.widgets.Sketch.support.CreateOperationHandle")],F);let R=class extends O{};h([u()],R.prototype,"activeComponent",void 0),R=h([S("esri.widgets.Sketch.support.UpdateOperationHandle")],R);const ct={defaultZ:0},D={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};let g=class extends yt.EventedAccessor{constructor(t){var e;super(t),this._numUpdating=0,this._defaultSnappingManager=null,this._internalGraphicsLayer=new Bt({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandlesKey="viewHandles",this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.layer=null,this.pointSymbol=new ot({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new Pt({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new kt({color:[130,130,130,1],width:2}),this.meshSymbol=new Ct({symbolLayers:new at([new It])}),this.updateGraphics=new at,this.updateOnGraphicClick=!0,this.vertexSymbol=new ot({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.sketchOptions=new vt,this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._originalPopupEnabled=null,this.defaultCreateOptions=ct,this.defaultUpdateOptions=D,this.snappingOptions=((e=t==null?void 0:t.snappingManager)==null?void 0:e.options)??(t==null?void 0:t.snappingOptions)??new gt}initialize(){this.addHandles([it(()=>{var t,e;return(e=(t=this.view)==null?void 0:t.map)==null?void 0:e.layers},"change",t=>{t.removed.includes(this.layer)&&this.cancel()}),it(()=>{var t;return(t=this.layer)==null?void 0:t.graphics},"change",t=>{if(this._operationHandle!=null)for(const e of t.removed)this.updateGraphics.includes(e)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(e):this._operationHandle.cancel())}),x(()=>{var t;return((t=this.layer)==null?void 0:t.elevationInfo)??null},t=>{t!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=t)},K),x(()=>this.view,t=>{this._defaultSnappingManager=L(this._defaultSnappingManager),t&&(this.snappingManager||(this._defaultSnappingManager=new ht({view:t,options:this.snappingOptions})),t.type==="2d"?T(()=>import("./editingTools-C9mSDyC_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87])):t.type==="3d"&&(T(()=>import("./editingTools-B6T33T1P.js"),__vite__mapDeps([88,1,2,21,63,23,64,65,22,4,5,9,10,11,12,13,66,89,61,76,17,18,73,74,77,7,8,14,15,16,19,20,37,78,79,80,31,32,33,34,81,75,90,91,92,93,72,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,38,111,112,113,114,71,115,116,82,117,118,57,44,119,120,53,121,122,123,124,125,126,127,128,129,130,131,132,51,52,133,134,135,136,137,138,139,24,25,41,42,43,45,140,141,142,70,143,144,145,146,47,147,26,27,28,29,30,35,36,39,40,46,48,49,50,54,55,56,58,59,60,62,67,68,69,148,149,150,84,85,151,152,83,153,154,155,156,157,158,159,160,161,162,163,164,165,87,86])),T(()=>import("./GraphicsLayerView3D-De-WQb2o.js"),__vite__mapDeps([166,1,2,167,168,169,18,17,21,95,5,96,97,98,99,100,101,102,103,104,105,106,10,11,107,108,109,110,38,4,111,112,9,12,13,14,15,113,114,71,72,115,116,82,117,118,57,74,44,119,120,53,121,93,122,123,124,125,126,127,128,129,130,131,132,51,20,52,170,37,171,137,138,172,173,174,175,176,177,178,70,33,43,179,142,143,180,181,182,183,184,185,186,187,188,189,6,190,55,191,192,193,83,152,141,163,194,195,41,42,196,45,156,197,198,199,200,201,202,203,204,19,205,79,206,207,208,209,210,211]))))},K),x(()=>{var t;return(t=this.view)==null?void 0:t.spatialReference},(t,e)=>{t&&e&&!t.equals(e)&&this.cancel()})]),Zt(this)}destroy(){this.cancel(),this._removeDefaultLayer(),this._defaultSnappingManager=L(this._defaultSnappingManager),this._set("snappingManager",null),this._set("view",null),this.emit("destroy")}get _defaultUpdateTool(){var t;return((t=this.view)==null?void 0:t.type)==="3d"?"move":"transform"}get updating(){return this._numUpdating>0||this.snappingManager!=null&&this.snappingManager.updating}get activeTool(){var t;return((t=this._operationHandle)==null?void 0:t.tool)??null}get activeComponent(){var t;return((t=this._operationHandle)==null?void 0:t.activeComponent)??null}get createGraphic(){return this.activeComponent==null||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(t){this._set("defaultCreateOptions",{...ct,...t})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(t){this._set("defaultUpdateOptions",{...D,...t,reshapeOptions:{...D.reshapeOptions,...t==null?void 0:t.reshapeOptions},highlightOptions:{...D.highlightOptions,...t==null?void 0:t.highlightOptions}})}get labelOptions(){return this.sketchOptions.labels}set labelOptions(t){this.sketchOptions.labels=t}get snappingOptions(){var t;return((t=this.snappingManager)==null?void 0:t.options)??this._get("snappingOptions")}set snappingOptions(t){this._defaultSnappingManager!=null&&(this._defaultSnappingManager.options=t),this._set("snappingOptions",t)}get snappingManager(){return this._isOverridden("snappingManager")&&this._get("snappingManager"),this._defaultSnappingManager}set snappingManager(t){if(t)this._isOverridden("snappingManager")||(this._defaultSnappingManager=L(this._defaultSnappingManager)),this._override("snappingManager",t);else{const{view:e}=this;!this._defaultSnappingManager&&e&&(this._defaultSnappingManager=new ht({options:this.snappingOptions,view:e})),this._clearOverride("snappingManager")}}get state(){var a;const t=!(!((a=this.view)!=null&&a.ready)||!this.layer),e=this._operationHandle;return t&&e?"active":t?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(t){this.sketchOptions.tooltips=t}get valueOptions(){return this.sketchOptions.values}set valueOptions(t){this.sketchOptions.values=t}get view(){return this._get("view")}set view(t){const e=this._get("view");if(e){const{container:o,map:i}=e;o&&(e.cursor=null),i==null||i.remove(this._internalGraphicsLayer),this.removeHandles(this._viewHandlesKey),this.cancel()}const a="view-ready";this.removeHandles(a),t&&this.addHandles(Dt(()=>t.ready,o=>{this.removeHandles(this._viewHandlesKey),o&&this.addHandles(this._generateViewHandles(t),this._viewHandlesKey)},K),a),this._set("view",t)}cancel(){this._moduleLoaderAbortController=Z(this._moduleLoaderAbortController),this._viewReadyAbortController=Z(this._viewReadyAbortController),this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:t,updateGraphics:e}=this;if(t==="active"&&e.length){const{activeTool:a,layer:o}=this,i=e.toArray();o.removeMany(i),this.cancel(),this._emitDeleteEvent({graphics:i,tool:a})}}duplicate(){if(this.state==="active"&&this.updateGraphics.length){const t=this.updateGraphics.map(e=>e.clone()).toArray();return this.layer.addMany(t),this.emit("duplicate",{graphics:t,type:"duplicate"}),t}return[]}async create(t,e){this.cancel(),await this._waitViewReady();const{view:a,layer:o}=this;if(!a||this.state==="disabled")throw o||this._logMissingLayer(),rt();if(a.activeTool!=null&&(a.activeTool=null),!t)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");pt(a,this._internalGraphicsLayer);const i=await this._setupCreateOperation(t,e);if(i==null||this.destroyed)return void a.map.remove(this._internalGraphicsLayer);const r=()=>{var p;if(i===this._operationHandle){const s=this.createGraphic,d=this._operationHandle.cancelled;this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),(p=this.view)!=null&&p.map&&this.view.map.remove(this._internalGraphicsLayer),i.cancelled||s==null||o.add(s),this.emit("create",{graphic:s,state:d?"cancel":"complete",tool:t,toolEventInfo:null,type:"create"})}};i.on("complete",r),this._operationHandle=i,a.ready&&a.focus()}async place(t,e){return this.create("mesh",{mode:"click",hasZ:t.hasZ,geometryToPlace:t,...e})}async update(t,e){this.cancel(),await this._waitViewReady();const{layer:a,view:o,state:i}=this;if(!o||i==="disabled")throw a||this._logMissingLayer(),rt();o.activeTool!=null&&(o.activeTool=null);const r=Array.isArray(t)?t:[t];if(t==null||!(r!=null&&r.length))return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(r.some(s=>s.layer!==a?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):s.geometry==null&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0)))return;const p=await this._setupUpdateOperation(r,e);this.destroyed||p==null||f(p)||(pt(o,this._internalGraphicsLayer),this._setUpdateOperationHandle(p,e),this.emit("update",{graphics:r,state:"start",aborted:!1,tool:p.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(t){const e=this.view;if(e){this._beginAsyncOperation(),t=Array.isArray(t)?t:[t];for(const a of t)a.geometry==null||a.geometry.type==="mesh"||Ut(a.geometry.spatialReference,e.spatialReference)||(Ht(a.geometry.spatialReference,e.spatialReference)||xt()||await Lt(),a.geometry=Nt(a.geometry,e.spatialReference));this._endAsyncOperation()}else this._logMissingView()}undo(){var t;this.canUndo()&&((t=this._operationHandle)==null||t.undo())}redo(){var t;this.canRedo()&&((t=this._operationHandle)==null||t.redo())}canUndo(){return!(!this._operationHandle||!this._operationHandle.canUndo())}canRedo(){return!(!this._operationHandle||!this._operationHandle.canRedo())}toggleUpdateTool(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()}async _getFirstHit(t){const e=this.view;if(!e)return this._logMissingView(),null;if(e.type==="2d"){const i=[];e.map.allLayers.forEach(p=>{p.type!=="vector-tile"&&p.type!=="imagery"||i.push(p)});const r=await e.hitTest(t,{exclude:i});return Wt(r.results)}const a=[e.map.ground];e.map.allLayers.forEach(i=>{Vt(i.type)&&a.push(i)});const o=await e.hitTest(t,{exclude:a});if(o.results.length>0){const i=o.results[0];if(i!=null&&i.type==="graphic"&&i.graphic&&(!o.ground.mapPoint||e.map.ground.opacity<1||o.ground.distance-(i.distance??0)>-Math.min(3*o.ground.distance,e.viewingMode==="global"?ut(e.renderCoordsHelper.spatialReference).radius/e.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return i}return null}_generateViewHandles(t){return[t.on("immediate-click",async e=>{var r;const a=this.state==="active"&&((r=this._operationHandle)==null?void 0:r.type)==="create";if(this.state==="disabled"||a||!this.updateOnGraphicClick)return;this._beginAsyncOperation();const o=await e.async(()=>this._getFirstHit(lt(e)));let i=null;if(o!=null){const p=o.graphic;this.updateGraphics.includes(p)||p.layer===this.layer?(e.stopPropagation(),i=p):t.type!=="2d"||this._isComponentGraphic(p)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();i==null||this.updateGraphics.includes(i)||await this.update([i],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}}),this._endAsyncOperation()},E.WIDGET)]}async _setupCreateOperation(t,e){const a=this.view;if(!a)return this._logMissingView(),null;const o={hasZ:a.type==="3d",...this.defaultCreateOptions,...e},i=await this._setupDrawGraphicTool(t,a,o);return i==null?null:(a.tools.add(i),a.activeTool=i,this._setupCreateOperationHandle(i))}async _setupDrawGraphicTool(t,e,a){if(t==="multipoint"&&e.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!e)return this._logMissingView(),null;const{cursor:o,defaultZ:i,hasZ:r,geometryToPlace:p,graphicProperties:s,mode:d,preserveAspectRatio:n}=a,c=t==="rectangle"||t==="circle"?"hybrid":"click",l=n??t!=="rectangle",m={centered:t!=="rectangle"&&!(t==="circle"&&!l),cursor:o,defaultZ:i,forceUniformSize:l,graphicProperties:s,geometryToPlace:p,geometryType:t,graphicSymbol:this._getGraphicSymbolFromTool(t),hasZ:r,mode:d??c,snappingManager:this.snappingManager,snapToScene:!1,view:e};return e.type==="2d"?this._makeDrawGraphicTool2D(m):this._makeDrawGraphicTool3D(m)}async _makeDrawGraphicTool2D(t){const e=await this._requireModule(T(()=>import("./editingTools-C9mSDyC_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87])));return f(e)||this.destroyed?null:new e.module.DrawGraphicTool2D({...t,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:Xt(t.geometryType)?this.activeFillSymbol:null,sketchOptions:this.sketchOptions})}async _makeDrawGraphicTool3D(t){const e=await this._requireModule(T(()=>import("./editingTools-B6T33T1P.js"),__vite__mapDeps([88,1,2,21,63,23,64,65,22,4,5,9,10,11,12,13,66,89,61,76,17,18,73,74,77,7,8,14,15,16,19,20,37,78,79,80,31,32,33,34,81,75,90,91,92,93,72,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,38,111,112,113,114,71,115,116,82,117,118,57,44,119,120,53,121,122,123,124,125,126,127,128,129,130,131,132,51,52,133,134,135,136,137,138,139,24,25,41,42,43,45,140,141,142,70,143,144,145,146,47,147,26,27,28,29,30,35,36,39,40,46,48,49,50,54,55,56,58,59,60,62,67,68,69,148,149,150,84,85,151,152,83,153,154,155,156,157,158,159,160,161,162,163,164,165,87,86])));if(f(e)||this.destroyed)return null;const{elevationInfo:a}=this.layer;return new e.module.DrawGraphicTool3D({...t,elevationInfo:a,snapToScene:!0,sketchOptions:this.sketchOptions})}_setupCreateOperationHandle(t){const e=this.view;if(!e)return this._logMissingView(),null;let a=null;const o=t.forceUniformSize,i=t.centered,r=[e.on("key-down",s=>{if(s.key===_.pan)s.stopPropagation(),s.repeat||(t.enabled=!1);else if(s.key===_.complete)s.stopPropagation(),t.completeCreateOperation();else if(s.key!==_.vertexAdd||s.repeat)s.key===_.undo?(s.stopPropagation(),p.undo()):s.key===_.redo?(s.stopPropagation(),p.redo()):s.key!==_.constraint||t.geometryType!=="rectangle"&&t.geometryType!=="circle"||s.repeat?s.key===_.center&&(s.repeat||(t.centered=!i,s.stopPropagation())):(t.forceUniformSize=!o,s.stopPropagation());else{const d=t.drawOperation.geometryType;d!=="polyline"&&d!=="polygon"&&d!=="multipoint"||(s.stopPropagation(),t.drawOperation.commitStagedVertex())}},E.WIDGET),e.on("key-up",s=>{s.key===_.pan?t.enabled=!0:s.key!==_.constraint||t.geometryType!=="rectangle"&&t.geometryType!=="circle"?s.key===_.center&&(t.centered=i,s.stopPropagation()):(t.forceUniformSize=o,s.stopPropagation())},E.WIDGET),t.on("vertex-add",s=>{switch(a=a==null?"start":"active",s.operation){case"apply":this.emit("create",{graphic:t.graphic,state:a,tool:this.activeTool,toolEventInfo:s,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[t.graphic],tool:t.geometryType});break;case"redo":this._emitRedoEvent({graphics:[t.graphic],tool:t.geometryType})}}),t.on("cursor-update",s=>{t.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:t.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:s.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),t.on("vertex-remove",s=>{switch(s.operation){case"apply":this.emit("create",{graphic:t.graphic,state:"active",tool:this.activeTool,toolEventInfo:s,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[t.graphic],tool:t.geometryType});break;case"redo":this._emitRedoEvent({graphics:[t.graphic],tool:t.geometryType})}}),t.on("complete",s=>{this._set("createGraphic",s.graphic),a="complete",s.aborted?p&&p.cancel():p&&p.complete()}),x(()=>this._getGraphicSymbolFromTool(t.geometryType),s=>{t.graphicSymbol=s})],p=new F({activeComponent:t,tool:t.geometryType,type:"create",onEnd:()=>{var s;r.forEach(d=>d.remove()),r.length=0,(s=e.tools)==null||s.remove(t)},undo:()=>{t.canUndo&&t.undo()},redo:()=>{t.canRedo&&t.redo()},canUndo:()=>t.canUndo,canRedo:()=>t.canRedo});return p}_getGraphicSymbolFromTool(t){switch(t){case"point":case"multipoint":return this.pointSymbol;case"polyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":return this.polygonSymbol;case"mesh":return this.meshSymbol}}async _setupUpdateOperation(t,e){var p;const{layer:a,view:o}=this;if(!o)return this._logMissingView(),null;const i={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...e,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...e==null?void 0:e.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...e==null?void 0:e.highlightOptions}};let r=i.tool;for(const s of t)a.remove(s),a.add(s);if(o.type==="3d"){if(t.length===0)return null;switch(r){case"move":return this._setupMove3DOperation(t,i,o,r);case"reshape":{if(t.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const s=V(t[0]);return s===y.SUPPORTED?this._setupReshape3DOperation(t[0],i,o):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${q(s)}).`),null)}case"transform":return this._setupGraphicTransform3DOperation(t,i,o)}}switch(r){case"move":return this._setupMove2DOperation(t,i,o);case"reshape":{if(t.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const s=V(t[0]);return s===y.SUPPORTED?this._setupTransformOrReshape2DOperation(t,r,i,o):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${q(s)}).`),null)}case"transform":if(t.length===1){const s=(p=t[0].geometry)==null?void 0:p.type;s!=="point"&&s!=="multipoint"||(r="reshape")}return this._setupTransformOrReshape2DOperation(t,r,i,o)}}async _setupMove3DOperation(t,e,a,o,i=!1){for(const n of t){const c=qt(n);if(c!==y.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${q(c)}).`),null}const r=await this._requireModule(T(()=>import("./editingTools-B6T33T1P.js"),__vite__mapDeps([88,1,2,21,63,23,64,65,22,4,5,9,10,11,12,13,66,89,61,76,17,18,73,74,77,7,8,14,15,16,19,20,37,78,79,80,31,32,33,34,81,75,90,91,92,93,72,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,38,111,112,113,114,71,115,116,82,117,118,57,44,119,120,53,121,122,123,124,125,126,127,128,129,130,131,132,51,52,133,134,135,136,137,138,139,24,25,41,42,43,45,140,141,142,70,143,144,145,146,47,147,26,27,28,29,30,35,36,39,40,46,48,49,50,54,55,56,58,59,60,62,67,68,69,148,149,150,84,85,151,152,83,153,154,155,156,157,158,159,160,161,162,163,164,165,87,86])));if(f(r))return r;const p=new r.module.GraphicMoveTool({view:a,enableZ:e.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});a.tools.add(p),p.graphics.addMany(t),i||this.updateGraphics.addMany(t);const s=[],d=new R({activeComponent:p,tool:o,type:"update",onEnd:()=>{var n;s.forEach(c=>c.remove()),s.length=0,(n=a.tools)==null||n.remove(p),p.destroyed||p.destroy()},undo:()=>{$(d,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o})},redo:()=>{Y(d,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o})},addToSelection:n=>{this.updateGraphics.push(n),p.graphics.push(n),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[n],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:n=>{const c=this.updateGraphics.indexOf(n);d.history.undo.forEach(l=>l.updates.splice(c,1)),d.history.redo.forEach(l=>l.updates.splice(c,1)),this.updateGraphics.remove(n),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[n],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?p.graphics.remove(n):d.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||e.toggleToolOnClick===!1||o!=="transform")return;const n=this.updateGraphics.at(0);if(V(n)!==y.SUPPORTED)return;d.onEnd(),d.destroy();const c=await this._setupReshape3DOperation(n,e,a,!0);f(c)||this._setUpdateOperationHandle(c,e)}});return s.push(...this._getHandlesForComponent(d,e),a.on("immediate-click",n=>this._getCommonUpdateOperationClickHandlers(d,n,e),E.WIDGET),a.on("key-down",n=>{this._getCommonUpdateOperationKeyDownHandlers(d,n)},E.WIDGET)),d}_setupGraphicTransform3DOperation(t,e,a,o=!1){if(t.length===1&&jt(t[0])===y.SUPPORTED){const i=t[0],r=i.geometry;if(r!=null&&(r.type==="point"||r.type==="mesh"))return this._setupPointTransform3DOperation(i,e,a);if(r!=null&&(r.type==="polygon"||r.type==="polyline"))return this._setupPolyTransform3DOperation(i,e,a,o)}return this._setupMove3DOperation(t,e,a,"transform",o)}async _setupPointTransform3DOperation(t,e,a){const o="transform",{enableRotation:i,enableScaling:r,enableZ:p}=e,s=await this._requireModule(T(()=>import("./editingTools-B6T33T1P.js"),__vite__mapDeps([88,1,2,21,63,23,64,65,22,4,5,9,10,11,12,13,66,89,61,76,17,18,73,74,77,7,8,14,15,16,19,20,37,78,79,80,31,32,33,34,81,75,90,91,92,93,72,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,38,111,112,113,114,71,115,116,82,117,118,57,44,119,120,53,121,122,123,124,125,126,127,128,129,130,131,132,51,52,133,134,135,136,137,138,139,24,25,41,42,43,45,140,141,142,70,143,144,145,146,47,147,26,27,28,29,30,35,36,39,40,46,48,49,50,54,55,56,58,59,60,62,67,68,69,148,149,150,84,85,151,152,83,153,154,155,156,157,158,159,160,161,162,163,164,165,87,86])));if(f(s))return s;const d=new s.module.GraphicTransformTool({graphic:t,view:a,enableRotation:i,enableScaling:r,enableZ:p,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});a.tools.add(d),this.updateGraphics.add(t);const n=[],c=new R({activeComponent:d,tool:o,type:"update",onEnd:()=>{var l;n.forEach(m=>m.remove()),n.length=0,(l=a.tools)==null||l.remove(d),d.destroyed||d.destroy()},undo:()=>{$(c,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o})},redo:()=>{Y(c,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o})},addToSelection:async l=>{this.updateGraphics.add(l),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[l],removed:[],type:"selection-change"},type:"update"}),c.onEnd(),c.destroy();const m=await this._setupMove3DOperation(this.updateGraphics.toArray(),e,a,"transform",!0);f(m)||this._setUpdateOperationHandle(m,e)},removeFromSelection:l=>{this.updateGraphics.remove(l),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[l],type:"selection-change"},type:"update"}),c.complete()},toggleTool:()=>{}});return n.push(...this._getHandlesForComponent(c,e),a.on("immediate-click",l=>this._getCommonUpdateOperationClickHandlers(c,l,e),E.WIDGET),a.on("key-down",l=>{this._getCommonUpdateOperationKeyDownHandlers(c,l)},E.WIDGET)),c}async _setupPolyTransform3DOperation(t,e,a,o=!1){var k,et;const i="transform",{enableRotation:r,enableScaling:p,enableZ:s,preserveAspectRatio:d}=e,n=await this._requireModule(T(()=>import("./editingTools-B6T33T1P.js"),__vite__mapDeps([88,1,2,21,63,23,64,65,22,4,5,9,10,11,12,13,66,89,61,76,17,18,73,74,77,7,8,14,15,16,19,20,37,78,79,80,31,32,33,34,81,75,90,91,92,93,72,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,38,111,112,113,114,71,115,116,82,117,118,57,44,119,120,53,121,122,123,124,125,126,127,128,129,130,131,132,51,52,133,134,135,136,137,138,139,24,25,41,42,43,45,140,141,142,70,143,144,145,146,47,147,26,27,28,29,30,35,36,39,40,46,48,49,50,54,55,56,58,59,60,62,67,68,69,148,149,150,84,85,151,152,83,153,154,155,156,157,158,159,160,161,162,163,164,165,87,86])));if(f(n))return n;const c=(et=(k=this.view)==null?void 0:k.inputManager)==null?void 0:et.isModifierKeyDown(_.constraint),l=new n.module.ExtentTransformTool({graphic:t,view:a,enableRotation:r,enableScaling:p,enableZ:s,preserveAspectRatio:!!d!=!!c,sketchOptions:this.sketchOptions});a.tools.add(l),o||this.updateGraphics.add(t);const m=[],b=new R({activeComponent:l,tool:i,type:"update",onEnd:()=>{var v;m.forEach(P=>P.remove()),m.length=0,(v=a.tools)==null||v.remove(l),l.destroyed||l.destroy()},canUndo:()=>l.canUndo,undo:()=>{l.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:i})},canRedo:()=>l.canRedo,redo:()=>{l.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:i})},addToSelection:async v=>{this.updateGraphics.add(v),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[v],removed:[],type:"selection-change"},type:"update"}),b.onEnd(),b.destroy();const P=await this._setupMove3DOperation(this.updateGraphics.toArray(),e,a,"transform",!0);f(P)||this._setUpdateOperationHandle(P,e)},removeFromSelection:v=>{this.updateGraphics.remove(v),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[v],type:"selection-change"},type:"update"}),b.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||e.toggleToolOnClick===!1)return;const v=this.updateGraphics.at(0);if(V(v)!==y.SUPPORTED)return;b.onEnd(),b.destroy();const P=await this._setupReshape3DOperation(v,e,a,!0);f(P)||this._setUpdateOperationHandle(P,e)}});return m.push(...this._getHandlesForComponent(b,e),a.on("immediate-click",v=>this._getCommonUpdateOperationClickHandlers(b,v,e),E.WIDGET),a.on("key-down",v=>this._getCommonUpdateOperationKeyDownHandlers(b,v),E.WIDGET),a.on("key-down",v=>{v.key!==_.constraint||v.repeat||(l.preserveAspectRatio=!l.preserveAspectRatio,v.stopPropagation())},E.WIDGET),a.on("key-up",v=>{v.key===_.constraint&&(l.preserveAspectRatio=!l.preserveAspectRatio,v.stopPropagation())},E.WIDGET)),b}async _setupMove2DOperation(t,e,a){const o="move";this.updateGraphics.addMany(t),await this._updateSpatialReference(t);const i=await this._getGraphicMover(t,e,a);if(f(i))return i;const r=new R({activeComponent:i,tool:o,type:"update",onEnd:()=>{var n;this._displayDefaultCursor(),d.forEach(c=>c.remove()),s.forEach(c=>c.remove()),d=[],s=[],i.destroy(),(n=this._internalGraphicsLayer)==null||n.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const n=this.updateGraphics.toArray();$(r,n),r.refreshComponent(),this._emitUndoEvent({graphics:n,tool:o})},redo:()=>{const n=this.updateGraphics.toArray();Y(r,n),r.refreshComponent(),this._emitRedoEvent({graphics:n,tool:o})},addToSelection:async n=>{await this._updateSpatialReference(n),this.updateGraphics.push(n),i.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[n],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:n=>{const c=this.updateGraphics.indexOf(n);r.history.undo.forEach(m=>m.updates.splice(c,1)),r.history.redo.forEach(m=>m.updates.splice(c,1)),this.updateGraphics.remove(n);const l=this.updateGraphics.toArray();this.emit("update",{graphics:l,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[n],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?i.graphics=l:r.complete()}});let p=!1,s=[a.on("immediate-click",n=>this._getCommonUpdateOperationClickHandlers(r,n,e),E.WIDGET),a.on("key-down",n=>{this._getCommonUpdateOperationKeyDownHandlers(r,n),n.key!==_.constraint||n.repeat||(p=!0,i.enableMoveAllGraphics=!i.enableMoveAllGraphics)},E.WIDGET),a.on("key-up",n=>{n.key===_.constraint&&p&&(p=!1,i.enableMoveAllGraphics=!i.enableMoveAllGraphics)},E.WIDGET)],d=this._getHandlesForComponent(r,e);return r}async _setupReshape3DOperation(t,e,a,o=!1){const i="reshape",r=await this._requireModule(T(()=>import("./editingTools-B6T33T1P.js"),__vite__mapDeps([88,1,2,21,63,23,64,65,22,4,5,9,10,11,12,13,66,89,61,76,17,18,73,74,77,7,8,14,15,16,19,20,37,78,79,80,31,32,33,34,81,75,90,91,92,93,72,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,38,111,112,113,114,71,115,116,82,117,118,57,44,119,120,53,121,122,123,124,125,126,127,128,129,130,131,132,51,52,133,134,135,136,137,138,139,24,25,41,42,43,45,140,141,142,70,143,144,145,146,47,147,26,27,28,29,30,35,36,39,40,46,48,49,50,54,55,56,58,59,60,62,67,68,69,148,149,150,84,85,151,152,83,153,154,155,156,157,158,159,160,161,162,163,164,165,87,86])));if(f(r))return r;const p=e.reshapeOptions,s=new r.module.GraphicReshapeTool({view:a,graphic:t,enableZVertex:e.enableZ&&(p==null?void 0:p.vertexOperation)==="move",enableZShape:e.enableZ&&(p==null?void 0:p.shapeOperation)==="move",enableMoveGraphic:(p==null?void 0:p.shapeOperation)==="move"||(p==null?void 0:p.shapeOperation)==="move-xy",enableMidpoints:(p==null?void 0:p.edgeOperation)==="split",enableEdgeOffset:(p==null?void 0:p.edgeOperation)==="offset",snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});a.tools.add(s),o||this.updateGraphics.add(t);const d=[],n=new R({activeComponent:s,tool:i,type:"update",onEnd:()=>{var c;d.forEach(l=>l.remove()),d.length=0,(c=a.tools)==null||c.remove(s),s.destroyed||s.destroy()},canUndo:()=>s.canUndo,undo:()=>{s.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:i})},canRedo:()=>s.canRedo,redo:()=>{s.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:i})},addToSelection:async c=>{this.updateGraphics.add(c),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[c],removed:[],type:"selection-change"},type:"update"}),n.onEnd(),n.destroy();const l=await this._setupMove3DOperation(this.updateGraphics.toArray(),e,a,"transform",!0);f(l)||this._setUpdateOperationHandle(l,e)},removeFromSelection:c=>{this.updateGraphics.remove(c),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[c],type:"selection-change"},type:"update"}),n.complete()},toggleTool:async()=>{if(e.toggleToolOnClick===!1)return;n.onEnd(),n.destroy();const c=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),e,a,!0);f(c)||this._setUpdateOperationHandle(c,e)}});return d.push(...this._getHandlesForComponent(n,e),a.on("immediate-click",c=>this._getCommonUpdateOperationClickHandlers(n,c,e),E.WIDGET),a.on("key-down",c=>{this._getCommonUpdateOperationKeyDownHandlers(n,c)},E.WIDGET)),n}async _setupTransformOrReshape2DOperation(t,e,a,o){this.updateGraphics.addMany(t),await this._updateSpatialReference(t);const i=e==="transform"?await this._getBox(t,a,o):await this._getReshape(t,a,o);if(f(i))return i;const r=new R({activeComponent:i,type:"update",onEnd:()=>{s.forEach(d=>d.remove()),p.forEach(d=>d.remove()),s=[],p=[],r.activeComponent&&!r.activeComponent.destroyed&&r.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{$(r,this.updateGraphics.toArray()),r.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r.tool})},redo:()=>{Y(r,this.updateGraphics.toArray()),r.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r.tool})},addToSelection:async d=>{let n=r.activeComponent;if((n==null?void 0:n.type)==="reshape"){const c=[...this.updateGraphics,d];this.updateGraphics.removeAll(),r.onEnd(),r.destroy();const l=await this._setupTransformOrReshape2DOperation(c,"transform",a,o);if(f(l))return;this._setUpdateOperationHandle(l,a)}else this.updateGraphics.add(d),n.graphics=this.updateGraphics.toArray(),n.refresh(),r.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[d],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async d=>{const n=this.updateGraphics.indexOf(d);r.history.undo.forEach(l=>l.updates.splice(n,1)),r.history.redo.forEach(l=>l.updates.splice(n,1)),this.updateGraphics.remove(d);const c=this.updateGraphics.toArray();if(c.length===0)r.complete();else{const l=c[0].geometry;c.length!==1||l==null||l.type!=="point"&&l.type!=="multipoint"?r.activeComponent.graphics=c:r.toggleTool()}this.emit("update",{graphics:c,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[d],type:"selection-change"},type:"update"})},toggleTool:async()=>{var l;if(this.updateGraphics.length>1)return;const d=this.updateGraphics.at(0),n=d.geometry;if(n!=null&&(r.tool==="reshape"&&(n.type==="point"||n.type==="multipoint")||r.tool==="transform"&&n.type==="extent"))return;let c=null;r.tool==="transform"?c=await this._getReshape([d],a,o):r.tool==="reshape"&&(c=await this._getBox([d],a,o)),f(c)||((l=r.activeComponent)==null||l.destroy(),r.activeComponent=c,r.activeComponent&&(s.forEach(m=>m.remove()),s=this._getHandlesForComponent(r,a)))}});let p=[o.on("immediate-click",d=>this._getCommonUpdateOperationClickHandlers(r,d,a),E.WIDGET),o.on("key-down",d=>{if(this._getCommonUpdateOperationKeyDownHandlers(r,d),d.key===_.constraint&&!d.repeat&&r){const n=r.activeComponent;n&&n.type==="box"&&(n.preserveAspectRatio=!n.preserveAspectRatio)}},E.WIDGET),o.on("key-up",d=>{if(d.key===_.constraint&&r){const n=r.activeComponent;n&&n.type==="box"&&(n.preserveAspectRatio=!n.preserveAspectRatio)}},E.WIDGET)],s=this._getHandlesForComponent(r,a);return r}async _getGraphicMover(t,e,a){const{enableMoveAllGraphics:o,highlightOptions:i}=e,r=await this._requireModule(T(()=>import("./GraphicMover-BGXU7J-0.js"),__vite__mapDeps([212,1,2,27,28,46,213,87,79,214,215,19,20,84,4,18,21,85])));return f(r)?r:new r.module.default({enableMoveAllGraphics:o,highlightsEnabled:!!(i!=null&&i.enabled),indicatorsEnabled:!1,graphics:t,view:a,callbacks:{onGraphicMoveStart:({dx:p,dy:s,graphic:d})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:s,mover:d,type:"move-start"},type:"update"})},onGraphicMove:({dx:p,dy:s,graphic:d})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:s,mover:d,type:"move"},type:"update"}),onGraphicMoveStop:({dx:p,dy:s,graphic:d})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:s,mover:d,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(t,e,a){var n,c;const{enableRotation:o,enableScaling:i,highlightOptions:r,preserveAspectRatio:p}=e,s=await this._requireModule(T(()=>import("./Box-D9-rup5y.js"),__vite__mapDeps([216,1,2,23,46,212,27,28,213,87,79,214,215,19,20,84,4,18,21,85,217,165,59,60,61,62,36,63,64,65,22,66,7,5,8,9,10,11,12,13,14,15,16,17,67,76,73,74,77,37,78,80,31,32,33,34,81,75,151,48,86])));if(f(s))return s;const d=(c=(n=this.view)==null?void 0:n.inputManager)==null?void 0:c.isModifierKeyDown(_.constraint);return new s.module.default({graphics:t,enableRotation:o,enableScaling:i,highlightsEnabled:!!(r!=null&&r.enabled),preserveAspectRatio:!!p!=!!d,layer:this._internalGraphicsLayer,view:a,sketchOptions:this.sketchOptions,callbacks:{onMoveStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onMove:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onMoveStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScaleStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScale:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScaleStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotateStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotate:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotateStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"})}})}async _getReshape(t,e,a){var s,d,n;const o=((s=e.reshapeOptions)==null?void 0:s.edgeOperation)==="split",i=((d=e.reshapeOptions)==null?void 0:d.shapeOperation)==="move",r=!!((n=e.highlightOptions)!=null&&n.enabled),p=await this._requireModule(T(()=>import("./Reshape-1QFyNubm.js"),__vite__mapDeps([218,1,2,23,27,28,38,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,25,46,212,213,87,79,214,215,84,85,217,39,49,59,60,61,62,36,63,64,65,66,67,151,68,69,70,33,71,72,73,74,31,32,34,75,76,77,37,78,80,81,48,86])));return f(p)?p:new p.module.default({enableMidpoints:o,enableMovement:i,graphic:t[0],highlightsEnabled:r,layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,view:a,callbacks:{onReshapeStart:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onReshape:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onReshapeStop:({mover:c,type:l})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:c,type:l},type:"update"}),onMoveStart:({dx:c,dy:l,mover:m,type:b})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:c,dy:l,mover:m,type:b},type:"update"}),onMove:({dx:c,dy:l,mover:m,type:b})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:c,dy:l,mover:m,type:b},type:"update"}),onMoveStop:({dx:c,dy:l,mover:m,type:b})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:c,dy:l,mover:m,type:b},type:"update"}),onVertexAdd:({added:c,type:l,vertices:m})=>{const b=c.map(k=>st(k.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:b,vertices:m,type:l},type:"update"})},onVertexRemove:({removed:c,type:l,vertices:m})=>{const b=c.map(k=>st(k.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:b,vertices:m,type:l},type:"update"})}}})}_getHandlesForComponent(t,e){const a=t.activeComponent;if(!a)return[];switch(a.type){case"graphic-mover":return[a.on("graphic-click",({graphic:o,viewEvent:i})=>{var r;(r=i.native)!=null&&r.shiftKey&&(i.stopPropagation(),t.removeFromSelection(o))}),a.on("graphic-move-start",o=>t.addToHistory(M(o.allGraphics)))];case"box":return[a.on("graphic-click",o=>this._onTransformOrReshape2DGraphicClick(t,e,o)),a.on("move-start",o=>t.addToHistory(M(o.graphics))),a.on("rotate-start",o=>t.addToHistory(M(o.graphics))),a.on("scale-start",o=>t.addToHistory(M(o.graphics)))];case"reshape":return[a.on("graphic-click",o=>this._onTransformOrReshape2DGraphicClick(t,e,o)),a.on("move-start",o=>t.addToHistory(M([o.mover]))),a.on("reshape-start",o=>t.addToHistory(M([o.graphic]))),a.on("vertex-add",o=>t.addToHistory(M([o.oldGraphic]))),a.on("vertex-remove",o=>t.addToHistory(M([o.oldGraphic])))];case"move-3d":return[a.on("graphic-move-start",o=>{t.addToHistory(M(o.allGraphics)),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:o.allGraphics.length>0?o.allGraphics[0]:null,type:"move-start"},type:"update"})}),a.on("graphic-move",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:o.dx,dy:o.dy,mover:o.allGraphics.length>0?o.allGraphics[0]:null,type:"move"},type:"update"})}),a.on("graphic-move-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:o.allGraphics.length>0?o.allGraphics[0]:null,type:"move-stop"},type:"update"})}),a.on("immediate-click",o=>{o.shiftKey?this._toggleSelection([o.graphic],t,e):t.toggleTool()})];case"transform-3d":return[a.on("record-undo",({record:o})=>{t.addToHistory({updates:[o]})}),a.on("graphic-translate-start",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,dx:o.dxScreen,dy:o.dyScreen,type:"move-start"},type:"update"})}),a.on("graphic-translate-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,dx:o.dxScreen,dy:o.dyScreen,type:"move-stop"},type:"update"})}),a.on("graphic-rotate-start",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,angle:o.angle,type:"rotate-start"},type:"update"})}),a.on("graphic-rotate-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,angle:o.angle,type:"rotate-stop"},type:"update"})}),a.on("graphic-scale-start",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,xScale:o.xScale,yScale:o.yScale,type:"scale-start"},type:"update"})}),a.on("graphic-scale-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,xScale:o.xScale,yScale:o.yScale,type:"scale-stop"},type:"update"})}),a.on("graphic-translate",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,dx:o.dxScreen,dy:o.dyScreen,type:"move"},type:"update"})}),a.on("graphic-rotate",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,angle:o.angle,type:"rotate"},type:"update"})}),a.on("graphic-scale",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,xScale:o.xScale,yScale:o.yScale,type:"scale"},type:"update"})}),a.on("immediate-click",o=>{o.shiftKey?this._toggleSelection([o.graphic],t,e):t.toggleTool()})];case"reshape-3d":return[a.on("reshape",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:o,type:"update"})}),a.on("move",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:o,type:"update"})}),a.on("vertex-add",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:o,type:"update"})}),a.on("vertex-remove",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:o,type:"update"})}),a.on("immediate-click",o=>{o.shiftKey?this._toggleSelection([o.graphic],t,e):t.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(t,e,a){var r;const{graphic:o,viewEvent:i}=a;return(r=i.native)!=null&&r.shiftKey&&o.layer===this.layer?(i.stopPropagation(),t.removeFromSelection(o)):e.toggleToolOnClick?(i.stopPropagation(),t.toggleTool()):void 0}_setUpdateOperationHandle(t,e){var i;this._operationHandle=t;const a=(i=this.view)==null?void 0:i.map;this._disablePopup(e);const o=()=>{if(t===this._operationHandle){const r=this.updateGraphics.toArray(),p=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),a&&a.remove(this._internalGraphicsLayer),this._restorePopup(e),this.emit("update",{graphics:r,state:"complete",aborted:t.cancelled,tool:p,toolEventInfo:null,type:"update"})}};t.on("complete",o)}async _getCommonUpdateOperationClickHandlers(t,e,a){const o=lt(e),i=await e.async(()=>this._getFirstHit(o));if(i==null)return void t.complete();if(e.native.shiftKey&&this._toggleSelection([i.graphic],t,a))return void e.stopPropagation();this.updateGraphics.includes(i.graphic)?e.stopPropagation():t.complete()}_toggleSelection(t,e,a){const o=!!a.multipleSelectionEnabled;return t.some(i=>i!=null&&!(!o||i.layer!==this.layer)&&(this.updateGraphics.includes(i)?e.removeFromSelection(i):e.addToSelection(i),!0))}_getCommonUpdateOperationKeyDownHandlers(t,e){if(!t)return;const a=e.key;a===_.undo&&t.canUndo()?(e.stopPropagation(),t.undo()):a===_.redo&&t.canRedo()?(e.stopPropagation(),t.redo()):a===_.cancel?(e.stopPropagation(),t.cancel()):this.allowDeleteKey&&_.delete.includes(a)&&this._onDeleteKey(e)}_onDeleteKey(t){var o;if(!this._operationHandle||this._operationHandle.type!=="update")return;const e=this.activeComponent,a=this.updateGraphics.toArray();e!=null&&e.type!=="reshape-3d"&&(e.type!=="reshape"||a.length===1&&((o=a[0].geometry)==null?void 0:o.type)==="point")&&(t.stopPropagation(),this.delete())}_removeDefaultLayer(){var t,e;this._internalGraphicsLayer&&((e=(t=this.view)==null?void 0:t.map)==null||e.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=L(this._internalGraphicsLayer))}_isComponentGraphic(t){var a;const{activeComponent:e}=this;return!(!t||e==null)&&(((a=t.attributes)==null?void 0:a.esriSketchTool)||e.type==="draw-2d"&&e.graphic===t||(e.type==="box"||e.type==="reshape")&&e.isUIGraphic(t))}_displayPointerCursor(){var t;(t=this.view)!=null&&t.container&&this.view.cursor!=="pointer"&&(this.view.cursor="pointer")}_displayGrabbingCursor(){var t;(t=this.view)!=null&&t.container&&this.view.cursor!=="grabbing"&&(this.view.cursor="grabbing")}_displayDefaultCursor(){var t;(t=this.view)!=null&&t.container&&this.view.cursor!==null&&(this.view.cursor=null)}_logError(t,e,a){$t.getLogger(this).error(new Yt(t,e,a))}async _requireModule(t){const e=new AbortController;this._moduleLoaderAbortController=e;const a=await t;return this._moduleLoaderAbortController!==e||e.signal.aborted?{requireError:"aborted"}:{module:a}}_emitUndoEvent(t){this.emit("undo",{...t,type:"undo"})}_emitRedoEvent(t){this.emit("redo",{...t,type:"redo"})}_emitDeleteEvent(t){this.emit("delete",{...t,type:"delete"})}get test(){return{operationHandle:this._operationHandle,snappingManager:this.snappingManager,defaultUpdateOptions:D}}wait(){return nt(()=>!this.updating)}_beginAsyncOperation(){this._numUpdating+=1,this.notifyChange("updating")}_endAsyncOperation(){this._numUpdating-=1,this.notifyChange("updating")}_disablePopupEnabled(t){var e;return((e=this.view)==null?void 0:e.type)!=="3d"||this.updateOnGraphicClick||((t==null?void 0:t.toggleToolOnClick)??!1)}_disablePopup(t){this._disablePopupEnabled(t)&&this.view&&this._originalPopupEnabled==null&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(t){this._disablePopupEnabled(t)&&this.view&&this._originalPopupEnabled!=null&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const t=this.view;t?(Z(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await Ft(nt(()=>t==null?void 0:t.ready),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",dt("view"))}_logMissingLayer(){this._logError(Jt,dt("layer"))}};h([u()],g.prototype,"_defaultSnappingManager",void 0),h([u()],g.prototype,"updating",null),h([u()],g.prototype,"_operationHandle",void 0),h([u({readOnly:!0})],g.prototype,"activeTool",null),h([u()],g.prototype,"activeFillSymbol",void 0),h([u()],g.prototype,"activeLineSymbol",void 0),h([u()],g.prototype,"activeVertexSymbol",void 0),h([u()],g.prototype,"allowDeleteKey",void 0),h([u({readOnly:!0})],g.prototype,"createGraphic",null),h([u()],g.prototype,"defaultCreateOptions",null),h([u()],g.prototype,"defaultUpdateOptions",null),h([u({type:X,nonNullable:!0})],g.prototype,"labelOptions",null),h([u()],g.prototype,"layer",void 0),h([u({types:N})],g.prototype,"pointSymbol",void 0),h([u({types:N})],g.prototype,"polygonSymbol",void 0),h([u({types:N})],g.prototype,"polylineSymbol",void 0),h([u()],g.prototype,"meshSymbol",void 0),h([u({type:gt,nonNullable:!0})],g.prototype,"snappingOptions",null),h([u()],g.prototype,"snappingManager",null),h([u({readOnly:!0})],g.prototype,"state",null),h([u({type:tt,nonNullable:!0})],g.prototype,"tooltipOptions",null),h([u({readOnly:!0})],g.prototype,"updateGraphics",void 0),h([u()],g.prototype,"updateOnGraphicClick",void 0),h([u({type:Q,nonNullable:!0})],g.prototype,"valueOptions",null),h([u({types:N})],g.prototype,"vertexSymbol",void 0),h([u({value:null})],g.prototype,"view",null),h([u({constructOnly:!0,type:vt})],g.prototype,"sketchOptions",void 0),g=h([S("esri.widgets.Sketch.SketchViewModel")],g);const Jt="sketch:missing-property",dt=t=>`Property '${t}' is missing on SketchViewModel.`;function Xt(t){return t==="polygon"||t==="rectangle"||t==="circle"}function $(t,e){ft("undo",t.history.undo,t.history.redo,e)}function Y(t,e){ft("redo",t.history.redo,t.history.undo,e)}function ft(t,e,a,o){const i=e.pop();if(!i)return;const r=i.updates,p=[];o.forEach((s,d)=>{const n=r[d];n!=null&&("geometry"in n&&n.geometry!=null&&(p.push({geometry:s.geometry}),s.geometry=n.geometry),"symbol"in n&&n.symbol!=null&&(p.push({symbol:s.symbol}),s.symbol=n.symbol),"undo"in n&&(p.push(n),n[t](s)))}),a.push({updates:p})}function M(t){return{updates:t.map(e=>({geometry:e.geometry}))}}function f(t){return"requireError"in t&&t.requireError==="aborted"}const de=g;export{y as P,Q as a,zt as b,ce as c,V as d,vt as l,de as n,qt as o};
